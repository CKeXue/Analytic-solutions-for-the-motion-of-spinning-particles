(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    410910,      11080]
NotebookOptionsPosition[    391947,      10774]
NotebookOutlinePosition[    392493,      10794]
CellTagsIndexPosition[    392450,      10791]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Style", "Section",
 CellChangeTimes->{{3.9100682558841777`*^9, 3.910068259339845*^9}, {
  3.923175501721289*^9, 3.9231755199025316`*^9}, {3.940307446680479*^9, 
  3.9403074495590343`*^9}},ExpressionUUID->"44ca613e-df9c-46c7-bfba-\
f0acd95bec3a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyColor1", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"62", ",", "55", ",", "51"}], "}"}], "/", "256"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyColor2", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"252", ",", "67", ",", "73"}], "}"}], "/", "256"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyColor3", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"59", ",", "138", ",", "179"}], "}"}], "/", "256"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyColor4", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"233", ",", "171", ",", "88"}], "}"}], "/", "256"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"MyColor5", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"73", ",", "160", ",", "88"}], "}"}], "/", "256"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"MyColor6", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"160", ",", "160", ",", "120"}], "}"}], "/", "256"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"MyColor7", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"170", ",", "88", ",", "180"}], "}"}], "/", "256"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"MyColor", "=", 
  RowBox[{"{", 
   RowBox[{
   "MyColor1", ",", "MyColor2", ",", "MyColor3", ",", "MyColor4", ",", 
    "MyColor5", ",", "MyColor6", ",", "MyColor7"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"MyStyle", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MyColor1", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor2", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.008", ",", "0.008", ",", "0.04", ",", "0.008"}], "}"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor3", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.004"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor4", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.02"}], "}"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor7", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.04", ",", "0.04"}], "}"}], "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"MyStylel", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MyColor1", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "0.8", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor2", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.008", ",", "0.008", ",", "0.04"}], "}"}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "0.8", "]"}]}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"MyColor3", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.004"}], "}"}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "0.8", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor4", ",", 
       RowBox[{"Dashing", "[", 
        RowBox[{"{", 
         RowBox[{"0.02", ",", "0.02"}], "}"}], "]"}], ",", 
       RowBox[{"AbsoluteThickness", "[", "0.8", "]"}]}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"MyStyleO", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MyColor1", ",", 
       RowBox[{"Opacity", "[", "0.2", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor2", ",", 
       RowBox[{"Opacity", "[", "0.2", "]"}]}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"MyColor3", ",", 
       RowBox[{"Opacity", "[", "0.2", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MyColor4", ",", 
       RowBox[{"Opacity", "[", "0.2", "]"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.9100682634673347`*^9, 3.910068274698677*^9}, {
   3.9103855028405914`*^9, 3.910385683926167*^9}, {3.9106692489732537`*^9, 
   3.910669296855731*^9}, {3.911356751851603*^9, 3.911356755591744*^9}, {
   3.911425963634672*^9, 3.9114259848254147`*^9}, {3.9125715516680593`*^9, 
   3.912571559162936*^9}, 3.912571591223266*^9, {3.912571636335438*^9, 
   3.9125716736730347`*^9}, 3.9125717957790184`*^9, {3.913532298035214*^9, 
   3.913532303114297*^9}, {3.913532334646756*^9, 3.913532364667122*^9}, {
   3.9135324011740065`*^9, 3.9135325262194448`*^9}, {3.9135325810088305`*^9, 
   3.9135325865097837`*^9}, {3.913674678061445*^9, 3.913674697502167*^9}, {
   3.913674909559889*^9, 3.913674943640941*^9}, {3.924122264751014*^9, 
   3.92412228276773*^9}, {3.927755606452368*^9, 3.927755674138948*^9}, {
   3.927755732036026*^9, 3.92775573595368*^9}},
 CellLabel->
  "In[834]:=",ExpressionUUID->"d5ca832f-6b09-4cd7-bcc0-0eb40436d167"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[<|"color" -> RGBColor[{
        Rational[31, 128], 
        Rational[55, 256], 
        Rational[51, 256]}]|>,
    "RGBColorSwatchTemplate"], ",", 
   TemplateBox[<|"color" -> RGBColor[{
        Rational[63, 64], 
        Rational[67, 256], 
        Rational[73, 256]}]|>,
    "RGBColorSwatchTemplate"], ",", 
   TemplateBox[<|"color" -> RGBColor[{
        Rational[59, 256], 
        Rational[69, 128], 
        Rational[179, 256]}]|>,
    "RGBColorSwatchTemplate"], ",", 
   TemplateBox[<|"color" -> RGBColor[{
        Rational[233, 256], 
        Rational[171, 256], 
        Rational[11, 32]}]|>,
    "RGBColorSwatchTemplate"], ",", 
   TemplateBox[<|"color" -> RGBColor[{
        Rational[73, 256], 
        Rational[5, 8], 
        Rational[11, 32]}]|>,
    "RGBColorSwatchTemplate"], ",", 
   TemplateBox[<|"color" -> RGBColor[{
        Rational[5, 8], 
        Rational[5, 8], 
        Rational[15, 32]}]|>,
    "RGBColorSwatchTemplate"], ",", 
   TemplateBox[<|"color" -> RGBColor[{
        Rational[85, 128], 
        Rational[11, 32], 
        Rational[45, 64]}]|>,
    "RGBColorSwatchTemplate"]}], "}"}]], "Output",
 CellChangeTimes->{{3.910385600615*^9, 3.910385641174934*^9}, 
   3.910385701186499*^9, {3.9106692691916533`*^9, 3.910669298177373*^9}, 
   3.911356760543417*^9, 3.911425986235628*^9, 3.9125716749520063`*^9, 
   3.9125717968900805`*^9, 3.913105049060478*^9, {3.91353234161637*^9, 
   3.9135323528402004`*^9}, {3.9135324024831333`*^9, 3.913532527005794*^9}, 
   3.913532597864503*^9, 3.913534398112183*^9, 3.913674700652018*^9, {
   3.913674917306133*^9, 3.913674944616336*^9}, 3.914359392105522*^9, 
   3.92412222693017*^9, {3.924122258341461*^9, 3.924122283321672*^9}, 
   3.925158066113983*^9, 3.925158412265802*^9, 3.925158949595051*^9, 
   3.925334968339649*^9, {3.92768671969705*^9, 3.927686738002928*^9}, 
   3.9277556754564877`*^9, 3.927755737918556*^9},
 CellLabel->
  "Out[841]=",ExpressionUUID->"b1d91dbf-f5ff-0d47-a329-7a689a70067e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize", "Section",
 CellChangeTimes->{{3.9205154889159636`*^9, 3.920515491451094*^9}, {
  3.9410547827830315`*^9, 
  3.941054789910185*^9}},ExpressionUUID->"39da9ea7-4f15-492e-911a-\
82698b9cceba"],

Cell[CellGroupData[{

Cell["Importing the xAct", "Subsection",
 CellChangeTimes->{{3.920515733001478*^9, 3.9205157394778285`*^9}, {
  3.941054802428274*^9, 
  3.941054807919241*^9}},ExpressionUUID->"7e076fd4-1d6a-43a1-b5dc-\
5fd38081a8d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Print", "}"}], ",", 
     RowBox[{"<<", " ", "xAct`xTensor`"}]}], "]"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Print", "}"}], ",", 
     RowBox[{"<<", " ", "xAct`xTras`"}]}], "]"}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"<<", "xAct`xCoba`"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"<<", " ", "xAct`xPert`"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"<<", " ", "xAct`TexAct`"}]}], "]"}], ";"}]}], "Code",
 CellChangeTimes->{
  3.919713410698011*^9, {3.919714051925667*^9, 3.919714064272651*^9}, 
   3.919714552355315*^9, {3.921531792162889*^9, 3.921531793961483*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"347864f2-b73a-4c0d-8c18-9d1c746ce8e4"],

Cell[CellGroupData[{

Cell["Display ", "Subsubsection",
 CellChangeTimes->{{3.919891034876189*^9, 3.919891038506037*^9}, 
   3.941056029088129*^9},ExpressionUUID->"b2b291b1-ae7d-4b00-b757-\
1f7234bdc767"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CovDFormat", " ", "=", " ", "\"\<Prefix\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.919891042904441*^9, 3.9198910508821645`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"4a9c0aac-391d-4954-a69d-fc69f671dd66"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of background", "Subsection",
 CellChangeTimes->{{3.920515768636867*^9, 3.920515770962816*^9}, {
  3.941055080977232*^9, 
  3.9410551051982536`*^9}},ExpressionUUID->"4c07e9e9-ce75-418c-9d9e-\
ea7fd8923ed4"],

Cell[CellGroupData[{

Cell["Manifold", "Subsubsection",
 CellChangeTimes->{{3.920515779377345*^9, 3.920515782358208*^9}, 
   3.9410551143461437`*^9},ExpressionUUID->"642cdca6-1aeb-4999-9711-\
ef4e753b04b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"M4", "::", "usage"}], " ", "=", " ", "\"\<4-Manifolds.\>\""}], 
  ";"}], "\n", 
 RowBox[{"Index4d", "=", 
  RowBox[{"{", 
   RowBox[{
   "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", 
    "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"DefManifold", "[", 
  RowBox[{"M4", ",", "4", ",", "Index4d"}], "]"}]}], "Code",
 CellChangeTimes->{
  3.920516031236478*^9, {3.9410549973593483`*^9, 3.9410550314026012`*^9}, 
   3.9410550668082256`*^9, {3.9410551289998035`*^9, 
   3.9410551327521477`*^9}},ExpressionUUID->"1bcff7d4-514c-4b44-b1ac-\
cad527533858"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric", "Subsubsection",
 CellChangeTimes->{{3.9205157887097816`*^9, 3.920515789962241*^9}, 
   3.9410551418307495`*^9},ExpressionUUID->"d2d99f40-429a-49a5-809f-\
6770c767e37d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"DefMetric", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"gmetric", "[", 
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], ",", 
        RowBox[{"-", "\[Beta]"}]}], "]"}], ",", "CD", ",", 
      RowBox[{"PrintAs", "->", "\"\<g\>\""}]}], "]"}]}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.919714934775197*^9, 3.919714939380378*^9}, {
  3.919714997134142*^9, 3.919715064739627*^9}, {3.920059016283558*^9, 
  3.920059021375665*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"2c16822a-9975-41bc-a71c-33c2487a25bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Proper time", "Subsubsection",
 CellChangeTimes->{{3.923196179648466*^9, 3.92319618433654*^9}, {
  3.941055157151289*^9, 
  3.9410551663121223`*^9}},ExpressionUUID->"9afb07d7-29be-4a6c-abff-\
bc1fbbe24d5d"],

Cell[BoxData[
 RowBox[{"DefParameter", "[", 
  RowBox[{"tau", ",", 
   RowBox[{"PrintAs", "->", "\"\<\[Tau]\>\""}]}], "]"}]], "Code",
 CellChangeTimes->{{3.923196219102*^9, 3.92319623523521*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"24c4315b-ccbc-48f2-95dd-d9ac98477bd6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chart", "Subsubsection",
 CellChangeTimes->{{3.920515808730603*^9, 3.920515817008437*^9}, {
  3.920516259411715*^9, 3.920516261992884*^9}, {3.9410551744796925`*^9, 
  3.941055175510124*^9}},ExpressionUUID->"866305f4-03b0-42f2-8596-\
2fab4404b1a3"],

Cell["", "Text",
 CellChangeTimes->{{3.9251586584464283`*^9, 
  3.9251586588345146`*^9}},ExpressionUUID->"784bf25a-b9d4-3d49-81d0-\
cb6b8a3d4446"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "::", "usage"}], " ", "=", " ", "\"\<4-Chart.\>\""}]], "Code",
 CellChangeTimes->{{3.920516056892599*^9, 3.920516059584214*^9}, {
  3.941055058872963*^9, 
  3.9410550612009335`*^9}},ExpressionUUID->"5d745f7e-6565-4403-8da6-\
86af56228125"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", 
    RowBox[{"DefChart", "[", 
     RowBox[{"B", ",", "M4", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "[", "]"}], ",", " ", 
        RowBox[{"r", "[", "]"}], ",", " ", 
        RowBox[{"\[Theta]", "[", "]"}], ",", " ", 
        RowBox[{"\[Phi]", "[", "]"}]}], "}"}], ",", 
      RowBox[{"FormatBasis", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Partials\>\"", ",", "\"\<Differentials\>\""}], "}"}]}], 
      ",", " ", 
      RowBox[{"ChartColor", " ", "\[Rule]", " ", "MyColor3"}]}], "]"}]}], 
   "]"}], ";"}]], "Code",
 CellChangeTimes->{
  3.9203555757504873`*^9, {3.920490619518646*^9, 3.920490632996689*^9}, {
   3.923174953360289*^9, 3.923174963697575*^9}, 3.9231954251613855`*^9, {
   3.923213343242678*^9, 3.92321334845065*^9}, {3.923213396486173*^9, 
   3.9232133973735466`*^9}, {3.92336605546327*^9, 3.923366057358094*^9}, 
   3.924123047732674*^9, {3.9251586539868584`*^9, 3.925158681152737*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"4e31f57e-0e81-4c94-ab80-6d36eb64e276"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation of  \[Theta]", "Subsubsection",
 CellChangeTimes->{{3.927687123810713*^9, 3.927687126016077*^9}, {
  3.941055219940193*^9, 
  3.941055240196657*^9}},ExpressionUUID->"20f67f26-bf94-734b-b971-\
10acf0e51ee9"],

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"\[Delta]\[Theta]", "[", "]"}], ",", "M4"}], "]"}]], "Code",
 CellChangeTimes->{{3.923369756836365*^9, 3.923369766618709*^9}, {
  3.923371398116874*^9, 3.923371398890466*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"77e506bd-c7af-9144-add3-f88fc3ec5cc1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric", "Subsubsection",
 CellChangeTimes->{{3.919716605239884*^9, 3.919716614525119*^9}, {
   3.919717902745287*^9, 3.919717907482718*^9}, {3.920515936919204*^9, 
   3.920515941734575*^9}, 3.923178048285605*^9, {3.923363059200167*^9, 
   3.923363064407254*^9}, {3.925158872102848*^9, 3.925158891881132*^9}, {
   3.9410554321403027`*^9, 
   3.941055435946993*^9}},ExpressionUUID->"bd6c64bc-ebca-4249-ba88-\
79812c42535b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefScalarFunction", "[", 
   RowBox[{"f", ",", 
    RowBox[{"PrintAs", "->", "\"\<f\>\""}]}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.9251584457966957`*^9, 3.9251584473140717`*^9}, 
   3.925158545685755*^9, {3.925158604458511*^9, 3.925158605588968*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"5a77ecfd-516d-074d-9319-068b6e3427b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"TheMetric", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"f", "[", 
          RowBox[{"r", "[", "]"}], "]"}]}], ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        FractionBox["1", 
         RowBox[{"f", "[", 
          RowBox[{"r", "[", "]"}], "]"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SuperscriptBox[
         RowBox[{"r", "[", "]"}], "2"], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"r", "[", "]"}], "2"], 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", "]"}], "]"}], "2"]}]}], "}"}]}], "}"}]}], 
   "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.9197169159112597`*^9, 3.919716924305082*^9}, {
   3.919717309459659*^9, 3.919717365648159*^9}, {3.919717445197961*^9, 
   3.919717485287266*^9}, {3.919717558775982*^9, 3.9197175749045258`*^9}, {
   3.919718223733824*^9, 3.919718267506994*^9}, {3.91971948039415*^9, 
   3.919719565703002*^9}, {3.9231750000991793`*^9, 3.923175065926191*^9}, {
   3.923179508652406*^9, 3.923179508996372*^9}, 3.923371156616992*^9, {
   3.924122999659617*^9, 3.924123039695328*^9}, {3.924123100506703*^9, 
   3.924123223560507*^9}, {3.924123355350291*^9, 3.924123383847663*^9}, {
   3.9251586164569397`*^9, 3.9251586211693535`*^9}, {3.925178012040533*^9, 
   3.92517801709408*^9}},
 CellLabel->
  "In[812]:=",ExpressionUUID->"67885970-ff0e-4d09-9c65-f46e5b356f3b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "Print", "}"}], ",", 
     RowBox[{"MetricInBasis", "[", 
      RowBox[{"gmetric", ",", 
       RowBox[{"-", "B"}], ",", "TheMetric"}], "]"}]}], "]"}], "//", 
   "MatrixForm"}], ";"}]], "Code",
 CellChangeTimes->{{3.9197195980475883`*^9, 3.919719623869569*^9}, {
   3.9200590871697063`*^9, 3.920059094749362*^9}, {3.920150389089312*^9, 
   3.92015039632637*^9}, 3.923371155512476*^9},
 CellLabel->
  "In[813]:=",ExpressionUUID->"762fb734-1046-49a3-905d-79de9bf7307f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Type of Metric", "Subsubsection",
 CellChangeTimes->{{3.924063203040077*^9, 3.9240632038878098`*^9}, {
   3.926110491581454*^9, 3.9261104947008*^9}, 3.941055470827467*^9, {
   3.9410555310195007`*^9, 
   3.941055558139389*^9}},ExpressionUUID->"cdc0844c-bc42-4309-bc39-\
ca4726bcf056"],

Cell[CellGroupData[{

Cell["parameters", "Subsubsubsection",
 CellChangeTimes->{{3.920515911105199*^9, 3.920515914044449*^9}, {
  3.923175197425211*^9, 3.923175208443673*^9}, {3.9410555148783207`*^9, 
  3.941055523792511*^9}},ExpressionUUID->"90084228-e350-4374-b7df-\
db943973a9d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"G", "::", "usage"}], " ", "=", " ", 
   "\"\<Gravitational constant G\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"M", "::", "usage"}], " ", "=", " ", 
   "\"\<Black hole mass M.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "::", "usage"}], " ", "=", " ", 
   "\"\<Brane world parameter b.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "G", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "M", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "b", "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.920516056892599*^9, 3.920516059584214*^9}, {
  3.923175226592837*^9, 3.92317525295112*^9}, {3.92412234372054*^9, 
  3.92412234676031*^9}, {3.924122423462493*^9, 3.924122432390992*^9}, {
  3.925158250019556*^9, 3.925158304605905*^9}, {3.925159064554413*^9, 
  3.925159068486353*^9}, {3.92679689967007*^9, 3.9267969017027*^9}, {
  3.9267974859117413`*^9, 3.926797546166649*^9}, {3.941055260910982*^9, 
  3.941055367046215*^9}},
 CellLabel->
  "In[803]:=",ExpressionUUID->"65f58b96-9f15-4c81-b515-a0f7b909cb8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["function", "Subsubsubsection",
 CellChangeTimes->{{3.9410554099833584`*^9, 
  3.941055412513546*^9}},ExpressionUUID->"aa2dc488-b349-1448-9c8e-\
527c4946cb23"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fSh", "[", "r_", "]"}], ":=", 
   RowBox[{"1", "-", " ", 
    FractionBox["2", "r"]}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.9240632105600834`*^9, {3.925161061443859*^9, 3.925161101051832*^9}, {
   3.92516113791053*^9, 3.925161154288788*^9}, {3.925195594716492*^9, 
   3.9251956044875336`*^9}, {3.925282667293068*^9, 3.925282671167929*^9}, {
   3.9261104972980766`*^9, 3.926110515519377*^9}, {3.940925607911085*^9, 
   3.940925611866667*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"89d04de5-d6a5-498d-911c-c680bf685bbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fShBW", "[", "r_", "]"}], ":=", 
   RowBox[{"1", "-", " ", 
    FractionBox["2", "r"], "+", " ", 
    FractionBox["b", 
     SuperscriptBox["r", "2"]]}]}], ";"}]], "Code",
 CellChangeTimes->{{3.9261105050171204`*^9, 3.926110516507492*^9}, 
   3.9267974215175056`*^9, {3.927611293035942*^9, 3.927611331456854*^9}, {
   3.927611385522875*^9, 3.927611394992878*^9}, 3.927686883000759*^9, {
   3.940925598067766*^9, 3.9409256191647224`*^9}, {3.941055753887739*^9, 
   3.9410557835551205`*^9}},
 CellLabel->
  "In[745]:=",ExpressionUUID->"983aa608-3f66-ff41-94a5-72f2591cf13f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Per-computation of curvature tensors, etc\:ff1a", "Subsubsection",
 CellChangeTimes->{
  3.919720184387706*^9, {3.919891194743322*^9, 3.919891201742634*^9}, {
   3.9410555937506638`*^9, 
   3.9410556496663074`*^9}},ExpressionUUID->"8d04a9c5-3d56-4ff4-b895-\
641e01581527"],

Cell[CellGroupData[{

Cell["Per-computation\:ff1a", "Subsubsubsection",
 CellChangeTimes->{
  3.919720202611583*^9, {3.9410556411117363`*^9, 
   3.9410556550530014`*^9}},ExpressionUUID->"5913c0d1-97a0-43cb-99c0-\
fe98b56b5904"],

Cell[BoxData[
 RowBox[{"MetricCompute", "[", 
  RowBox[{"gmetric", ",", "B", ",", "All"}], "]"}]], "Code",
 CellChangeTimes->{{3.919720205534815*^9, 3.9197202255392303`*^9}},
 CellLabel->
  "In[814]:=",ExpressionUUID->"18d6292d-f64b-4de8-9448-51c82c477a24"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Others", "Subsubsubsection",
 CellChangeTimes->{{3.920516549553613*^9, 3.920516552501577*^9}, {
  3.9410556601103687`*^9, 
  3.941055666256241*^9}},ExpressionUUID->"602e6627-216e-4a10-b10e-\
8a6590342dbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"ChangeComponents", "[", 
     RowBox[{
      RowBox[{"RicciCD", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "B"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "B"}], "}"}]}], "]"}], ",", 
      RowBox[{"RicciCD", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.9197343441536517`*^9, 3.9197343508168554`*^9}, {
  3.919734389584338*^9, 3.9197344281001663`*^9}, {3.919734459815302*^9, 
  3.9197344701318393`*^9}, {3.9204897386540976`*^9, 3.920489740866095*^9}},
 CellLabel->
  "In[514]:=",ExpressionUUID->"f613ff67-1021-4a9d-b1de-efb569c9b3ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"ChangeComponents", "[", 
     RowBox[{
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", "B"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"RiemannCD", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{
  3.923004209726712*^9, {3.923004256376466*^9, 3.923004332340521*^9}},
 CellLabel->
  "In[515]:=",ExpressionUUID->"72ea531d-367a-4dbd-b2d4-8e9e75d4fdee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"ChangeComponents", "[", 
     RowBox[{
      RowBox[{"epsilongmetric", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "B"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "B"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"epsilongmetric", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.923006272294689*^9, 3.92300629941148*^9}, {
   3.9230065137346306`*^9, 3.923006525200108*^9}, 3.923006863166403*^9, {
   3.923175489813064*^9, 3.923175490620343*^9}},
 CellLabel->
  "In[516]:=",ExpressionUUID->"6c289c92-7ccf-496e-8c79-156856dddc9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"ChangeComponents", "[", 
     RowBox[{
      RowBox[{"epsilongmetric", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "B"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Beta]", ",", "B"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]", ",", "B"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Nu]", ",", "B"}], "}"}]}], "]"}], ",", 
      RowBox[{"epsilongmetric", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], ",", 
          RowBox[{"-", "B"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.923178057000214*^9, 3.923178061364048*^9}},
 CellLabel->
  "In[517]:=",ExpressionUUID->"8a27d8bc-e348-4244-9c87-4743610e2cbf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full inverse tensor", "Subsubsection",
 CellChangeTimes->{{3.923006213976456*^9, 3.923006228848314*^9}, 
   3.9410611719516544`*^9},ExpressionUUID->"069efdc4-e36a-426b-9098-\
2cac1a7af9bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MySimplify", "@", 
  SqrtBox[
   RowBox[{"-", 
    RowBox[{"DetgmetricB", "[", "]"}]}]]}]], "Input",
 CellChangeTimes->{{3.9233633066958804`*^9, 3.923363325709563*^9}},
 CellLabel->
  "In[263]:=",ExpressionUUID->"ae68157b-3b65-45b3-bb05-ca164d2c79a1"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   InterpretationBox[
    StyleBox["r",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`r[],
    Editable->False], "2"], " ", 
  RowBox[{
   InterpretationBox[
    StyleBox["Sin",
     ShowAutoStyles->False,
     AutoSpacing->False],
    Sin,
    Editable->False], "[", 
   InterpretationBox[
    StyleBox["\[Theta]",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`\[Theta][],
    Editable->False], "]"}]}]], "Output",
 CellChangeTimes->{{3.9233633102262716`*^9, 3.923363326349604*^9}, 
   3.9276024233956995`*^9},
 CellLabel->
  "Out[263]=",ExpressionUUID->"98264bb3-3479-6846-a041-beba0cdc51de"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleEg", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"epsilongmetric", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"-", "B"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", 
           RowBox[{"-", "B"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"2", ",", " ", 
           RowBox[{"-", "B"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"3", ",", " ", 
           RowBox[{"-", "B"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"MySimplify", "@", 
        SqrtBox[
         RowBox[{"-", 
          RowBox[{"Detgmetric", "[", "]"}]}]]}]}], "}"}], ",", 
     RowBox[{"MetricOn", "->", "All"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"EgtoUnit", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"exp", "/.", "RuleEg"}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.923178910753248*^9, 3.923179013471585*^9}, {
  3.923179252495425*^9, 3.923179263690623*^9}, {3.923363294726955*^9, 
  3.923363294735821*^9}, {3.9406461999849596`*^9, 3.940646199987978*^9}, {
  3.941058269782921*^9, 3.9410582791590633`*^9}, {3.9410612263180485`*^9, 
  3.9410612273849087`*^9}},
 CellLabel->
  "In[348]:=",ExpressionUUID->"9febde85-a6e7-4aff-9a53-34b4cef413f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MySimplify", "Subsubsection",
 CellChangeTimes->{{3.920515827916368*^9, 3.920515834765526*^9}, 
   3.941054857267458*^9},ExpressionUUID->"a910d2f2-e116-0445-9620-\
c98565bbde32"],

Cell["\<\
\[OpenCurlyDoubleQuote]MySimplify\[CloseCurlyDoubleQuote] learn from the  \
<Calculation of the charges of  Kerr-Newman BH by the solution phase space \
method > \
\>", "Text",
 CellChangeTimes->{{3.9406499529181175`*^9, 
  3.940650074948173*^9}},ExpressionUUID->"5b31eb54-1e0b-dc47-9665-\
1e2de69260d4"],

Cell["\<\
 Kamal Hajian
Institute for Research in Fundamental Sciences (IPM), School of Physics\
\>", "Text",
 CellChangeTimes->{{3.9406499529181175`*^9, 
  3.940650061287882*^9}},ExpressionUUID->"9d33ad31-4b9d-2d4b-a170-\
36bd77cb817f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MySimplify1", "[", "a_", "]"}], ":=", 
   RowBox[{"ChangeCovD", "[", 
    RowBox[{"a", ",", "CD", ",", "PDB"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MySimplify2", "[", "b_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ToBasis", "[", "B", "]"}], "@", 
    RowBox[{
     RowBox[{"ToBasis", "[", "B", "]"}], "@", 
     RowBox[{"MySimplify1", "[", "b", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MySimplify3", "[", "c_", "]"}], ":=", 
   RowBox[{"TraceBasisDummy", "@", 
    RowBox[{"MySimplify2", "[", "c", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MySimplify4", "[", "d_", "]"}], ":=", 
   RowBox[{"ComponentArray", "@", 
    RowBox[{"MySimplify3", "[", "d", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MySimplify5", "[", "e_", "]"}], ":=", 
   RowBox[{"Factor", "@", 
    RowBox[{"ToValues", "@", 
     RowBox[{"ToValues", "@", 
      RowBox[{"ToValues", "@", 
       RowBox[{"MySimplify4", "[", "e", "]"}]}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MySimplify", "[", "f_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"MySimplify5", "[", "f", "]"}], ",", 
     RowBox[{"TimeConstraint", "->", "1000"}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.919715316074922*^9, 3.919715599713348*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"92b052be-cd1f-9d4a-ae16-77dae502d6a6"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"org", "[", "expr_", "]"}], ":=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"ContractMetric", "[", "expr", "]"}], ",", " ", 
      "$PerturbationParameter", ",", " ", "ToCanonical"}], "]"}]}], 
   ";"}]}]], "Code",
 CellChangeTimes->{{3.91975399098412*^9, 3.919754010954204*^9}, 
   3.923715437444683*^9},
 CellLabel->
  "In[350]:=",ExpressionUUID->"94aafa95-1611-49fc-a1e7-73f7eaad9693"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assumptions", "Section",
 CellChangeTimes->{{3.9197161430559034`*^9, 3.919716151943495*^9}, {
   3.9205159190354776`*^9, 3.920515924479905*^9}, 
   3.9410919066917343`*^9},ExpressionUUID->"93cca77c-5468-4db3-b53b-\
296d3845d353"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"And", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "[", "]"}], "\[Element]", "Reals"}], ",", 
     RowBox[{
      RowBox[{"r", "[", "]"}], "\[Element]", "Reals"}], ",", 
     RowBox[{
      RowBox[{"r", "[", "]"}], ">", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "]"}], "\[Element]", "Reals"}], ",", 
     RowBox[{"\[Pi]", ">=", 
      RowBox[{"\[Theta]", "[", "]"}], ">=", "0"}], ",", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "]"}], "\[Element]", "Reals"}], ",", 
     RowBox[{"G", "\[Element]", "Reals"}], ",", 
     RowBox[{"G", ">", "0"}], ",", 
     RowBox[{"M", "\[Element]", "Reals"}], ",", 
     RowBox[{"M", ">=", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["e", "2"]}], "<", "0"}], ",", 
     RowBox[{"p", ">", "0"}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.919733819790356*^9, {3.920966784632454*^9, 3.9209667954422426`*^9}, {
   3.92100781754935*^9, 3.921007819673448*^9}, {3.921140004173113*^9, 
   3.921140044637885*^9}, {3.923175093737435*^9, 3.923175153269433*^9}, 
   3.923368214377555*^9, 3.9233723941570935`*^9, {3.923719589678869*^9, 
   3.923719622637291*^9}, {3.9237196545250854`*^9, 3.9237196564695215`*^9}, {
   3.923719697163565*^9, 3.923719698957272*^9}, {3.925160860151249*^9, 
   3.9251608699235687`*^9}, {3.940021568132698*^9, 3.940021604147009*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"57e3a7af-0795-4e5e-8f90-592e32479ac3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters of test particle ", "Section",
 CellChangeTimes->{{3.9231752681388636`*^9, 3.9231752742031384`*^9}, {
  3.9410558889835606`*^9, 
  3.941055917217098*^9}},ExpressionUUID->"62491963-3514-48d4-b437-\
14df5c7576ec"],

Cell[CellGroupData[{

Cell["Mass", "Subsubsubsection",
 CellChangeTimes->{
  3.923175286794936*^9, {3.923177260032622*^9, 3.923177262259706*^9}, {
   3.925159104646501*^9, 3.9251591097665863`*^9}, 3.9410558449437428`*^9, {
   3.941055919648142*^9, 
   3.9410559231047554`*^9}},ExpressionUUID->"ce73d90d-d062-784f-856c-\
f507329a2efb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "m", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.92317529503359*^9, 3.923175326907157*^9}, {
   3.923175374043151*^9, 3.923175395840936*^9}, {3.92317726584524*^9, 
   3.923177283691339*^9}, 3.923370559494172*^9, {3.925159001492836*^9, 
   3.925159033157673*^9}, 
   3.9267976059717484`*^9},ExpressionUUID->"a96826a9-704b-8842-a9a3-\
dca9d9702fe6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Position, velocity, momentum", "Subsubsubsection",
 CellChangeTimes->{{3.923175575924716*^9, 3.923175577114035*^9}, 
   3.941056083314577*^9},ExpressionUUID->"7a8b7a39-d359-46b4-82f4-\
ecfe9723d34c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"P", "[", "\[Alpha]", "]"}], ",", "M4", ",", 
    RowBox[{"PrintAs", "->", "\"\<P\>\""}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"xp", "[", "\[Alpha]", "]"}], ",", "M4", ",", 
    RowBox[{"PrintAs", "->", "\"\<x\>\""}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"dxp", "[", "\[Alpha]", "]"}], ",", "M4", ",", 
    RowBox[{
    "PrintAs", "->", "\"\<\!\(\*OverscriptBox[\(x\), \(.\)]\)\>\""}]}], "]"}],
   ";"}]}], "Code",
 CellChangeTimes->{{3.92317529503359*^9, 3.923175326907157*^9}, {
   3.923175374043151*^9, 3.923175437147215*^9}, 3.92321349437335*^9, 
   3.923370558368352*^9, {3.9410559686237774`*^9, 
   3.9410559688747463`*^9}},ExpressionUUID->"9f24d9da-5d20-49b9-8d81-\
6402df8045b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleP", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P", "[", "\[Alpha]", "]"}], ",", " ", 
       RowBox[{"m", " ", 
        RowBox[{"dxp", "[", "\[Alpha]", "]"}]}]}], "}"}], ",", 
     RowBox[{"MetricOn", "->", "All"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Ptodx", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"exp", "/.", "RuleP"}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9231781407610855`*^9, 3.923178195232684*^9}, 
   3.9231800245351686`*^9, 3.923347487158604*^9, {3.923370572807238*^9, 
   3.923370574934069*^9}, 3.923371217540766*^9, {3.926540430491356*^9, 
   3.92654043090568*^9}, {3.926540490627695*^9, 3.926540495779552*^9}, 
   3.926562053049183*^9},
 CellLabel->
  "In[5219]:=",ExpressionUUID->"7f99cb19-929d-49b6-824b-ee95af86155e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"dxp", "[", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "B"}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"OverDot", "[", 
       RowBox[{"t", "[", "]"}], "]"}], ",", " ", 
      RowBox[{"OverDot", "[", 
       RowBox[{"r", "[", "]"}], "]"}], ",", " ", 
      RowBox[{"OverDot", "[", 
       RowBox[{"\[Theta]", "[", "]"}], "]"}], ",", " ", 
      RowBox[{"OverDot", "[", 
       RowBox[{"\[Phi]", "[", "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"AllComponentValues", "[", 
     RowBox[{
      RowBox[{"dxp", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], ",", "B"}], "}"}], "]"}], ",", 
      RowBox[{"MySimplify", "[", 
       RowBox[{
        RowBox[{"gmetric", "[", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "\[Alpha]"}]}], "]"}], 
        RowBox[{"dxp", "[", "\[Alpha]", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.923434657406709*^9, 3.92343466689069*^9}, {
  3.927920434810919*^9, 3.927920438360834*^9}, {3.941056099827627*^9, 
  3.941056165519169*^9}},
 CellLabel->
  "In[755]:=",ExpressionUUID->"5c1c1216-5ee4-49c8-b8d9-7718a6757fac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spin", "Subsubsubsection",
 CellChangeTimes->{
  3.923175286794936*^9, {3.9410573586252365`*^9, 
   3.941057359397566*^9}},ExpressionUUID->"869e505d-9908-4626-a669-\
c5d2949391b0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], ",", "M4", ",", 
    RowBox[{"Antisymmetric", "[", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"spin", "[", "\[Alpha]", "]"}], ",", "M4", ",", 
    RowBox[{"PrintAs", "->", "\"\<s\>\""}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"s", "[", "]"}], ",", "M4", ",", 
    RowBox[{
    "PrintAs", "->", 
     "\"\<\!\(\*StyleBox[\"s\",FontColor->RGBColor[0.25882352941176473`, \
0.49019607843137253`, 0.5568627450980392]]\)\>\""}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"sE", "[", "\[Alpha]", "]"}], ",", "M4", ",", 
    RowBox[{
    "PrintAs", "->", 
     "\"\<\!\(\*SubscriptBox[\(s\), \(\[Perpendicular]\)]\)\>\""}]}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.927318501693714*^9, 3.927318517584355*^9}, {
  3.941056254341812*^9, 3.941056265620613*^9}, {3.941059370851053*^9, 
  3.941059371164484*^9}, {3.941059583072754*^9, 3.9410596234230766`*^9}},
 CellLabel->"",ExpressionUUID->"17159be7-63de-514d-b60e-4ce1c1e85667"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "sn", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "sp", "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.9410614444246483`*^9, 
  3.941061453217917*^9}},ExpressionUUID->"80dba65f-0fbe-344c-8e61-\
9cf30362a98d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"sE", "[", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "B"}], "}"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      FractionBox[
       RowBox[{"s", "[", "]"}], 
       RowBox[{"r", "[", "]"}]], ",", "0"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"AllComponentValues", "[", 
     RowBox[{
      RowBox[{"sE", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], ",", "B"}], "}"}], "]"}], ",", 
      RowBox[{"MySimplify", "[", 
       RowBox[{
        RowBox[{"gmetric", "[", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", 
          RowBox[{"-", "\[Alpha]"}]}], "]"}], 
        RowBox[{"sE", "[", "\[Alpha]", "]"}]}], "]"}]}], "]"}]}], "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.927664759543852*^9, 3.927664797356985*^9}, {
   3.927665592990797*^9, 3.9276656055869617`*^9}, 3.927670190504629*^9, {
   3.927920384784331*^9, 3.927920399869837*^9}, {3.941056306796858*^9, 
   3.9410563142832527`*^9}, {3.941057500971304*^9, 3.941057502432022*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"13012a07-8f0f-d34e-8406-195aa2d44392"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AllComponentValues", "[", 
   RowBox[{
    RowBox[{"S", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "B"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "B"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        InterpretationBox[
         StyleBox[GridBox[{
            {"S", 
             StyleBox[GridBox[{
                {
                 StyleBox["0",
                  FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]], 
                 StyleBox["1",
                  FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                {" ", " "}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                   Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
              FontSize->9]}
           },
           GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.034999999999999996`]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}}],
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`S[{0, $CellContext`B}, {1, $CellContext`B}],
         Editable->False], ",", "0", ",", 
        InterpretationBox[
         StyleBox[GridBox[{
            {"S", 
             StyleBox[GridBox[{
                {
                 StyleBox["0",
                  FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]], 
                 StyleBox["3",
                  FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                {" ", " "}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                   Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
              FontSize->9]}
           },
           GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.034999999999999996`]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}}],
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`S[{0, $CellContext`B}, {3, $CellContext`B}],
         Editable->False]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[GridBox[{
             {"S", 
              StyleBox[GridBox[{
                 {
                  StyleBox["0",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]], 
                  StyleBox["1",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                 {" ", " "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`S[{0, $CellContext`B}, {1, $CellContext`B}],
          Editable->False]}], ",", "0", ",", "0", ",", 
        InterpretationBox[
         StyleBox[GridBox[{
            {"S", 
             StyleBox[GridBox[{
                {
                 StyleBox["1",
                  FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]], 
                 StyleBox["3",
                  FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                {" ", " "}
               },
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                   Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
              FontSize->9]}
           },
           GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.034999999999999996`]}, 
               Offset[0.27999999999999997`]}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}}],
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`S[{1, $CellContext`B}, {3, $CellContext`B}],
         Editable->False]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[GridBox[{
             {"S", 
              StyleBox[GridBox[{
                 {
                  StyleBox["0",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]], 
                  StyleBox["3",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                 {" ", " "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`S[{0, $CellContext`B}, {3, $CellContext`B}],
          Editable->False]}], ",", 
        RowBox[{"-", 
         InterpretationBox[
          StyleBox[GridBox[{
             {"S", 
              StyleBox[GridBox[{
                 {
                  StyleBox["1",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]], 
                  StyleBox["3",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                 {" ", " "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`S[{1, $CellContext`B}, {3, $CellContext`B}],
          Editable->False]}], ",", "0", ",", "0"}], "}"}]}], "}"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", " ", 
    RowBox[{"AllComponentValues", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], ",", "B"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], ",", "B"}], "}"}]}], "]"}], ",", 
      RowBox[{"MySimplify", "[", 
       RowBox[{
        RowBox[{"gmetric", "[", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "\[Alpha]"}]}], "]"}], 
        RowBox[{"gmetric", "[", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], ",", 
          RowBox[{"-", "\[Beta]"}]}], "]"}], 
        RowBox[{"S", "[", 
         RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.927320694374101*^9, 3.927320803206396*^9}, {
  3.927320838534361*^9, 3.927320861112189*^9}, {3.92732109289687*^9, 
  3.927321099765429*^9}, {3.927613009458912*^9, 3.9276130340659084`*^9}, {
  3.927613072620877*^9, 3.9276131016227417`*^9}, {3.9410563367410393`*^9, 
  3.9410563978422775`*^9}},
 CellLabel->
  "In[766]:=",ExpressionUUID->"f0cd0ee9-51dd-6244-bd7e-c5b7d9e8c436"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleSE", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"epsilongmetric", "[", 
         RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "\[Nu]"}]}], "]"}], " ", 
        RowBox[{"P", "[", "\[Mu]", "]"}], 
        RowBox[{"sE", "[", "\[Nu]", "]"}]}]}], "}"}], ",", 
     RowBox[{"MetricOn", "->", "All"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"StosE", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"exp", "/.", "RuleSE"}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.923177179081719*^9, 3.923177180450402*^9}, {
   3.923177218456198*^9, 3.923177238732146*^9}, {3.9231773690932484`*^9, 
   3.923177475628343*^9}, {3.923177798546101*^9, 3.923177804076309*^9}, 
   3.9231782056668816`*^9, {3.923179395600638*^9, 3.9231794039736867`*^9}, 
   3.923347492100841*^9, {3.923371148393489*^9, 3.92337114921305*^9}, {
   3.9236899194139423`*^9, 3.923689920845335*^9}, 3.927324270548378*^9, {
   3.927601976096805*^9, 3.9276019816486588`*^9}, 3.927664385998945*^9, {
   3.927664522715647*^9, 3.9276645254442825`*^9}, {3.927664839515131*^9, 
   3.9276648460924816`*^9}, {3.9276650006345863`*^9, 3.927665023838604*^9}, 
   3.9410574680263634`*^9, 
   3.941058096733572*^9},ExpressionUUID->"949d2c46-0365-9945-a82b-\
c0b01d061495"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RuleS", "=", 
   RowBox[{"MakeRule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"epsilongmetric", "[", 
         RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "\[Nu]"}]}], "]"}], " ", 
        RowBox[{"P", "[", "\[Mu]", "]"}], 
        RowBox[{"spin", "[", "\[Nu]", "]"}]}]}], "}"}], ",", 
     RowBox[{"MetricOn", "->", "All"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Stos", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"exp", "/.", "RuleS"}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.923177179081719*^9, 3.923177180450402*^9}, {
   3.923177218456198*^9, 3.923177238732146*^9}, {3.9231773690932484`*^9, 
   3.923177475628343*^9}, {3.923177798546101*^9, 3.923177804076309*^9}, 
   3.9231782056668816`*^9, {3.923179395600638*^9, 3.9231794039736867`*^9}, 
   3.923347492100841*^9, {3.923371148393489*^9, 3.92337114921305*^9}, {
   3.9236899194139423`*^9, 3.923689920845335*^9}, 3.927324270548378*^9, {
   3.927601976096805*^9, 3.9276019816486588`*^9}, 3.927664385998945*^9, {
   3.927664522715647*^9, 3.9276645254442825`*^9}, {3.927664839515131*^9, 
   3.9276648460924816`*^9}, {3.9276650006345863`*^9, 3.927665023838604*^9}, 
   3.9410574680263634`*^9, 3.941058096733572*^9, {3.9410591062759113`*^9, 
   3.9410591121568985`*^9}, 3.941059609446451*^9},
 CellLabel->
  "In[202]:=",ExpressionUUID->"73949f97-72a6-ee4f-9721-cf30c381cef8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MatrixForm", "@", 
     RowBox[{"Simplify", "@", 
      RowBox[{"EgtoUnit", "@", 
       RowBox[{"MySimplify", "@", 
        RowBox[{"StosE", "@", 
         RowBox[{"S", "[", 
          RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}]}]}]}]}]}], ",", 
    RowBox[{"MatrixForm", "@", 
     RowBox[{"Simplify", "@", 
      RowBox[{"EgtoUnit", "@", 
       RowBox[{"MySimplify", "@", 
        RowBox[{"StosE", "@", 
         RowBox[{"S", "[", 
          RowBox[{
           RowBox[{"-", "\[Alpha]"}], ",", 
           RowBox[{"-", "\[Beta]"}]}], "]"}]}]}]}]}]}]}], "}"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    InterpretationBox[
     StyleBox["\[Theta]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Theta][],
     Editable->False], "->", 
    RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "@", 
  RowBox[{"MySimplify", "@", 
   RowBox[{"Ptodx", "@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"P", "[", "\[Alpha]", "]"}], 
      RowBox[{"P", "[", 
       RowBox[{"-", "\[Alpha]"}], "]"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "@", 
  RowBox[{"MySimplify", "@", 
   RowBox[{"Ptodx", "@", 
    RowBox[{"StosE", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], 
       RowBox[{"S", "[", 
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], ",", 
         RowBox[{"-", "\[Beta]"}]}], "]"}]}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "@", 
  RowBox[{"MySimplify", "@", 
   RowBox[{"Ptodx", "@", 
    RowBox[{"StosE", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sE", "[", "\[Alpha]", "]"}], 
       RowBox[{"sE", "[", 
        RowBox[{"-", "\[Alpha]"}], "]"}]}], ")"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.927320889821429*^9, 3.927320927041163*^9}, {
   3.927664856241186*^9, 3.927664886473789*^9}, {3.9276649166069355`*^9, 
   3.927664928710169*^9}, 3.9276650273825607`*^9, {3.927921143380327*^9, 
   3.927921170566221*^9}, {3.941056435752527*^9, 3.9410564869559975`*^9}, {
   3.941056525810583*^9, 3.9410565760688477`*^9}, {3.9410566092456627`*^9, 
   3.9410566092477016`*^9}, {3.9410574128078136`*^9, 3.941057433911295*^9}, {
   3.941057523763294*^9, 3.9410575863756313`*^9}, {3.9410578152019176`*^9, 
   3.9410578385275*^9}, {3.941058190728016*^9, 3.9410581926790943`*^9}, {
   3.941058224179001*^9, 3.9410582297851543`*^9}, {3.9410582893857517`*^9, 
   3.9410582992587624`*^9}, {3.9410583537867546`*^9, 3.941058355840868*^9}, 
   3.941058402937435*^9},
 CellLabel->
  "In[665]:=",ExpressionUUID->"6627ae76-f699-ff49-ac78-a7de62655210"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conserved quantity", "Subsubsubsection",
 CellChangeTimes->{{3.92594232855426*^9, 3.925942329300476*^9}, {
  3.9410584846223316`*^9, 
  3.9410584862625637`*^9}},ExpressionUUID->"40c21e2e-336f-954e-bf39-\
588116c785d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "\[ScriptCapitalJ]", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "\[ScriptCapitalE]", "]"}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.9234305092959356`*^9, 3.92343057177039*^9}, {
  3.924143345026532*^9, 3.9241433804230437`*^9}, {3.9251629141525364`*^9, 
  3.925162930377226*^9}, {3.925163016887844*^9, 3.9251630175277596`*^9}, {
  3.925942337887844*^9, 3.9259423384710827`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"482a8aec-74fe-544c-b0c9-259f53e108e1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Special derivative", "Section",
 CellChangeTimes->{{3.92337042860631*^9, 3.923370441411807*^9}, 
   3.9410589089343834`*^9},ExpressionUUID->"ebabfa65-c8bd-4339-8c4c-\
60ffe51583a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dd", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Alpha]", "}"}], ",", 
     RowBox[{
      RowBox[{"dxp", "[", "\[Alpha]", "]"}], " ", 
      RowBox[{
       RowBox[{"CD", "[", 
        RowBox[{"-", "\[Alpha]"}], "]"}], "[", "exp", "]"}]}]}], "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.9231781407610855`*^9, 3.923178195232684*^9}, 
   3.9231800245351686`*^9, {3.923194031050898*^9, 3.92319404698227*^9}, {
   3.923195591761797*^9, 3.923195635407273*^9}, {3.923196723126055*^9, 
   3.923196732559446*^9}, 3.923347538007715*^9, 
   3.9410585157975216`*^9},ExpressionUUID->"9dfee0e7-7dfd-46d0-b9fc-\
eb4f5dd31d2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition in Parallel transport", "Section",
 CellChangeTimes->{{3.925771661383188*^9, 3.9257716738264694`*^9}, 
   3.9410609243111153`*^9, {3.9410610374751625`*^9, 3.9410610448252087`*^9}, {
   3.941061100767277*^9, 
   3.9410611206272087`*^9}},ExpressionUUID->"67dce49b-7f84-b041-be09-\
36899ceff019"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"Eb", "[", "\[Alpha]", "]"}], ",", "M4"}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.925942998776844*^9, 3.925943001146408*^9}, 
   3.94105853115724*^9},
 CellLabel->
  "In[283]:=",ExpressionUUID->"a4c14339-4787-4842-ace0-f4ddc7937fb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"En", "[", "\[Alpha]", "]"}], ",", "M4"}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.925943005946949*^9, 3.925943008485754*^9}, 
   3.941058532180252*^9},
 CellLabel->
  "In[284]:=",ExpressionUUID->"6797aa08-6db0-aa46-afaa-31f2aadcb23c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefScalarFunction", "[", "\[Psi]r", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.925504658046524*^9, 3.9255046913592453`*^9}, 
   3.941058530263073*^9},
 CellLabel->
  "In[282]:=",ExpressionUUID->"273f856e-b578-1543-9cc7-5a130fd773c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"\[Psi]", "[", "]"}], ",", "M4"}], "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.9234513530240383`*^9, 3.923451364615043*^9}, 
   3.9410605891254063`*^9},
 CellLabel->
  "In[316]:=",ExpressionUUID->"448111c1-99a9-8948-978f-3cbd80c69a79"],

Cell[CellGroupData[{

Cell["Marck\[CloseCurlyQuote]s tetrad", "Subsection",
 CellChangeTimes->{{3.925943081690197*^9, 3.925943100015396*^9}, {
  3.941061056777899*^9, 
  3.9410610666043015`*^9}},ExpressionUUID->"47daf209-2828-8749-9cb3-\
c42746872f0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "Print", "}"}], ",", 
    RowBox[{"DefBasis", "[", 
     RowBox[{"BMarck", ",", "TangentM4", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", 
      RowBox[{"BasisColor", " ", "\[Rule]", " ", "MyColor5"}]}], "]"}]}], 
   "]"}], ";"}]], "Code",
 CellChangeTimes->{
  3.9203555757504873`*^9, {3.920490619518646*^9, 3.920490632996689*^9}, {
   3.923174953360289*^9, 3.923174963697575*^9}, 3.9231954251613855`*^9, {
   3.923213343242678*^9, 3.92321334845065*^9}, {3.923213396486173*^9, 
   3.9232133973735466`*^9}, {3.923348256178906*^9, 3.923348334805991*^9}, {
   3.923348405710484*^9, 3.923348465351843*^9}, {3.9233623162052*^9, 
   3.9233623435702424`*^9}, 3.923365825262433*^9, 3.923367361436716*^9, 
   3.9233673934008226`*^9, {3.923367625831485*^9, 3.923367641428736*^9}, {
   3.923450183584746*^9, 3.923450189850731*^9}, {3.923450387453148*^9, 
   3.923450407698003*^9}, {3.923450443427821*^9, 3.923450445675392*^9}, 
   3.941060594203312*^9},ExpressionUUID->"6757b438-3a2d-c543-b301-\
8d221b8d2454"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MySimplifyMarck", "[", "f_", "]"}], ":=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Factor", "@", 
      RowBox[{"ToValues", "@", 
       RowBox[{"ToValues", "@", 
        RowBox[{"ToValues", "@", 
         RowBox[{"ComponentArray", "@", 
          RowBox[{"TraceBasisDummy", "@", 
           RowBox[{
            RowBox[{"ToBasis", "[", "BMarck", "]"}], "@", 
            RowBox[{
             RowBox[{"ToBasis", "[", "BMarck", "]"}], "@", 
             RowBox[{"ChangeCovD", "[", 
              RowBox[{"f", ",", "CD", ",", "PDBMarck"}], 
              "]"}]}]}]}]}]}]}]}]}], ",", 
     RowBox[{"TimeConstraint", "->", "1000"}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.923455432975771*^9, 3.923455503437912*^9}, {
  3.923455536254222*^9, 3.923455540689645*^9}},
 CellLabel->
  "In[314]:=",ExpressionUUID->"0db1dabc-d948-1d41-922a-50d2e612c27f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Orders", "Subsection",
 CellChangeTimes->{{3.92343598165756*^9, 3.923435984268443*^9}, {
  3.9410616472927914`*^9, 
  3.9410616531873207`*^9}},ExpressionUUID->"8dc44416-f214-43f7-aec5-\
af4b89f6de0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "\[Epsilon]", "]"}], ";"}]], "Code",
 CellChangeTimes->{{3.923716101803445*^9, 3.923716137411649*^9}, 
   3.941059986799185*^9},ExpressionUUID->"efc4001d-aaf8-3f45-9c05-\
9fea17dc5ad1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Orders", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"Expand", "@", "exp"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["0",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{0, $CellContext`B}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["0",
                    FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{0, $CellContext`B}],
           Editable->False]}]}], ",", 
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["1",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{1, $CellContext`B}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["1",
                    FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{1, $CellContext`B}],
           Editable->False]}]}], ",", 
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["2",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{2, $CellContext`B}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["2",
                    FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{2, $CellContext`B}],
           Editable->False]}]}], ",", 
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["3",
                   FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{3, $CellContext`B}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["3",
                    FontColor->RGBColor[{0.230469, 0.539063, 0.699219}]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{3, $CellContext`B}],
           Editable->False]}]}], ",", 
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["0",
                   FontColor->RGBColor[1., 0., 0.]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{0, $CellContext`BMarck}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["0",
                    FontColor->RGBColor[1., 0., 0.]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{0, $CellContext`BMarck}],
           Editable->False]}]}], ",", 
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["1",
                   FontColor->RGBColor[1., 0., 0.]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{1, $CellContext`BMarck}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["1",
                    FontColor->RGBColor[1., 0., 0.]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{1, $CellContext`BMarck}],
           Editable->False]}]}], ",", 
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["2",
                   FontColor->RGBColor[1., 0., 0.]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{2, $CellContext`BMarck}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["2",
                    FontColor->RGBColor[1., 0., 0.]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{2, $CellContext`BMarck}],
           Editable->False]}]}], ",", 
        RowBox[{
         InterpretationBox[
          StyleBox[GridBox[{
             {"s", 
              StyleBox[GridBox[{
                 {
                  StyleBox["3",
                   FontColor->RGBColor[1., 0., 0.]]},
                 {" "}
                },
                GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
               FontSize->9]}
            },
            GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.034999999999999996`]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}],
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`spin[{3, $CellContext`BMarck}],
          Editable->False], "\[Rule]", 
         RowBox[{
          InterpretationBox[
           StyleBox["\[Epsilon]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[Epsilon],
           Editable->False], " ", 
          InterpretationBox[
           StyleBox[GridBox[{
              {"s", 
               StyleBox[GridBox[{
                  {
                   StyleBox["3",
                    FontColor->RGBColor[1., 0., 0.]]},
                  {" "}
                 },
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.], {
                    Offset[0.034999999999999996`]}, 
                    Offset[0.]}, "Rows" -> {{
                    Offset[0.]}}}],
                FontSize->9]}
             },
             GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Center}}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.034999999999999996`]}, 
                 Offset[0.27999999999999997`]}, "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`spin[{3, $CellContext`BMarck}],
           Editable->False]}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.923435974180051*^9, 3.923715438311889*^9, {3.9251608930322304`*^9, 
   3.925160927530154*^9}, {3.925182913262258*^9, 3.9251829444401245`*^9}, {
   3.925355699304777*^9, 3.925355743161232*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"5e4d9fee-6c66-3440-975a-1d4163669ee6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kepler parameter", "Section",
 CellChangeTimes->{{3.923645317876422*^9, 3.9236453208069353`*^9}, 
   3.9420426157809906`*^9},ExpressionUUID->"ed5fe1b3-f6f4-4ee9-8bb9-\
1030e31e611a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rperi", "::", "usage"}], " ", "=", " ", 
   "\"\<\!\(\*SubscriptBox[\(r\), \(peri\)]\) (dimensionless) \
periapsis.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rapo", "::", "usage"}], " ", "=", " ", 
   "\"\<\!\(\*SubscriptBox[\(r\), \(apo\)]\) (dimensionless) apoapsis.\>\""}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "::", "usage"}], " ", "=", " ", 
   "\"\<p(dimensionless) semilatus rectum.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"e", "::", "usage"}], " ", "=", " ", 
   "\"\<e(dimensionless) Eccentricity.\>\""}], ";"}]}], "Code",
 CellChangeTimes->{{3.923645327798957*^9, 3.92364534601377*^9}, {
  3.9251609478628654`*^9, 3.925160971515505*^9}, {3.9410612886465225`*^9, 
  3.941061290604292*^9}, {3.941061496390856*^9, 3.941061541811352*^9}, {
  3.9410616828612747`*^9, 3.9410616999733944`*^9}, {3.941082806619812*^9, 
  3.941082809486002*^9}},
 CellLabel->
  "In[844]:=",ExpressionUUID->"660360f2-f2b9-4643-a1f3-1d20e96c0f5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", 
   RowBox[{"rperi", ",", 
    RowBox[{
    "PrintAs", "->", "\"\<\!\(\*SubscriptBox[\(r\), \(peri\)]\)\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", 
   RowBox[{"rapo", ",", 
    RowBox[{
    "PrintAs", "->", "\"\<\!\(\*SubscriptBox[\(r\), \(apo\)]\)\>\""}]}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "e", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", "p", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"psi", "[", "]"}], ",", "M4", ",", 
    RowBox[{
    "PrintAs", "->", "\"\<\!\(\*SubscriptBox[\(\[Psi]\), \(r\)]\)\>\""}]}], 
   "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.923645709981573*^9, 3.923645714469875*^9}, {
  3.9410613355027447`*^9, 3.941061350301396*^9}, {3.941061429620825*^9, 
  3.941061431240045*^9}, {3.9410615510546455`*^9, 3.9410615513129196`*^9}, {
  3.9410798732629437`*^9, 3.941079873569565*^9}, {3.941079912568056*^9, 
  3.941079914298996*^9}, {3.9410827523066196`*^9, 3.9410827523086185`*^9}, {
  3.9420445331392*^9, 
  3.942044536161234*^9}},ExpressionUUID->"ca4f1122-938e-4a55-8ebc-\
eee4dda68345"],

Cell[CellGroupData[{

Cell["Simplify", "Subsection",
 CellChangeTimes->{
  3.9402771381645355`*^9},ExpressionUUID->"903920d4-a1f0-2749-9a2d-\
3cb5619d412f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"XYZtoep", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"exp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"V", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", " ", "X"}], "-", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox["b",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`b,
              Editable->False], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "Z"}], ")"}]}]}], ")"}]}], ",", 
         RowBox[{"W", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["p", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                InterpretationBox[
                 StyleBox["b",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`b,
                 Editable->False]}], "+", "Y"}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             InterpretationBox[
              StyleBox["b",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`b,
              Editable->False], " ", "p", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "p"}], ")"}], " ", "Z"}], "+", 
            RowBox[{
             SuperscriptBox[
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False], "2"], " ", 
             SuperscriptBox["Z", "2"]}]}], ")"}]}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"X", "->", 
         RowBox[{
          RowBox[{"-", "3"}], "-", 
          SuperscriptBox["e", "2"], "+", "p"}]}], ",", 
        RowBox[{"Y", "->", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p"}], ")"}], "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["e", "2"]}]}]}], ",", " ", 
        RowBox[{"Z", "->", 
         RowBox[{"1", "-", 
          SuperscriptBox["e", "2"]}]}]}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"eptoXYZ", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"exp", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"3", "+", 
                  SuperscriptBox["e", "2"], "-", "p"}], "->", 
                 RowBox[{"-", "X"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "3"}], "-", 
                  SuperscriptBox["e", "2"], "+", "p"}], "->", "X"}]}], 
               "}"}]}], "\n", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                SuperscriptBox["e", "4"], "->", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "-", "Z"}], ")"}], "2"]}], ",", 
               RowBox[{
                SuperscriptBox["e", "2"], "->", 
                RowBox[{"1", "-", "Z"}]}]}], "}"}]}], "\n", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "p"}], ")"}], "2"], "->", 
               RowBox[{"Y", "+", 
                RowBox[{"4", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "Z"}], ")"}]}]}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", "p"}], ")"}], " ", "p"}], "->", 
               RowBox[{"Y", "-", 
                RowBox[{"4", " ", "Z"}]}]}]}], "}"}]}], "\n", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", "p"}], " ", "X"}], "+", 
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox["b",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`b,
                 Editable->False], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "Z"}], ")"}]}]}], "->", 
              RowBox[{"-", "V"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", " ", "X"}], "-", 
                RowBox[{"2", " ", 
                 InterpretationBox[
                  StyleBox["b",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`b,
                  Editable->False], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "Z"}], ")"}]}]}], ")"}], "->", 
              "V"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"2", " ", 
                InterpretationBox[
                 StyleBox["b",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`b,
                 Editable->False], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "Z"}], ")"}]}], "-", 
               RowBox[{"p", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", "p", "+", "Z"}], ")"}]}]}], "->", 
              RowBox[{"-", "V"}]}]}], "}"}]}], "\n", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["p", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  InterpretationBox[
                   StyleBox["b",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`b,
                   Editable->False]}], "+", "Y"}], ")"}]}], "-", 
              RowBox[{"2", " ", 
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], " ", "p", " ", 
               RowBox[{"(", 
                RowBox[{"2", "+", "p"}], ")"}], " ", "Z"}], "+", 
              RowBox[{
               SuperscriptBox[
                InterpretationBox[
                 StyleBox["b",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`b,
                 Editable->False], "2"], " ", 
               SuperscriptBox["Z", "2"]}]}], ")"}], "->", "W"}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", "e"}], ")"}], "2"]}], "+", 
              RowBox[{"p", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "-", 
                 RowBox[{"2", " ", "e"}], "+", "p"}], ")"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "e"}], ")"}], "2"]}], "+", 
              RowBox[{"p", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 RowBox[{"2", " ", "e"}], "+", "p"}], ")"}]}]}], ")"}]}], "->",
            "W"}], "}"}]}], "\n", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox["p", "2"], " ", "V"}], "-", "W", "-", 
            RowBox[{"p", " ", "V", " ", "Z"}]}], "->", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                InterpretationBox[
                 StyleBox["b",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`b,
                 Editable->False], "-", "p"}], ")"}], "2"]}], " ", 
            SuperscriptBox["Z", "2"]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["p", "2"]}], " ", "V"}], "+", "W", "+", 
            RowBox[{"p", " ", "V", " ", "Z"}]}], "->", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], "-", "p"}], ")"}], "2"], " ", 
            SuperscriptBox["Z", "2"]}]}]}], "}"}]}], "\n", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             InterpretationBox[
              StyleBox["b",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`b,
              Editable->False], "-", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], "2"], " ", "p"}], "+", 
             RowBox[{
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
              SuperscriptBox["p", "2"]}], "-", 
             SuperscriptBox["p", "3"], "+", 
             RowBox[{
              SuperscriptBox[
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], "3"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "Z"}], ")"}]}]}], ")"}]}], "->", "U1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             InterpretationBox[
              StyleBox["b",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`b,
              Editable->False], "-", "p"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], "2"], " ", "p"}], "+", 
             RowBox[{
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
              SuperscriptBox["p", "2"]}], "-", 
             SuperscriptBox["p", "3"], "-", 
             RowBox[{
              SuperscriptBox[
               InterpretationBox[
                StyleBox["b",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`b,
                Editable->False], "3"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "Z"}], ")"}]}]}], ")"}]}], "->", 
          "U1"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False], "2"]}], " ", "p"}], "-", 
           RowBox[{
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
            SuperscriptBox["p", "2"]}], "+", 
           SuperscriptBox["p", "3"], "+", 
           RowBox[{
            SuperscriptBox[
             InterpretationBox[
              StyleBox["b",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`b,
              Editable->False], "3"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "Z"}], ")"}]}]}], "->", 
          FractionBox["U1", 
           RowBox[{"p", "-", "b"}]]}]}], "}"}]}], "\n", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False], " ", "p"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", "p"}], ")"}], " ", 
           SuperscriptBox["p", "2"]}], "-", 
          RowBox[{
           SuperscriptBox[
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], "2"], " ", "Z"}]}], ")"}], "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["p", "2"], " ", "V"}], "-", "W"}], ")"}], "/", 
         "Z"}]}], "}"}]}]}], "]"}]}], ";"}], "\n"}], "Code",
 CellChangeTimes->{{3.940277117071633*^9, 3.940277121333147*^9}, {
   3.940278258201655*^9, 3.940278268010895*^9}, {3.9402784413854847`*^9, 
   3.9402784625911026`*^9}, {3.940278556118613*^9, 3.940278556415222*^9}, {
   3.940278763636633*^9, 3.940278766552155*^9}, {3.940278871133011*^9, 
   3.94027888359326*^9}, {3.940278978728704*^9, 3.940278997056301*^9}, {
   3.940280047365141*^9, 3.940280057445137*^9}, {3.940280719151914*^9, 
   3.940280725639611*^9}, 3.9402808225041294`*^9, {3.9402819661942635`*^9, 
   3.940281972941712*^9}, {3.9402820528902874`*^9, 3.940282057823118*^9}, {
   3.940297835690972*^9, 3.940297847026778*^9}, {3.940297928015238*^9, 
   3.9402979415723324`*^9}, {3.94081908902759*^9, 3.9408191129755135`*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"b4008b92-6d82-f84a-952a-5c1491926b28"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  FractionBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["p", "2"], " ", "V"}], "-", "W"}], ")"}], "Z"], "==", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"4", " ", 
     InterpretationBox[
      StyleBox["b",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`b,
      Editable->False], " ", "p"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", "p"}], ")"}], " ", 
     SuperscriptBox["p", "2"]}], "-", 
    RowBox[{
     SuperscriptBox[
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], "2"], " ", "Z"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "e"}], ")"}], "2"]}], "+", 
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "-", 
          RowBox[{"2", " ", "e"}], "+", "p"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "e"}], ")"}], "2"]}], "+", 
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"2", " ", "e"}], "+", "p"}], ")"}]}]}], ")"}]}], "==", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["p", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          InterpretationBox[
           StyleBox["b",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`b,
           Editable->False]}], "+", "Y"}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], " ", "p", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", "p"}], ")"}], " ", "Z"}], "+", 
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], "2"], " ", 
       SuperscriptBox["Z", "2"]}]}], ")"}]}], "//", "XYZtoep"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.940278430966768*^9, 3.94027843448934*^9}, {
  3.9402819790950813`*^9, 3.940282009691639*^9}},
 CellLabel->
  "In[373]:=",ExpressionUUID->"1503cc1a-af6a-8c43-9cff-df454bb93051"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["p", "2"], " ", "V"}], "-", "W"}], "Z"], "\[Equal]", 
  RowBox[{
   RowBox[{"4", " ", 
    InterpretationBox[
     StyleBox["b",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`b,
     Editable->False], " ", "p"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "4"}], "+", "p"}], ")"}], " ", 
    SuperscriptBox["p", "2"]}], "-", 
   RowBox[{
    SuperscriptBox[
     InterpretationBox[
      StyleBox["b",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`b,
      Editable->False], "2"], " ", "Z"}]}]}]], "Output",
 CellChangeTimes->{{3.9402819856606464`*^9, 3.940282010217783*^9}, 
   3.941061726920059*^9},
 CellLabel->
  "Out[373]=",ExpressionUUID->"72b60286-7165-1a46-880e-e40958c2389d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9402819856606464`*^9, 3.940282010217783*^9}, 
   3.9410617269632854`*^9},
 CellLabel->
  "Out[374]=",ExpressionUUID->"76a9a948-d569-fc4b-a0fc-4c39c623bf64"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], "2"], " ", "p"}], "+", 
     RowBox[{
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
      SuperscriptBox["p", "2"]}], "-", 
     SuperscriptBox["p", "3"], "+", 
     RowBox[{
      SuperscriptBox[
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], "3"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "Z"}], ")"}]}]}], ")"}], "//", "XYZtoep"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "//", "XYZtoep"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], "-", "p"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], "2"], " ", "p"}], "+", 
      RowBox[{
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
       SuperscriptBox["p", "2"]}], "-", 
      SuperscriptBox["p", "3"], "+", 
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "Z"}], ")"}]}]}], ")"}]}], "==", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], "-", "p"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], "2"], " ", "p"}], "+", 
      RowBox[{
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
       SuperscriptBox["p", "2"]}], "-", 
      SuperscriptBox["p", "3"], "-", 
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "Z"}], ")"}]}]}], ")"}]}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.940277604136393*^9, 3.940277666308464*^9}, {
  3.94027873825316*^9, 3.940278755699276*^9}, {3.940361305076748*^9, 
  3.940361305965351*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"b67ddd2c-8e08-8446-b3de-acd4a7ee84ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox["b",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`b,
     Editable->False], "3"], " ", 
   SuperscriptBox["e", "2"]}], "+", 
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox["b",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`b,
     Editable->False], "2"], " ", "p"}], "+", 
  RowBox[{
   InterpretationBox[
    StyleBox["b",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`b,
    Editable->False], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
   SuperscriptBox["p", "2"]}], "-", 
  SuperscriptBox["p", "3"]}]], "Output",
 CellChangeTimes->{{3.9402776155507946`*^9, 3.940277666908919*^9}, {
   3.940278752122423*^9, 3.940278756168257*^9}, 3.9410617291857014`*^9},
 CellLabel->
  "Out[375]=",ExpressionUUID->"4489f7a7-9739-3541-b469-39c2bab4303a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    InterpretationBox[
     StyleBox["b",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`b,
     Editable->False], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["e", "2"]}], ")"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      SuperscriptBox["e", "2"]}], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "p"}], ")"}], "2"]}], ")"}], " ", 
   SuperscriptBox["p", "2"]}], "+", 
  RowBox[{"2", " ", 
   InterpretationBox[
    StyleBox["b",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`b,
    Editable->False], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "p", "+", 
     RowBox[{
      SuperscriptBox["e", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "p"}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.9402776155507946`*^9, 3.940277666908919*^9}, {
   3.940278752122423*^9, 3.940278756168257*^9}, 3.9410617292102165`*^9},
 CellLabel->
  "Out[376]=",ExpressionUUID->"6e0a292d-028f-3247-affd-eaa7e59de7da"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.9402776155507946`*^9, 3.940277666908919*^9}, {
   3.940278752122423*^9, 3.940278756168257*^9}, 3.9410617292136555`*^9},
 CellLabel->
  "Out[377]=",ExpressionUUID->"3a4d080e-9085-7543-a0ac-f581ee706368"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Transform the perihelion and aphelion into the eccentricity and the \
dimensionless semimajor.\
\>", "Subsection",
 CellChangeTimes->{{3.908477906985406*^9, 3.908477910191768*^9}, {
   3.9084780758629985`*^9, 3.9084781040365543`*^9}, {3.908478144713646*^9, 
   3.908478148116352*^9}, {3.908478261176544*^9, 3.908478310901754*^9}, 
   3.9410618856608124`*^9, {3.941061919037321*^9, 
   3.9410619215567513`*^9}},ExpressionUUID->"844e5a31-abc2-4bcb-a8d1-\
e0430684b5c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rarpTope", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"exp0", "=", "exp"}], ",", "ReplaceSet"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"ReplaceSet", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rapo", "->", 
          FractionBox["p", 
           RowBox[{"1", "-", "e"}]]}], ",", 
         RowBox[{"rperi", "->", " ", 
          FractionBox["p", 
           RowBox[{"1", "+", "e"}]]}]}], "}"}]}], ";", " ", 
      RowBox[{"exp0", "/.", "ReplaceSet"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"rarpTope0", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"exp0", "=", "exp"}], ",", "ReplaceSet"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"ReplaceSet", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"rapo", "->", " ", "p"}], ",", 
         RowBox[{"rperi", "->", " ", "p"}]}], "}"}]}], ";", " ", 
      RowBox[{"exp0", "/.", "ReplaceSet"}]}]}], "]"}]}], ";"}]}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.9084782083046436`*^9, {3.908478449924858*^9, 3.908478573858107*^9}, 
   3.908478615575969*^9, {3.908478681003659*^9, 3.908478691710838*^9}, {
   3.9084791663966155`*^9, 3.908479168288314*^9}, {3.908490271572872*^9, 
   3.9084902718514*^9}, {3.9100775867171497`*^9, 3.910077590681085*^9}, {
   3.9101263243596077`*^9, 3.910126338203309*^9}, {3.923647262335412*^9, 
   3.923647268177514*^9}, {3.9236476512277017`*^9, 3.923647653004221*^9}, {
   3.9237119913216295`*^9, 3.923711995397488*^9}, {3.9251958174062386`*^9, 
   3.925195828712864*^9}, {3.941061744157545*^9, 3.9410617669634647`*^9}, {
   3.9410834383577023`*^9, 3.941083442465664*^9}},
 CellLabel->
  "In[378]:=",ExpressionUUID->"d34864f0-b338-4598-a39e-90fe681bd6e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Coefficient equation", "Subsection",
 CellChangeTimes->{{3.926109680775137*^9, 3.92610968340212*^9}, 
   3.941061957275896*^9},ExpressionUUID->"75901822-34d1-ec4e-a6e9-\
9b3c3a0d9793"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"K2", "[", "r_", "]"}], ":=", 
   FractionBox[
    RowBox[{"f", "[", "r", "]"}], 
    RowBox[{" ", 
     SuperscriptBox["r", "2"]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"K3", "[", "r_", "]"}], ":=", " ", 
    FractionBox[
     RowBox[{"sp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["f",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`f,
           Editable->False], "[", "r", "]"}]}], "+", 
        RowBox[{"r", " ", 
         RowBox[{
          SuperscriptBox[
           InterpretationBox[
            StyleBox["f",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`f,
            Editable->False], "\[Prime]",
           MultilineFunction->None], "[", "r", "]"}]}]}], ")"}]}], 
     SuperscriptBox["r", "2"]]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fEJ02sp", "[", "r_", "]"}], ":=", 
   RowBox[{
    SqrtBox["\[ScriptCapitalE]20"], " ", 
    SqrtBox["\[ScriptCapitalJ]20"], " ", 
    RowBox[{"K3", "[", "r", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fJ02sp", "[", "r_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"K2", "[", "r", "]"}]}], "+", 
    FractionBox[
     RowBox[{
      SqrtBox["\[ScriptCapitalE]20"], " ", 
      RowBox[{"K3", "[", "r", "]"}]}], 
     RowBox[{"2", " ", 
      SqrtBox["\[ScriptCapitalJ]20"]}]]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fE02sp", "[", "r_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{
       SqrtBox["\[ScriptCapitalJ]20"], " ", 
       RowBox[{"K3", "[", "r", "]"}]}], 
      RowBox[{"2", " ", 
       SqrtBox["\[ScriptCapitalE]20"]}]]}], ")"}]}], ";"}]}], "Code",
 CellChangeTimes->{
  3.926109698973152*^9, {3.9267977622765474`*^9, 3.926797782299996*^9}, 
   3.926798143428835*^9},
 CellLabel->
  "In[380]:=",ExpressionUUID->"af435e51-e9ce-824c-89e3-d65ebc28f70b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ParamExactBW", "Subsection",
 CellChangeTimes->{{3.926108893930408*^9, 3.926108898173958*^9}, {
   3.9261089554629803`*^9, 3.9261089569576664`*^9}, 
   3.941064859734062*^9},ExpressionUUID->"9f57f22a-19f1-6c42-af72-\
ab7cb5cf3371"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParamExactBW", "::", "usage"}], " ", "=", " ", 
   "\"\<ParamExactBW[sp,sn,e,p,b,M][Exp_] gives a concrete expression for \
{e,p}.\>\""}], ";"}]], "Code",
 CellChangeTimes->{{3.941064870006405*^9, 3.9410649004064484`*^9}, {
  3.9410649583513737`*^9, 3.9410649679948616`*^9}},
 CellLabel->
  "In[628]:=",ExpressionUUID->"a76b345b-cb58-e844-8e04-d6eb90679c8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParamExactBW", "[", 
    RowBox[{
    "spE_", ",", "snE_", ",", "eE_", ",", "pE_", ",", "bE_", ",", "ME_"}], 
    "]"}], "[", "Exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "r0", ",", "r1E", ",", "r2E", ",", "r3E", ",", "r4E", ",", "rnE", ",", 
      "rpE", ",", "k0E", ",", "hrE", ",", "hr32E", ",", "hrnE", ",", "hrpE", 
      ",", "\n", "A0f", ",", "A1f", ",", "A2f", ",", "A3f", ",", "K1", ",", 
      "K2", ",", "K3", ",", "fEJ02sp", ",", "fJ02sp", ",", "fE02sp", ",", 
      "\n", "\[ScriptCapitalE]2Approxep", ",", "\[ScriptCapitalE]20", ",", 
      "\[ScriptCapitalJ]2Approxep", ",", "\[ScriptCapitalJ]20", ",", 
      "\[ScriptCapitalE]E", ",", "\[ScriptCapitalJ]E", ",", "qr0E", ",", 
      "qt0E", ",", "q\[CurlyPhi]0E", ",", "q\[Psi]0E", ",", "\n", "XE", ",", 
      "YE", ",", "ZE", ",", "WE", ",", "VE", ",", "UE", ",", "U1E", ",", 
      "U2E", ",", "U3E", ",", "WsE", ",", "WbpE"}], "}"}], ",", "\n", "\n", 
    RowBox[{
     RowBox[{"XE", "=", 
      RowBox[{"pE", "-", "3", "-", 
       SuperscriptBox["eE", "2"]}]}], ";", "\n", 
     RowBox[{"YE", "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"pE", "-", "2"}], ")"}], "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["eE", "2"]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ZE", "=", 
      RowBox[{"1", "-", 
       SuperscriptBox["eE", "2"]}]}], ";", "\n", 
     RowBox[{"WE", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["pE", "2"], " ", "YE"}], "+", 
        RowBox[{"2", " ", "bE", " ", "pE", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "pE", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", "pE"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "ZE"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["bE", "2"], " ", 
         SuperscriptBox["ZE", "2"]}]}], ")"}]}], ";", "\n", 
     RowBox[{"VE", "=", 
      RowBox[{
       RowBox[{"pE", " ", "XE"}], "-", 
       RowBox[{"2", " ", "bE", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}]}], ";", "\n", 
     RowBox[{"UE", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"bE", "-", "pE"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["bE", "2"], " ", "pE"}], "+", 
         RowBox[{"bE", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "pE"}], ")"}], " ", 
          SuperscriptBox["pE", "2"]}], "-", 
         SuperscriptBox["pE", "3"], "-", 
         RowBox[{
          SuperscriptBox["bE", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ZE"}], ")"}]}]}], ")"}]}]}], ";", "\n", 
     "\n", 
     RowBox[{"U1E", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"bE", "-", "pE"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["bE", "2"], " ", "pE"}], "+", 
         RowBox[{"bE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "pE"}], ")"}], " ", 
          SuperscriptBox["pE", "2"]}], "-", 
         SuperscriptBox["pE", "3"], "-", 
         RowBox[{
          SuperscriptBox["bE", "3"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ZE"}], ")"}]}]}], ")"}]}]}], ";", "\n", 
     RowBox[{"U2E", "=", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["pE", "5"]}], "+", 
       RowBox[{
        SuperscriptBox["bE", "2"], " ", 
        SuperscriptBox["pE", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"16", "-", 
          RowBox[{"pE", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["bE", "3"], " ", "pE", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pE", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "-", 
          RowBox[{"3", " ", "ZE"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["bE", "4"], " ", 
        SuperscriptBox["ZE", "2"]}], "+", 
       RowBox[{"2", " ", "bE", " ", 
        SuperscriptBox["pE", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "8"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "pE"}], ")"}], " ", "pE"}], "+", "ZE"}],
          ")"}]}]}]}], ";", "\n", 
     RowBox[{"U3E", "=", 
      RowBox[{
       RowBox[{
        SuperscriptBox["bE", "2"], " ", 
        SuperscriptBox["ZE", "2"]}], "-", 
       RowBox[{"2", " ", "bE", " ", "pE", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pE", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "+", 
          RowBox[{"2", " ", "ZE"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["pE", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", "pE"}], ")"}], " ", "pE"}], "+", 
          RowBox[{"4", " ", "ZE"}]}], ")"}]}]}]}], ";", "\n", "\n", 
     RowBox[{"WsE", " ", "=", " ", 
      RowBox[{
       RowBox[{"pE", " ", 
        RowBox[{"(", 
         RowBox[{"9", "-", 
          RowBox[{"2", " ", "pE"}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "ZE"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"8", " ", "bE", " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", "ZE"}], ")"}]}]}]}], ";", " ", "\n", 
     RowBox[{"WbpE", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "bE"}], "+", "pE"}], ")"}], " ", "WE"}]}], ";", "\n", 
     "\n", 
     RowBox[{"r1E", "=", 
      FractionBox["pE", 
       RowBox[{"1", "-", "eE"}]]}], ";", " ", "\n", 
     RowBox[{"r2E", "=", 
      FractionBox["pE", 
       RowBox[{"1", "+", "eE"}]]}], ";", "\n", "\n", "\n", "\n", 
     RowBox[{"\[ScriptCapitalE]2Approxep", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"spE", " ", 
         SuperscriptBox["ZE", "2"], " ", 
         SqrtBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"bE", "-", "pE"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["pE", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"4", " ", "bE"}], "+", "YE"}], ")"}]}], "-", 
               RowBox[{"2", " ", "bE", " ", "pE", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "pE"}], ")"}], " ", "ZE"}], "+", 
               RowBox[{
                SuperscriptBox["bE", "2"], " ", 
                SuperscriptBox["ZE", "2"]}]}], ")"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["pE", "2"], "+", 
           RowBox[{"bE", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "pE"}], "+", "ZE"}], ")"}]}]}], 
          ")"}]}], 
        RowBox[{
         SuperscriptBox["pE", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pE", " ", "XE"}], "-", 
            RowBox[{"2", " ", "bE", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}], ")"}], "2"]}]], 
       "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          SuperscriptBox["pE", "2"], " ", "YE"}], "+", 
         RowBox[{
          SuperscriptBox["bE", "2"], " ", 
          SuperscriptBox["ZE", "2"]}], "-", 
         RowBox[{"2", " ", "bE", " ", "pE", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pE", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "+", 
            RowBox[{"2", " ", "ZE"}]}], ")"}]}]}], 
        RowBox[{
         SuperscriptBox["pE", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pE", " ", "XE"}], "-", 
           RowBox[{"2", " ", "bE", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}], ")"}]}]]}]}], ";", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalJ]2Approxep", "=", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["pE", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "bE"}], "+", "pE"}], ")"}]}], 
        RowBox[{
         RowBox[{"pE", " ", "XE"}], "+", 
         RowBox[{"2", " ", "bE", " ", 
          RowBox[{"(", 
           RowBox[{"2", "-", "ZE"}], ")"}]}]}]], "+", 
       FractionBox[
        RowBox[{"spE", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pE", " ", 
            RowBox[{"(", 
             RowBox[{"9", "-", 
              RowBox[{"2", " ", "pE"}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "ZE"}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{"8", " ", "bE", " ", 
            RowBox[{"(", 
             RowBox[{"2", "-", "ZE"}], ")"}]}]}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "bE"}], "+", "pE"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["pE", "2"], " ", "YE"}], "+", 
             RowBox[{"2", " ", "bE", " ", "pE", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "pE", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "+", "pE"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "ZE"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["bE", "2"], " ", 
              SuperscriptBox["ZE", "2"]}]}], ")"}]}]]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pE", " ", "XE"}], "+", 
           RowBox[{"2", " ", "bE", " ", 
            RowBox[{"(", 
             RowBox[{"2", "-", "ZE"}], ")"}]}]}], ")"}], "2"]]}]}], ";", " ", 
     "\n", "\n", "\n", 
     RowBox[{"\[ScriptCapitalE]E", "=", 
      SqrtBox["\[ScriptCapitalE]2Approxep"]}], ";", " ", "\n", 
     RowBox[{"\[ScriptCapitalJ]E", "=", 
      SqrtBox["\[ScriptCapitalJ]2Approxep"]}], ";", " ", "\n", "\n", 
     RowBox[{"A0f", "=", 
      FractionBox[
       RowBox[{"bE", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "4", " ", "spE", " ", "\[ScriptCapitalE]E", " ", 
           "\[ScriptCapitalJ]E"}], "+", 
          SuperscriptBox["\[ScriptCapitalJ]E", "2"]}], ")"}]}], 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ScriptCapitalE]E", "2"]}]]}], ";", "\n", 
     RowBox[{"A1f", "=", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "3", " ", "spE", " ", "\[ScriptCapitalE]E", " ", 
           "\[ScriptCapitalJ]E"}], "+", 
          SuperscriptBox["\[ScriptCapitalJ]E", "2"]}], ")"}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ScriptCapitalE]E", "2"]}]]}], ";", " ", "\n", 
     RowBox[{"A2f", "=", 
      FractionBox[
       RowBox[{"bE", "+", 
        RowBox[{
        "2", " ", "spE", " ", "\[ScriptCapitalE]E", " ", 
         "\[ScriptCapitalJ]E"}], "+", 
        SuperscriptBox["\[ScriptCapitalJ]E", "2"]}], 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ScriptCapitalE]E", "2"]}]]}], ";", "\n", 
     RowBox[{"A3f", "=", 
      FractionBox["2", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ScriptCapitalE]E", "2"]}]]}], ";", "\n", "\n", "\n",
      "\n", 
     RowBox[{"r3E", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"pE", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"bE", "-", "pE"}], ")"}], "2"], "+", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"bE", "-", "pE"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["bE", "2"], " ", "pE"}], "+", 
               RowBox[{"bE", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "pE"}], ")"}], " ", 
                SuperscriptBox["pE", "2"]}], "-", 
               SuperscriptBox["pE", "3"], "-", 
               RowBox[{
                SuperscriptBox["bE", "3"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "ZE"}], ")"}]}]}], ")"}]}]]}], 
          ")"}], " ", "ZE"}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["pE", "2"], " ", "VE"}], "-", "WE"}]], "+", 
       RowBox[{"spE", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"pE", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "bE"}], "+", "pE"}], ")"}], " ", "WE"}]], " ", 
            SuperscriptBox["ZE", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["pE", "2"], "+", 
              RowBox[{"bE", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "pE"}], "+", "ZE"}], ")"}]}]}], 
             ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["pE", "2"]}], " ", "VE"}], "+", "WE"}], ")"}], 
            "2"]], "+", 
          FractionBox[
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "bE"}], "+", "pE"}], ")"}], " ", "WE"}]], " ", 
            "ZE", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["pE", "5"]}], "+", 
              RowBox[{
               SuperscriptBox["bE", "2"], " ", 
               SuperscriptBox["pE", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"16", "-", 
                 RowBox[{"pE", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["bE", "3"], " ", "pE", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"pE", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "-", 
                 RowBox[{"3", " ", "ZE"}]}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["bE", "4"], " ", 
               SuperscriptBox["ZE", "2"]}], "+", 
              RowBox[{"2", " ", "bE", " ", 
               SuperscriptBox["pE", "3"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "8"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "pE"}], ")"}], " ", "pE"}], "+", 
                 "ZE"}], ")"}]}]}], ")"}]}], 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["pE", "2"], " ", "VE"}], "-", "WE"}], ")"}], 
            " ", 
            SqrtBox[
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"bE", "-", "pE"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SuperscriptBox["bE", "2"]}], " ", "pE"}], "-", 
                  RowBox[{"bE", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "pE"}], ")"}], " ", 
                   SuperscriptBox["pE", "2"]}], "+", 
                  SuperscriptBox["pE", "3"], "+", 
                  RowBox[{
                   SuperscriptBox["bE", "3"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "ZE"}], ")"}]}]}], ")"}]}], 
               ")"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "bE", " ", "pE"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "4"}], "+", "pE"}], ")"}], " ", 
               SuperscriptBox["pE", "2"]}], "-", 
              RowBox[{
               SuperscriptBox["bE", "2"], " ", "ZE"}]}], ")"}]}]]}], 
         ")"}]}]}]}], ";", "\n", 
     RowBox[{"r4E", "=", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"bE", " ", 
          RowBox[{"(", 
           RowBox[{"bE", "-", "pE"}], ")"}], " ", "pE"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"bE", "-", "pE"}], ")"}], "2"], "+", 
          SqrtBox["UE"]}]]}], "+", 
       FractionBox[
        RowBox[{"bE", " ", "spE", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["pE", "2"]}], " ", "VE"}], "+", "WE"}], ")"}], 
          "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", "bE"}], "+", "pE"}]], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"bE", "-", "pE"}], ")"}], "2"], "+", 
                SqrtBox["UE"]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "pE"}], ")"}], " ", "pE"}], "+", 
                RowBox[{"bE", " ", "ZE"}]}], ")"}], " ", 
              SqrtBox[
               RowBox[{
                RowBox[{
                 SuperscriptBox["bE", "2"], " ", 
                 SuperscriptBox["ZE", "2"]}], "-", 
                RowBox[{"2", " ", "bE", " ", "pE", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"pE", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "+", 
                   RowBox[{"2", " ", "ZE"}]}], ")"}]}], "+", 
                RowBox[{
                 SuperscriptBox["pE", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "pE"}], ")"}], " ", "pE"}], "+", 
                   RowBox[{"4", " ", "ZE"}]}], ")"}]}]}]]}], 
             RowBox[{
              SuperscriptBox["ZE", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "pE"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", " ", "bE"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "pE"}], ")"}], " ", "pE"}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["bE", "2"], " ", "ZE"}]}], ")"}], "3"]}]]}], 
           "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "bE"}], "+", "pE"}], ")"}], " ", "WE"}], ")"}], 
              RowBox[{"3", "/", "2"}]], " ", 
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"2", " ", 
                  SuperscriptBox["pE", "5"]}], "+", 
                 RowBox[{
                  SuperscriptBox["bE", "2"], " ", 
                  SuperscriptBox["pE", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"16", "-", 
                    RowBox[{"pE", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["bE", "3"], " ", "pE", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"pE", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "-", 
                    RowBox[{"3", " ", "ZE"}]}], ")"}]}], "-", 
                 RowBox[{"2", " ", "bE", " ", 
                  SuperscriptBox["pE", "3"], " ", 
                  RowBox[{"(", 
                   RowBox[{"8", "-", 
                    RowBox[{"2", " ", "pE"}], "+", 
                    SuperscriptBox["pE", "2"], "-", "ZE"}], ")"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["bE", "4"], " ", 
                  SuperscriptBox["ZE", "2"]}]}], 
                RowBox[{
                 SqrtBox["UE"], " ", "ZE", " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", " ", "bE", " ", "pE"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "pE"}], ")"}], " ", 
                    SuperscriptBox["pE", "2"]}], "-", 
                    RowBox[{
                    SuperscriptBox["bE", "2"], " ", "ZE"}]}], ")"}], "2"]}]], 
               "+", 
               FractionBox[
                RowBox[{"2", " ", "pE", " ", "ZE", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["pE", "2"], "+", 
                   RowBox[{"bE", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "pE"}], "+", "ZE"}], ")"}]}]}], 
                  ")"}]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    SuperscriptBox["pE", "2"]}], " ", "VE"}], "+", "WE"}], 
                  ")"}], "2"]]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["pE", "2"], " ", "VE"}], "-", "WE"}], ")"}], 
             " ", "WE"}]]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"bE", "-", "pE"}], ")"}], "2"], "+", 
            SqrtBox["UE"]}], ")"}], "2"]}]]}]}], ";", "\n", "\n", "\n", "\n", 
     RowBox[{"rnE", "=", 
      RowBox[{"1", "-", 
       SqrtBox[
        RowBox[{"1", "-", "bE"}]]}]}], ";", " ", "\n", 
     RowBox[{"rpE", "=", 
      RowBox[{"1", "+", 
       SqrtBox[
        RowBox[{"1", "-", "bE"}]]}]}], ";", "  ", "\n", 
     RowBox[{"k0E", "=", 
      SqrtBox[
       RowBox[{
        FractionBox[
         RowBox[{"r1E", "-", "r2E"}], 
         RowBox[{"r1E", "-", "r3E"}]], 
        FractionBox[
         RowBox[{"(", 
          RowBox[{"r3E", "-", "r4E"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"r2E", "-", "r4E"}], ")"}]]}]]}], ";", "  ", "\n", 
     RowBox[{"hrE", "=", 
      FractionBox[
       RowBox[{"r1E", "-", "r2E"}], 
       RowBox[{"r1E", "-", "r3E"}]]}], ";", " ", "\n", 
     RowBox[{"hr32E", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"r1E", "-", "r2E"}], 
        RowBox[{"r1E", "-", "r3E"}]], 
       FractionBox["r3E", "r2E"]}]}], ";", " ", "\n", 
     RowBox[{"hrnE", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"r1E", "-", "r2E"}], 
        RowBox[{"r1E", "-", "r3E"}]], 
       FractionBox[
        RowBox[{"r3E", "-", "rnE"}], 
        RowBox[{"r2E", "-", "rnE"}]]}]}], ";", "  ", "\n", 
     RowBox[{"hrpE", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"r1E", "-", "r2E"}], 
        RowBox[{"r1E", "-", "r3E"}]], 
       FractionBox[
        RowBox[{"r3E", "-", "rpE"}], 
        RowBox[{"r2E", "-", "rpE"}]]}]}], ";", " ", "\n", "\n", 
     RowBox[{"qr0E", "=", "0"}], ";", 
     RowBox[{"qt0E", "=", "0"}], ";", 
     RowBox[{"q\[CurlyPhi]0E", "=", "0"}], ";", 
     RowBox[{"q\[Psi]0E", "=", "\[Pi]"}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "/.", 
               RowBox[{"{", 
                RowBox[{"f", "->", "fShBW"}], "}"}]}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"A0", "->", "A0f"}], ",", 
                RowBox[{"A1", "->", "A1f"}], ",", 
                RowBox[{"A2", "->", "A2f"}], ",", 
                RowBox[{"A3", "->", "A3f"}]}], "}"}]}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"X", "->", "XE"}], ",", 
               RowBox[{"Y", "->", "YE"}], ",", 
               RowBox[{"Z", "->", "ZE"}], ",", 
               RowBox[{"W", "->", "WE"}], ",", 
               RowBox[{"V", "->", "VE"}], ",", 
               RowBox[{"U", "->", "UE"}]}], "}"}]}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"U1", "->", "U1E"}], ",", 
              RowBox[{"U2", "->", "U2E"}], ",", 
              RowBox[{"U3", "->", "U3E"}]}], "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Ws", "->", "WsE"}], ",", 
             RowBox[{"Wbp", "->", "WbpE"}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sn", "->", "snE"}], ",", 
            RowBox[{"sp", "->", "spE"}], ",", 
            RowBox[{"e", "->", "eE"}], ",", 
            RowBox[{"p", "->", "pE"}], ",", 
            RowBox[{"b", "->", "bE"}], ",", 
            RowBox[{"M", "->", "ME"}]}], "}"}]}], "\n", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"r1", "->", "r1E"}], ",", 
           RowBox[{"r2", "->", "r2E"}], ",", 
           RowBox[{"r3", "->", "r3E"}], ",", 
           RowBox[{"r4", "->", "r4E"}], ",", 
           RowBox[{"rn", "->", "rnE"}], ",", 
           RowBox[{"rp", "->", "rpE"}]}], "}"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k0", "->", "k0E"}], ",", 
          RowBox[{"hr", "->", "hrE"}], ",", 
          RowBox[{"hr32", "->", "hr32E"}], ",", 
          RowBox[{"hrp", "->", "hrpE"}], ",", 
          RowBox[{"hrn", "->", "hrnE"}]}], "}"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"qr0", "->", "qr0E"}], ",", 
         RowBox[{"qt0", "->", "qt0E"}], ",", 
         RowBox[{"q\[CurlyPhi]0", "->", "q\[CurlyPhi]0E"}], ",", 
         RowBox[{"q\[Psi]0", "->", "q\[Psi]0E"}]}], "}"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[ScriptCapitalE]", "->", "\[ScriptCapitalE]E"}], ",", 
        RowBox[{"\[ScriptCapitalJ]", "->", "\[ScriptCapitalJ]E"}]}], 
       "}"}]}]}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.924074397163789*^9, 3.9240744771391788`*^9}, {
   3.924074526381501*^9, 3.924074680020439*^9}, {3.924074858986982*^9, 
   3.924075432683774*^9}, {3.924075661741201*^9, 3.924075781017289*^9}, {
   3.9240758173678265`*^9, 3.924075823902484*^9}, {3.924075856142085*^9, 
   3.924075858085011*^9}, {3.924120123206002*^9, 3.924120151885746*^9}, {
   3.924120592316444*^9, 3.924120592454108*^9}, 3.924120781692992*^9, {
   3.9241216340126*^9, 3.9241216347261705`*^9}, 3.92412169677894*^9, {
   3.924121800542921*^9, 3.924121801304575*^9}, 3.924639365857199*^9, 
   3.924639490432113*^9, {3.924727156288867*^9, 3.924727259388543*^9}, {
   3.924727491278808*^9, 3.924727585222608*^9}, {3.924727675610123*^9, 
   3.924727897056104*^9}, {3.924728034661218*^9, 3.924728247365364*^9}, {
   3.924728466107894*^9, 3.9247286010282345`*^9}, {3.924728974667942*^9, 
   3.924729002953677*^9}, {3.9247307966204*^9, 3.924730808919733*^9}, 
   3.924731188916659*^9, {3.924731234217914*^9, 3.92473123978734*^9}, 
   3.924731642802945*^9, 3.924731789767218*^9, {3.924731866651505*^9, 
   3.924731876167529*^9}, {3.9247320623587675`*^9, 3.924732084337485*^9}, {
   3.924732183848584*^9, 3.924732193921583*^9}, {3.924732248463009*^9, 
   3.924732251198433*^9}, {3.924732284942731*^9, 3.924732295589414*^9}, {
   3.924732344905365*^9, 3.924732346736529*^9}, {3.924732391933182*^9, 
   3.924732423869779*^9}, 3.924732476147718*^9, 3.924732582884379*^9, {
   3.924732621409521*^9, 3.924732629412812*^9}, {3.924733558479198*^9, 
   3.924733622747411*^9}, {3.925279784498171*^9, 3.925279786667284*^9}, {
   3.925279817444807*^9, 3.9252798666686344`*^9}, {3.9252799116840744`*^9, 
   3.925279997361967*^9}, {3.925280046647148*^9, 3.9252801793912525`*^9}, {
   3.925280221502238*^9, 3.925280359356735*^9}, {3.9252803895044365`*^9, 
   3.925280608210667*^9}, {3.925280700276449*^9, 3.925280725185517*^9}, {
   3.925280783956076*^9, 3.925280792802498*^9}, {3.925280837780316*^9, 
   3.92528085741255*^9}, {3.925280888544834*^9, 3.925281127261328*^9}, {
   3.925281176954571*^9, 3.925281208319004*^9}, {3.925281321951416*^9, 
   3.925281350428633*^9}, {3.925281385855503*^9, 3.925281419398504*^9}, {
   3.925281462730028*^9, 3.92528151479228*^9}, {3.925281580554611*^9, 
   3.92528198340226*^9}, {3.925286309501161*^9, 3.925286320241455*^9}, {
   3.925286356888021*^9, 3.925286393223692*^9}, {3.9252864435823345`*^9, 
   3.925286454035415*^9}, {3.925286642447813*^9, 3.925286680760835*^9}, {
   3.925286715375749*^9, 3.92528673559848*^9}, {3.925286774101452*^9, 
   3.925286874779384*^9}, {3.925286906231985*^9, 3.925286934799721*^9}, {
   3.925286971239837*^9, 3.925287003171458*^9}, {3.925287060362763*^9, 
   3.9252870652994785`*^9}, {3.9252878734127064`*^9, 3.925287874650692*^9}, {
   3.925288424795582*^9, 3.925288436002741*^9}, {3.925288528538103*^9, 
   3.9252885285480785`*^9}, {3.925288746030613*^9, 3.925288772346558*^9}, {
   3.925289705203268*^9, 3.9252897109881725`*^9}, {3.92594071229088*^9, 
   3.9259407357362366`*^9}, {3.925940770813324*^9, 3.925940917553667*^9}, {
   3.925941141344927*^9, 3.925941145615169*^9}, 3.925941183748474*^9, {
   3.925941270184939*^9, 3.925941296902275*^9}, {3.925941335700434*^9, 
   3.925941362785557*^9}, {3.925941398164297*^9, 3.92594141834639*^9}, {
   3.925941468812145*^9, 3.925941468814144*^9}, {3.92647497718462*^9, 
   3.9264749778484135`*^9}, 3.926475011331266*^9, {3.926475088423757*^9, 
   3.926475115187191*^9}, {3.926480712185978*^9, 3.926480712686001*^9}, {
   3.92648081403162*^9, 3.926480898167879*^9}, {3.926480974126842*^9, 
   3.926481178262932*^9}, {3.927090610160301*^9, 3.9270906280597515`*^9}, {
   3.927091094050093*^9, 3.927091103955452*^9}, {3.927091181177046*^9, 
   3.927091252033263*^9}, {3.927091319750496*^9, 3.927091386311091*^9}, {
   3.927091423415324*^9, 3.927091505553376*^9}, {3.927091545234856*^9, 
   3.927091688726467*^9}, {3.927091736980217*^9, 3.927091885532909*^9}, {
   3.927091922545985*^9, 3.927091993137661*^9}, {3.9270920259108105`*^9, 
   3.92709203674733*^9}, {3.927092087816809*^9, 3.927092089942095*^9}, {
   3.92709216041942*^9, 3.927092193558002*^9}, {3.927092378806881*^9, 
   3.927092380236979*^9}, 3.927092822493008*^9, {3.928381825199503*^9, 
   3.928381829797632*^9}, {3.9403059341579475`*^9, 3.940305934706192*^9}, {
   3.9410558121938076`*^9, 3.94105581220883*^9}, 3.941062504283764*^9, {
   3.9410625576896057`*^9, 3.941062568170656*^9}, 3.9410626077557163`*^9, {
   3.941062650019718*^9, 3.941062811276905*^9}, {3.941062885818033*^9, 
   3.9410628865457973`*^9}, {3.9410629362055416`*^9, 
   3.9410630299107075`*^9}, {3.9410632280958023`*^9, 
   3.9410632366466007`*^9}, {3.9410636233159504`*^9, 3.941063671578718*^9}, 
   3.941077237812374*^9},ExpressionUUID->"edd3a99f-a7a8-174d-bb33-\
befcd7f62b9e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Conclusion", "Section",
 CellChangeTimes->{{3.941342729309494*^9, 
  3.941342731558199*^9}},ExpressionUUID->"9e3d3b42-9bcc-344a-8caf-\
e7e0238f280b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XE", "=", 
   RowBox[{"p", "-", "3", "-", 
    SuperscriptBox["e", "2"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"YE", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"p", "-", "2"}], ")"}], "2"], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["e", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZE", "=", 
   RowBox[{"1", "-", 
    SuperscriptBox["e", "2"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"WE", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["p", "2"], " ", "YE"}], "+", 
     RowBox[{"2", " ", 
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "p", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "p"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "ZE"}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox[
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], "2"], " ", 
      SuperscriptBox["ZE", "2"]}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"VE", "=", 
   RowBox[{
    RowBox[{"p", " ", "XE"}], "-", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox["b",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`b,
      Editable->False], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"U1E", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], "-", "p"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], "2"], " ", "p"}], "+", 
      RowBox[{
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
       SuperscriptBox["p", "2"]}], "-", 
      SuperscriptBox["p", "3"], "-", 
      RowBox[{
       SuperscriptBox[
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ZE"}], ")"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"U2E", "=", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox["p", "5"]}], "+", 
    RowBox[{
     SuperscriptBox[
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], "2"], " ", 
     SuperscriptBox["p", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"16", "-", 
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], "3"], " ", "p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "-", 
       RowBox[{"3", " ", "ZE"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], "4"], " ", 
     SuperscriptBox["ZE", "2"]}], "+", 
    RowBox[{"2", " ", 
     InterpretationBox[
      StyleBox["b",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`b,
      Editable->False], " ", 
     SuperscriptBox["p", "3"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "8"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "p"}], ")"}], " ", "p"}], "+", "ZE"}], 
      ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"U3E", "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], "2"], " ", 
      SuperscriptBox["ZE", "2"]}], "-", 
     RowBox[{"2", " ", 
      InterpretationBox[
       StyleBox["b",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`b,
       Editable->False], " ", "p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "ZE"}], ")"}]}], "+", 
        RowBox[{"2", " ", "ZE"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["p", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "+", "p"}], ")"}], " ", "p"}], "+", 
        RowBox[{"4", " ", "ZE"}]}], ")"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"r1solep", "=", 
   FractionBox["p", 
    RowBox[{"1", "-", "e"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r2solep", "=", 
   FractionBox["p", 
    RowBox[{"1", "+", "e"}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r3solep", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False], "-", "p"}], ")"}], "2"], "+", 
        SqrtBox["U1"]}], ")"}], "Z"}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["p", "2"], " ", "V"}], "-", "W"}]], "+", 
    RowBox[{"sp", " ", 
     SuperscriptBox["Z", "2"], 
     FractionBox[
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False]}], "+", "p"}], ")"}], " ", "W"}]], 
      RowBox[{"2", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["p", "2"], " ", "V"}], "-", "W"}], ")"}], "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "p", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p", "2"], "+", 
          RowBox[{
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "p"}], "+", "Z"}], ")"}]}]}], ")"}]}], 
       "+", " ", 
       FractionBox["U2", 
        SqrtBox["U1"]]}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r4solep", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], " ", 
       RowBox[{"(", 
        RowBox[{
         InterpretationBox[
          StyleBox["b",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`b,
          Editable->False], "-", "p"}], ")"}], " ", "p"}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          InterpretationBox[
           StyleBox["b",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`b,
           Editable->False], "-", "p"}], ")"}], "2"], "+", 
       SqrtBox["U1"]}]]}], "+", 
    RowBox[{"sp", " ", 
     FractionBox[
      RowBox[{
       InterpretationBox[
        StyleBox["b",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`b,
        Editable->False], " ", "Z", " ", 
       SqrtBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False]}], "+", "p"}], ")"}]]}], 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             InterpretationBox[
              StyleBox["b",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`b,
              Editable->False], "-", "p"}], ")"}], "2"], "+", 
          SqrtBox["U1"]}], ")"}], "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["p", "2"], " ", "V"}], "-", "W"}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             InterpretationBox[
              StyleBox["b",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`b,
              Editable->False], "-", "p"}], ")"}], "2"], "+", 
          SqrtBox["U1"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "p"}], ")"}], " ", "p"}], "+", 
          RowBox[{
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False], " ", "Z"}]}], ")"}], " ", 
        SqrtBox["U3"]}], "-", 
       RowBox[{
        SqrtBox["W"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False]}], "+", "p"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "p", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p", "2"], "+", 
             RowBox[{
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "p"}], "+", "Z"}], ")"}]}]}], 
            ")"}]}], "+", 
          FractionBox["U2", 
           SqrtBox["U1"]]}], ")"}]}]}], ")"}]}]}]}], ";"}]}], "Code",
 CellChangeTimes->{
  3.9413427370897236`*^9},ExpressionUUID->"8075f737-c729-2140-a52c-\
018e5643b1ab"],

Cell[CellGroupData[{

Cell["Integral solutions of motion", "Subsection",
 CellChangeTimes->{
  3.941342764100773*^9, {3.941343444731556*^9, 
   3.9413434543453255`*^9}},ExpressionUUID->"feb3887f-fdf8-c241-9a23-\
184e6bedd572"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]r0", "[", "\[Chi]_", "]"}], ":=", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["EllipticF",
        ShowAutoStyles->False,
        AutoSpacing->False],
       EllipticF,
       Editable->False], "[", 
      RowBox[{"\[Chi]", ",", 
       SuperscriptBox["k0", "2"]}], "]"}]}], 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["\[ScriptCapitalE]", "2"]}]], 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "-", "r3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"r2", "-", "r4"}], ")"}]}]]}]]}], ";"}]], "Code",
 CellChangeTimes->{
  3.9413427703543262`*^9},ExpressionUUID->"0d4f3667-dbe5-8740-9e67-\
9760827ca16b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Tr0", "[", "\[Chi]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["\[ScriptCapitalE]", "2"]}]], 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r1", "-", "r3"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"r2", "-", "r4"}], ")"}], " "}]], " "}]], 
     RowBox[{"(", "\n", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r1", "-", "r2"}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r1", "-", "r3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"r2", "-", "r4"}], ")"}]}]], " ", "\[ScriptCapitalE]", 
         " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Sin",
            ShowAutoStyles->False,
            AutoSpacing->False],
           Sin,
           Editable->False], "[", 
          RowBox[{"2", " ", "\[Chi]"}], "]"}], "  ", 
         SqrtBox[
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"r1", "-", "r3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"r2", "-", "r4"}], ")"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r1", "-", "r2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"r3", "-", "r4"}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{
                InterpretationBox[
                 StyleBox["Sin",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 Sin,
                 Editable->False], "[", "\[Chi]", "]"}], "2"]}]}], ")"}]}]]}], 
        RowBox[{
         RowBox[{"2", " ", "r3"}], "-", 
         RowBox[{"(", 
          RowBox[{"r1", "+", "r2"}], ")"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1", "-", "r2"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Chi]"}], "]"}]}]}]], "\n", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "-", "r3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"r2", "-", "r4"}], ")"}], " ", "\[ScriptCapitalE]", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticE",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticE,
          Editable->False], "[", 
         RowBox[{"\[Chi]", ",", 
          SuperscriptBox["k0", "2"]}], "]"}]}], "\n", "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r3", "-", "rn"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"r3", "-", "rp"}], ")"}]}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", "rnIntCharge", ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"r3", "-", "rp"}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"r3", "-", "rn"}], ")"}], " ", "rpIntCharge"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", "-", 
             RowBox[{"2", " ", "b"}], "+", 
             RowBox[{"r1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "r2"}], "+", "r3"}], ")"}]}], "+", 
             RowBox[{"r3", " ", 
              RowBox[{"(", 
               RowBox[{"4", "+", "r2", "+", "r3"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"r3", "-", "rn"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"r3", "-", "rp"}], ")"}], "\[ScriptCapitalE]"}]}], ")"}], 
        " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticF",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticF,
          Editable->False], "[", 
         RowBox[{"\[Chi]", ",", 
          SuperscriptBox["k0", "2"]}], "]"}]}], "\n", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r2", "-", "r3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "+", "r1", "+", "r2", "+", "r3", "+", "r4"}], ")"}], 
          " ", "\[ScriptCapitalE]"}], ")"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticPi",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticPi,
          Editable->False], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"r1", "-", "r2"}], 
           RowBox[{"r1", "-", "r3"}]], ",", "\[Chi]", ",", 
          SuperscriptBox["k0", "2"]}], "]"}]}], "\n", "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"r2", "-", "r3"}], ")"}], " ", "rnIntCharge", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["EllipticPi",
            ShowAutoStyles->False,
            AutoSpacing->False],
           EllipticPi,
           Editable->False], "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r3", "-", "rn"}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2", "-", "rn"}], ")"}]}]], ",", "\[Chi]", ",", 
           SuperscriptBox["k0", "2"]}], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "rn"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"r3", "-", "rn"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"r2", "-", "r3"}], ")"}], " ", "rpIntCharge", " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["EllipticPi",
            ShowAutoStyles->False,
            AutoSpacing->False],
           EllipticPi,
           Editable->False], "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r3", "-", "rp"}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2", "-", "rp"}], ")"}]}]], ",", "\[Chi]", ",", 
           SuperscriptBox["k0", "2"]}], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "rp"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r3"}], "+", "rp"}], ")"}]}]]}], "\n", ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rpIntCharge", "->", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"rp", "-", "rn"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"+", "8"}], " ", "\[ScriptCapitalE]"}], "-", 
             RowBox[{"4", " ", "b", " ", "\[ScriptCapitalE]"}], "+", 
             RowBox[{"sp", " ", "\[ScriptCapitalJ]"}]}], " ", ")"}], " ", 
           "rp"}], "+", " ", 
          RowBox[{"b", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "4"}], "+", "b"}], ")"}], "\[ScriptCapitalE]"}], 
             "-", 
             RowBox[{"sp", " ", 
              InterpretationBox[
               StyleBox["\[ScriptCapitalJ]",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`\[ScriptCapitalJ],
               Editable->False]}]}], ")"}]}]}], ")"}]}]}], ",", 
      RowBox[{"rnIntCharge", "->", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"rp", "-", "rn"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "  ", 
            RowBox[{
             RowBox[{"8", " ", "\[ScriptCapitalE]"}], "-", 
             RowBox[{"4", " ", "b", " ", "\[ScriptCapitalE]"}], "+", 
             RowBox[{"sp", " ", 
              InterpretationBox[
               StyleBox["\[ScriptCapitalJ]",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`\[ScriptCapitalJ],
               Editable->False]}]}], ")"}], " ", "rn"}], "+", " ", 
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "4"}], "+", "b"}], ")"}], "\[ScriptCapitalE]"}], 
             "-", 
             RowBox[{"sp", " ", 
              InterpretationBox[
               StyleBox["\[ScriptCapitalJ]",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`\[ScriptCapitalJ],
               Editable->False]}]}], ")"}]}]}], ")"}]}]}]}], "}"}]}]}], 
  ";"}]], "Code",
 CellChangeTimes->{
  3.9413427924768734`*^9},ExpressionUUID->"169f114c-1e45-e14d-8a94-\
359ad31f8612"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]r0", "[", "\[Chi]_", "]"}], ":=", 
   FractionBox[
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"sp", " ", 
        InterpretationBox[
         StyleBox["\[ScriptCapitalE]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[ScriptCapitalE],
         Editable->False]}], "+", 
       InterpretationBox[
        StyleBox["\[ScriptCapitalJ]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[ScriptCapitalJ],
        Editable->False]}], ")"}], " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["EllipticF",
        ShowAutoStyles->False,
        AutoSpacing->False],
       EllipticF,
       Editable->False], "[", 
      RowBox[{"\[Chi]", ",", 
       SuperscriptBox["k0", "2"]}], "]"}]}], 
    RowBox[{
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        InterpretationBox[
         StyleBox["\[ScriptCapitalE]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[ScriptCapitalE],
         Editable->False], "2"]}]], 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "-", "r3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"r2", "-", "r4"}], ")"}]}]]}]]}], ";"}]], "Code",
 CellChangeTimes->{{3.941342800861866*^9, 
  3.941342804529455*^9}},ExpressionUUID->"3746946f-cf7b-854d-8bdb-\
a578d55f2401"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPsi]r0", "[", "\[Chi]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2", "  ", 
       InterpretationBox[
        StyleBox["\[ScriptCapitalE]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[ScriptCapitalE],
        Editable->False], " ", 
       InterpretationBox[
        StyleBox["\[ScriptCapitalJ]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[ScriptCapitalJ],
        Editable->False]}], 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           InterpretationBox[
            StyleBox["\[ScriptCapitalE]",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`\[ScriptCapitalE],
            Editable->False], "2"]}]], 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1", "-", "r3"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"r2", "-", "r4"}], ")"}]}]], "  ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r2", "2"], "+", 
          SuperscriptBox[
           InterpretationBox[
            StyleBox["\[ScriptCapitalJ]",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`\[ScriptCapitalJ],
            Editable->False], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r3", "2"], "+", 
          SuperscriptBox[
           InterpretationBox[
            StyleBox["\[ScriptCapitalJ]",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`\[ScriptCapitalJ],
            Editable->False], "2"]}], ")"}]}], ")"}]], 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r2", "-", "r3"}], ")"}], " ", 
        InterpretationBox[
         StyleBox["\[ScriptCapitalJ]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[ScriptCapitalJ],
         Editable->False], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r2", " ", "r3"}], "-", 
          SuperscriptBox[
           InterpretationBox[
            StyleBox["\[ScriptCapitalJ]",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`\[ScriptCapitalJ],
            Editable->False], "2"]}], ")"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Im",
           ShowAutoStyles->False,
           AutoSpacing->False],
          Im,
          Editable->False], "[", 
         RowBox[{
          InterpretationBox[
           StyleBox["EllipticPi",
            ShowAutoStyles->False,
            AutoSpacing->False],
           EllipticPi,
           Editable->False], "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r3", "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 StyleBox["\[ScriptCapitalJ]",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`\[ScriptCapitalJ],
                 Editable->False]}]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2", "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 StyleBox["\[ScriptCapitalJ]",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`\[ScriptCapitalJ],
                 Editable->False]}]}], ")"}]}]], ",", "\[Chi]", ",", 
           SuperscriptBox["k0", "2"]}], "]"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["r3", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r2", "2"], "+", 
          SuperscriptBox[
           InterpretationBox[
            StyleBox["\[ScriptCapitalJ]",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`\[ScriptCapitalJ],
            Editable->False], "2"]}], ")"}], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticF",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticF,
          Editable->False], "[", 
         RowBox[{"\[Chi]", ",", 
          SuperscriptBox["k0", "2"]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r2", "-", "r3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"r2", "+", "r3"}], ")"}], " ", 
        SuperscriptBox[
         InterpretationBox[
          StyleBox["\[ScriptCapitalJ]",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`\[ScriptCapitalJ],
          Editable->False], "2"], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["Re",
           ShowAutoStyles->False,
           AutoSpacing->False],
          Re,
          Editable->False], "[", 
         RowBox[{
          InterpretationBox[
           StyleBox["EllipticPi",
            ShowAutoStyles->False,
            AutoSpacing->False],
           EllipticPi,
           Editable->False], "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r3", "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 StyleBox["\[ScriptCapitalJ]",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`\[ScriptCapitalJ],
                 Editable->False]}]}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2", "-", 
               RowBox[{"\[ImaginaryI]", " ", 
                InterpretationBox[
                 StyleBox["\[ScriptCapitalJ]",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`\[ScriptCapitalJ],
                 Editable->False]}]}], ")"}]}]], ",", "\[Chi]", ",", 
           SuperscriptBox["k0", "2"]}], "]"}], "]"}]}]}], ")"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"yr", "->", 
      RowBox[{"Sin", "[", "\[Chi]", "]"}]}], "}"}]}]}], ";"}]], "Code",
 CellChangeTimes->{
  3.9413428117278595`*^9},ExpressionUUID->"7c679143-6f5d-af45-b187-\
c473afc31263"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Frequency", "Subsection",
 CellChangeTimes->{
  3.9413428330685368`*^9},ExpressionUUID->"60a29373-9a3b-a545-b9af-\
0f9c8bad51d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]r", "=", 
   FractionBox[
    RowBox[{"\[Pi]", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "-", "r3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"r2", "-", "r4"}], ")"}]}]], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox[
        InterpretationBox[
         StyleBox["\[ScriptCapitalE]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[ScriptCapitalE],
         Editable->False], "2"]}]]}], 
    RowBox[{"2", " ", 
     RowBox[{
      InterpretationBox[
       StyleBox["EllipticK",
        ShowAutoStyles->False,
        AutoSpacing->False],
       EllipticK,
       Editable->False], "[", 
      SuperscriptBox["k0", "2"], "]"}]}]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]t", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", "-", 
          RowBox[{"2", " ", 
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False]}], "+", 
          RowBox[{"r1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "r2"}], "+", "r3"}], ")"}]}], "+", 
          RowBox[{"r3", " ", 
           RowBox[{"(", 
            RowBox[{"4", "+", "r2", "+", "r3"}], ")"}]}]}], ")"}], " ", 
        InterpretationBox[
         StyleBox["\[ScriptCapitalE]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[ScriptCapitalE],
         Editable->False]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False]}], ")"}], " ", 
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalE]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalE],
             Editable->False]}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False]}], ")"}], " ", "rp", " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalE]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalE],
             Editable->False]}], "-", 
           RowBox[{
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["sp",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`sp,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalJ]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalJ],
             Editable->False]}], "+", 
           RowBox[{"rp", " ", 
            InterpretationBox[
             StyleBox["sp",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`sp,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalJ]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalJ],
             Editable->False]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r3", "-", "rp"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "rn"}], "+", "rp"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox[
           InterpretationBox[
            StyleBox["b",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`b,
            Editable->False], "2"], " ", 
          InterpretationBox[
           StyleBox["\[ScriptCapitalE]",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`\[ScriptCapitalE],
           Editable->False]}], "+", 
         RowBox[{"2", " ", "rn", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"8", " ", 
             InterpretationBox[
              StyleBox["\[ScriptCapitalE]",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`\[ScriptCapitalE],
              Editable->False]}], "+", 
            RowBox[{
             InterpretationBox[
              StyleBox["sp",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`sp,
              Editable->False], " ", 
             InterpretationBox[
              StyleBox["\[ScriptCapitalJ]",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`\[ScriptCapitalJ],
              Editable->False]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", 
          InterpretationBox[
           StyleBox["b",
            ShowAutoStyles->False,
            AutoSpacing->False],
           $CellContext`b,
           Editable->False], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "rn"}], ")"}], " ", 
             InterpretationBox[
              StyleBox["\[ScriptCapitalE]",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`\[ScriptCapitalE],
              Editable->False]}], "+", 
            RowBox[{
             InterpretationBox[
              StyleBox["sp",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`sp,
              Editable->False], " ", 
             InterpretationBox[
              StyleBox["\[ScriptCapitalJ]",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`\[ScriptCapitalJ],
              Editable->False]}]}], ")"}]}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r3", "-", "rn"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"rn", "-", "rp"}], ")"}]}]]}], ")"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r1", "-", "r3"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r2", "-", "r4"}], ")"}], " ", 
      InterpretationBox[
       StyleBox["\[ScriptCapitalE]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[ScriptCapitalE],
       Editable->False], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["EllipticE",
         ShowAutoStyles->False,
         AutoSpacing->False],
        EllipticE,
        Editable->False], "[", 
       SuperscriptBox["k0", "2"], "]"}]}], 
     RowBox[{"2", " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["EllipticK",
         ShowAutoStyles->False,
         AutoSpacing->False],
        EllipticK,
        Editable->False], "[", 
       SuperscriptBox["k0", "2"], "]"}]}]], "+", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", " ", 
       RowBox[{
        InterpretationBox[
         StyleBox["EllipticK",
          ShowAutoStyles->False,
          AutoSpacing->False],
         EllipticK,
         Editable->False], "[", 
        SuperscriptBox["k0", "2"], "]"}]}]], 
     RowBox[{"(", 
      RowBox[{"r2", "-", "r3"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "+", "r1", "+", "r2", "+", "r3", "+", "r4"}], ")"}], 
        " ", 
        InterpretationBox[
         StyleBox["\[ScriptCapitalE]",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`\[ScriptCapitalE],
         Editable->False], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticPi",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticPi,
          Editable->False], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"r1", "-", "r2"}], 
           RowBox[{"r1", "-", "r3"}]], ",", 
          SuperscriptBox["k0", "2"]}], "]"}]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False]}], ")"}], " ", 
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalE]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalE],
             Editable->False]}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False]}], ")"}], " ", "rn", " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalE]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalE],
             Editable->False]}], "-", 
           RowBox[{
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["sp",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`sp,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalJ]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalJ],
             Editable->False]}], "+", 
           RowBox[{"rn", " ", 
            InterpretationBox[
             StyleBox["sp",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`sp,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalJ]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalJ],
             Editable->False]}]}], ")"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["EllipticPi",
            ShowAutoStyles->False,
            AutoSpacing->False],
           EllipticPi,
           Editable->False], "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r3", "-", "rn"}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2", "-", "rn"}], ")"}]}]], ",", 
           SuperscriptBox["k0", "2"]}], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "rn"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r3"}], "+", "rn"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"rn", "-", "rp"}], ")"}]}]], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False]}], ")"}], " ", 
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalE]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalE],
             Editable->False]}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              InterpretationBox[
               StyleBox["b",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`b,
               Editable->False]}], ")"}], " ", "rp", " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalE]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalE],
             Editable->False]}], "-", 
           RowBox[{
            InterpretationBox[
             StyleBox["b",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`b,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["sp",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`sp,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalJ]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalJ],
             Editable->False]}], "+", 
           RowBox[{"rp", " ", 
            InterpretationBox[
             StyleBox["sp",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`sp,
             Editable->False], " ", 
            InterpretationBox[
             StyleBox["\[ScriptCapitalJ]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalJ],
             Editable->False]}]}], ")"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["EllipticPi",
            ShowAutoStyles->False,
            AutoSpacing->False],
           EllipticPi,
           Editable->False], "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r2"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r3", "-", "rp"}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "-", "r3"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2", "-", "rp"}], ")"}]}]], ",", 
           SuperscriptBox["k0", "2"]}], "]"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "-", "rp"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "r3"}], "+", "rp"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "rn"}], "+", "rp"}], ")"}]}]]}], ")"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]\[CurlyPhi]", "=", 
   RowBox[{
    RowBox[{
     InterpretationBox[
      StyleBox["sp",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`sp,
      Editable->False], " ", 
     InterpretationBox[
      StyleBox["\[ScriptCapitalE]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[ScriptCapitalE],
      Editable->False]}], "+", 
    InterpretationBox[
     StyleBox["\[ScriptCapitalJ]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[ScriptCapitalJ],
     Editable->False]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]\[Psi]", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["r3", "2"], " ", 
      InterpretationBox[
       StyleBox["\[ScriptCapitalE]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[ScriptCapitalE],
       Editable->False], " ", 
      InterpretationBox[
       StyleBox["\[ScriptCapitalJ]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[ScriptCapitalJ],
       Editable->False]}], 
     RowBox[{
      SuperscriptBox["r3", "2"], "+", 
      SuperscriptBox[
       InterpretationBox[
        StyleBox["\[ScriptCapitalJ]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[ScriptCapitalJ],
        Editable->False], "2"]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r2", "-", "r3"}], ")"}], " ", 
      InterpretationBox[
       StyleBox["\[ScriptCapitalE]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[ScriptCapitalE],
       Editable->False], " ", 
      SuperscriptBox[
       InterpretationBox[
        StyleBox["\[ScriptCapitalJ]",
         ShowAutoStyles->False,
         AutoSpacing->False],
        $CellContext`\[ScriptCapitalJ],
        Editable->False], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r2", " ", "r3"}], "-", 
           SuperscriptBox[
            InterpretationBox[
             StyleBox["\[ScriptCapitalJ]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalJ],
             Editable->False], "2"]}], ")"}], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Im",
            ShowAutoStyles->False,
            AutoSpacing->False],
           Im,
           Editable->False], "[", 
          RowBox[{
           InterpretationBox[
            StyleBox["EllipticPi",
             ShowAutoStyles->False,
             AutoSpacing->False],
            EllipticPi,
            Editable->False], "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r1", "-", "r2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"r3", "-", 
                RowBox[{"\[ImaginaryI]", " ", 
                 InterpretationBox[
                  StyleBox["\[ScriptCapitalJ]",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`\[ScriptCapitalJ],
                  Editable->False]}]}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r1", "-", "r3"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"r2", "-", 
                RowBox[{"\[ImaginaryI]", " ", 
                 InterpretationBox[
                  StyleBox["\[ScriptCapitalJ]",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`\[ScriptCapitalJ],
                  Editable->False]}]}], ")"}]}]], ",", 
            SuperscriptBox["k0", "2"]}], "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2", "+", "r3"}], ")"}], " ", 
         InterpretationBox[
          StyleBox["\[ScriptCapitalJ]",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`\[ScriptCapitalJ],
          Editable->False], " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["Re",
            ShowAutoStyles->False,
            AutoSpacing->False],
           Re,
           Editable->False], "[", 
          RowBox[{
           InterpretationBox[
            StyleBox["EllipticPi",
             ShowAutoStyles->False,
             AutoSpacing->False],
            EllipticPi,
            Editable->False], "[", 
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r1", "-", "r2"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"r3", "-", 
                RowBox[{"\[ImaginaryI]", " ", 
                 InterpretationBox[
                  StyleBox["\[ScriptCapitalJ]",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`\[ScriptCapitalJ],
                  Editable->False]}]}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r1", "-", "r3"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"r2", "-", 
                RowBox[{"\[ImaginaryI]", " ", 
                 InterpretationBox[
                  StyleBox["\[ScriptCapitalJ]",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`\[ScriptCapitalJ],
                  Editable->False]}]}], ")"}]}]], ",", 
            SuperscriptBox["k0", "2"]}], "]"}], "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r2", "2"], "+", 
        SuperscriptBox[
         InterpretationBox[
          StyleBox["\[ScriptCapitalJ]",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`\[ScriptCapitalJ],
          Editable->False], "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r3", "2"], "+", 
        SuperscriptBox[
         InterpretationBox[
          StyleBox["\[ScriptCapitalJ]",
           ShowAutoStyles->False,
           AutoSpacing->False],
          $CellContext`\[ScriptCapitalJ],
          Editable->False], "2"]}], ")"}], " ", 
      RowBox[{
       InterpretationBox[
        StyleBox["EllipticK",
         ShowAutoStyles->False,
         AutoSpacing->False],
        EllipticK,
        Editable->False], "[", 
       SuperscriptBox["k0", "2"], "]"}]}]]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.941343351830147*^9, 
  3.941343382263105*^9}},ExpressionUUID->"8967fe0c-2481-834e-97d8-\
9f896051554b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linear shift", "Subsection",
 CellChangeTimes->{
  3.9413436909816895`*^9},ExpressionUUID->"91f71344-898b-8746-bef7-\
55e9cbb0b5b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]rb", "=", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"Expression", 
       StyleBox[
       "\"\[CurlyCapitalUpsilon]rb\"", "IconizedCustomName", StripOnInput -> 
        False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["Times", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["936", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    Rational[1, 2] 
    Pi (($CellContext`r1b - $CellContext`r3b) ($CellContext`r2b - \
$CellContext`r4b))^
     Rational[1, 2] ((1 - $CellContext`\[ScriptCapitalE]2b)^Rational[1, 2]/
     EllipticK[$CellContext`kb02]),
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]rsp", "=", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"Expression", 
       StyleBox[
       "\"\[CurlyCapitalUpsilon]rsp\"", "IconizedCustomName", StripOnInput -> 
        False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["Plus", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["4056", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    Rational[1, 4] 
     Pi (($CellContext`r1b - $CellContext`r3b) ($CellContext`r2b - \
$CellContext`r4b))^
      Rational[-1, 
        2] ((-$CellContext`r3sb) ($CellContext`r2b - $CellContext`r4b) - \
($CellContext`r1b - $CellContext`r3b) $CellContext`r4sb) ((
        1 - $CellContext`\[ScriptCapitalE]2b)^Rational[1, 2]/
      EllipticK[$CellContext`kb02]) + 
    Rational[-1, 4] 
     Pi (($CellContext`r1b - $CellContext`r3b) ($CellContext`r2b - \
$CellContext`r4b))^Rational[1, 2] (1 - $CellContext`\[ScriptCapitalE]2b)^
      Rational[-1, 2] ($CellContext`\[ScriptCapitalE]2sb/
      EllipticK[$CellContext`kb02]) + 
    Rational[-1, 4] (
       1 - $CellContext`kb02)^(-1) $CellContext`kb02^(-1) $CellContext`ks02 
     Pi (($CellContext`r1b - $CellContext`r3b) ($CellContext`r2b - \
$CellContext`r4b))^Rational[1, 2] (1 - $CellContext`\[ScriptCapitalE]2b)^
      Rational[1, 2] 
     EllipticK[$CellContext`kb02]^(-2) (
      EllipticE[$CellContext`kb02] - (1 - $CellContext`kb02) 
      EllipticK[$CellContext`kb02]),
    SelectWithContents->True,
    Selectable->False]}], ";"}]}], "Code",
 CellChangeTimes->{
  3.9413438043111897`*^9},ExpressionUUID->"ec5b5205-2c2c-7540-b26d-\
ac77757294d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalUpsilon]tb", "=", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"Expression", 
       StyleBox[
       "\"\[CurlyCapitalUpsilon]tb\"", "IconizedCustomName", StripOnInput -> 
        False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["Times", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["5760", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    Rational[1, 2] $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] (8 - 
     2 $CellContext`b + $CellContext`r1b (-$CellContext`r2b + \
$CellContext`r3b) + $CellContext`r3b (
       4 + $CellContext`r2b + $CellContext`r3b) + 
     4 ($CellContext`r3b - $CellContext`rnb)^(-1) (($CellContext`b^2 + 
        4 $CellContext`rnb - 
        2 $CellContext`b (
         2 + $CellContext`rnb))/($CellContext`rnb - $CellContext`rpb)) + 
     2 ($CellContext`r3b - $CellContext`rpb)^(-1) (-$CellContext`rnb + \
$CellContext`rpb)^(-1) ($CellContext`b^2 + 8 $CellContext`rpb - 
       4 $CellContext`b (
        1 + $CellContext`rpb)) + ($CellContext`r1b - $CellContext`r3b) \
($CellContext`r2b - $CellContext`r4b) (EllipticE[$CellContext`kb02]/
       EllipticK[$CellContext`kb02]) + ($CellContext`r2b - $CellContext`r3b) 
      EllipticK[$CellContext`kb02]^(-1) ((
         4 + $CellContext`r1b + $CellContext`r2b + $CellContext`r3b + \
$CellContext`r4b) EllipticPi[$CellContext`hbr, $CellContext`kb02] + 
       4 ($CellContext`r2b - $CellContext`rnb)^(-1) (-$CellContext`r3b + \
$CellContext`rnb)^(-1) ($CellContext`b^2 + 4 $CellContext`rnb - 
         2 $CellContext`b (
          2 + $CellContext`rnb)) ($CellContext`rnb - $CellContext`rpb)^(-1) 
        EllipticPi[$CellContext`hbrn, $CellContext`kb02] + 
       2 ($CellContext`r2b - $CellContext`rpb)^(-1) (-$CellContext`r3b + \
$CellContext`rpb)^(-1) (-$CellContext`rnb + $CellContext`rpb)^(-1) \
($CellContext`b^2 + 8 $CellContext`rpb - 
         4 $CellContext`b (1 + $CellContext`rpb)) 
        EllipticPi[$CellContext`hbrp, $CellContext`kb02])),
    SelectWithContents->True,
    Selectable->False]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CapitalUpsilon]tsp", "=", 
   InterpretationBox[
    DynamicModuleBox[{Typeset`open = False}, 
     TemplateBox[{"Expression", 
       StyleBox[
       "\"\[CurlyCapitalUpsilon]tsp\"", "IconizedCustomName", StripOnInput -> 
        False], 
       GridBox[{{
          RowBox[{
            TagBox["\"Head: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["Plus", "IconizedItem"]}]}, {
          RowBox[{
            TagBox["\"Byte count: \"", "IconizedLabel"], "\[InvisibleSpace]", 
            TagBox["35144", "IconizedItem"]}]}}, 
        GridBoxAlignment -> {"Columns" -> {{Left}}}, DefaultBaseStyle -> 
        "Column", 
        GridBoxItemSize -> {
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
       Dynamic[Typeset`open]},
      "IconizedObject"]],
    Rational[
      1, 2] ((-$CellContext`r3sb) ($CellContext`r3b - $CellContext`rnb)^(-2) \
($CellContext`rnb - $CellContext`rpb)^(-1) (
        4 $CellContext`b^2 $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] + 
        16 $CellContext`rnb $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] - 
        8 $CellContext`b (
         2 + $CellContext`rnb) $CellContext`\[ScriptCapitalE]2b^
         Rational[1, 2]) - 
      2 $CellContext`r3sb ($CellContext`r3b - $CellContext`rpb)^(-2) \
(-$CellContext`rnb + $CellContext`rpb)^(-1) ((-4 + $CellContext`b) \
$CellContext`b $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] - 
       4 (-2 + $CellContext`b) $CellContext`rpb \
$CellContext`\[ScriptCapitalE]2b^
        Rational[
         1, 2]) + ($CellContext`r1b $CellContext`r3sb + $CellContext`r3b \
$CellContext`r3sb + (
          4 + $CellContext`r2b + $CellContext`r3b) $CellContext`r3sb) \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] + 
      Rational[1, 2] (8 - 
        2 $CellContext`b + $CellContext`r1b (-$CellContext`r2b + \
$CellContext`r3b) + $CellContext`r3b (
          4 + $CellContext`r2b + $CellContext`r3b)) $CellContext`\
\[ScriptCapitalE]2b^
        Rational[-1, 
          2] $CellContext`\[ScriptCapitalE]2sb + ($CellContext`r3b - \
$CellContext`rnb)^(-1) ($CellContext`rnb - $CellContext`rpb)^(-1) (
        2 $CellContext`b^2 $CellContext`\[ScriptCapitalE]2b^
          Rational[-1, 2] $CellContext`\[ScriptCapitalE]2sb + 
        2 $CellContext`rnb (
          4 $CellContext`\[ScriptCapitalE]2b^
            Rational[-1, 
              2] $CellContext`\[ScriptCapitalE]2sb + $CellContext`\
\[ScriptCapitalJ]2b^Rational[1, 2]) - 
        2 $CellContext`b (
         2 (2 + $CellContext`rnb) $CellContext`\[ScriptCapitalE]2b^
           Rational[-1, 
             2] $CellContext`\[ScriptCapitalE]2sb + $CellContext`\
\[ScriptCapitalJ]2b^Rational[1, 2])) + 
      2 ($CellContext`r3b - $CellContext`rpb)^(-1) (-$CellContext`rnb + \
$CellContext`rpb)^(-1) (
        Rational[
          1, 2] (-4 + $CellContext`b) $CellContext`b $CellContext`\
\[ScriptCapitalE]2b^Rational[-1, 2] $CellContext`\[ScriptCapitalE]2sb - 
        2 (-2 + $CellContext`b) $CellContext`rpb $CellContext`\
\[ScriptCapitalE]2b^
         Rational[-1, 
           2] $CellContext`\[ScriptCapitalE]2sb - $CellContext`b \
$CellContext`\[ScriptCapitalJ]2b^
         Rational[1, 2] + $CellContext`rpb $CellContext`\[ScriptCapitalJ]2b^
          Rational[1, 2])) + 
    Rational[-1, 
       2] $CellContext`r3sb ($CellContext`r2b - $CellContext`r4b) \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] (EllipticE[$CellContext`kb02]/
      EllipticK[$CellContext`kb02]) + 
    Rational[-1, 
       2] ($CellContext`r1b - $CellContext`r3b) $CellContext`r4sb \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] (EllipticE[$CellContext`kb02]/
      EllipticK[$CellContext`kb02]) + 
    Rational[1, 
       4] ($CellContext`r1b - $CellContext`r3b) ($CellContext`r2b - \
$CellContext`r4b) $CellContext`\[ScriptCapitalE]2b^
      Rational[-1, 2] $CellContext`\[ScriptCapitalE]2sb (
      EllipticE[$CellContext`kb02]/EllipticK[$CellContext`kb02]) + 
    Rational[1, 
       4] $CellContext`kb02^(-1) $CellContext`ks02 ($CellContext`r1b - \
$CellContext`r3b) ($CellContext`r2b - $CellContext`r4b) $CellContext`\
\[ScriptCapitalE]2b^
      Rational[1, 2] ((EllipticE[$CellContext`kb02] - 
       EllipticK[$CellContext`kb02])/EllipticK[$CellContext`kb02]) + 
    Rational[-1, 4] (
       1 - $CellContext`kb02)^(-1) $CellContext`kb02^(-1) $CellContext`ks02 \
($CellContext`r1b - $CellContext`r3b) ($CellContext`r2b - $CellContext`r4b) \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] EllipticE[$CellContext`kb02] 
     EllipticK[$CellContext`kb02]^(-2) (
      EllipticE[$CellContext`kb02] - (1 - $CellContext`kb02) 
      EllipticK[$CellContext`kb02]) + 
    Rational[-1, 2] $CellContext`r3sb 
     EllipticK[$CellContext`kb02]^(-1) ((
        4 + $CellContext`r1b + $CellContext`r2b + $CellContext`r3b + \
$CellContext`r4b) $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] 
       EllipticPi[$CellContext`hbr, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rnb)^(-1) (-$CellContext`r3b + \
$CellContext`rnb)^(-1) ($CellContext`rnb - $CellContext`rpb)^(-1) (
        2 (-4 + $CellContext`b) $CellContext`b \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rnb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) 
       EllipticPi[$CellContext`hbrn, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rpb)^(-1) (-$CellContext`r3b + \
$CellContext`rpb)^(-1) (-$CellContext`rnb + $CellContext`rpb)^(-1) ((-4 + \
$CellContext`b) $CellContext`b $CellContext`\[ScriptCapitalE]2b^
          Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rpb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) 
       EllipticPi[$CellContext`hbrp, $CellContext`kb02]) + 
    Rational[-1, 4] (
       1 - $CellContext`kb02)^(-1) $CellContext`kb02^(-1) $CellContext`ks02 \
($CellContext`r2b - $CellContext`r3b) 
     EllipticK[$CellContext`kb02]^(-2) (
      EllipticE[$CellContext`kb02] - (1 - $CellContext`kb02) 
      EllipticK[$CellContext`kb02]) ((
        4 + $CellContext`r1b + $CellContext`r2b + $CellContext`r3b + \
$CellContext`r4b) $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] 
       EllipticPi[$CellContext`hbr, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rnb)^(-1) (-$CellContext`r3b + \
$CellContext`rnb)^(-1) ($CellContext`rnb - $CellContext`rpb)^(-1) (
        2 (-4 + $CellContext`b) $CellContext`b \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rnb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) 
       EllipticPi[$CellContext`hbrn, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rpb)^(-1) (-$CellContext`r3b + \
$CellContext`rpb)^(-1) (-$CellContext`rnb + $CellContext`rpb)^(-1) ((-4 + \
$CellContext`b) $CellContext`b $CellContext`\[ScriptCapitalE]2b^
          Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rpb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) 
       EllipticPi[$CellContext`hbrp, $CellContext`kb02]) + 
    Rational[1, 2] ($CellContext`r2b - $CellContext`r3b) 
     EllipticK[$CellContext`kb02]^(-1) (($CellContext`r3sb + \
$CellContext`r4sb) $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] 
       EllipticPi[$CellContext`hbr, $CellContext`kb02] + 
      Rational[1, 2] (
        4 + $CellContext`r1b + $CellContext`r2b + $CellContext`r3b + \
$CellContext`r4b) $CellContext`\[ScriptCapitalE]2b^
        Rational[-1, 2] $CellContext`\[ScriptCapitalE]2sb 
       EllipticPi[$CellContext`hbr, $CellContext`kb02] + (
        4 + $CellContext`r1b + $CellContext`r2b + $CellContext`r3b + \
$CellContext`r4b) $CellContext`\[ScriptCapitalE]2b^Rational[1, 2] (
        Rational[
          1, 2] ($CellContext`hbr - $CellContext`kb02)^(-1) $CellContext`ks02 \
((-1 + $CellContext`kb02)^(-1) EllipticE[$CellContext`kb02] + 
          EllipticPi[$CellContext`hbr, $CellContext`kb02]) + 
        Rational[
          1, 2] (-1 + $CellContext`hbr)^(-1) $CellContext`hsr \
(-$CellContext`hbr + $CellContext`kb02)^(-1) (
          EllipticE[$CellContext`kb02] + $CellContext`hbr^(-1) \
(-$CellContext`hbr + $CellContext`kb02) 
           EllipticK[$CellContext`kb02] + $CellContext`hbr^(-1) \
($CellContext`hbr^2 - $CellContext`kb02) 
           EllipticPi[$CellContext`hbr, $CellContext`kb02])) + 
      2 $CellContext`r3sb ($CellContext`r2b - $CellContext`rnb)^(-1) \
(-$CellContext`r3b + $CellContext`rnb)^(-2) ($CellContext`rnb - \
$CellContext`rpb)^(-1) (
        2 (-4 + $CellContext`b) $CellContext`b \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rnb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) 
       EllipticPi[$CellContext`hbrn, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rnb)^(-1) (-$CellContext`r3b + \
$CellContext`rnb)^(-1) ($CellContext`rnb - $CellContext`rpb)^(-1) ((-4 + \
$CellContext`b) $CellContext`b $CellContext`\[ScriptCapitalE]2b^
          Rational[-1, 2] $CellContext`\[ScriptCapitalE]2sb - 
        2 (-2 + $CellContext`b) $CellContext`rnb $CellContext`\
\[ScriptCapitalE]2b^
         Rational[-1, 
           2] $CellContext`\[ScriptCapitalE]2sb - $CellContext`b \
$CellContext`\[ScriptCapitalJ]2b^
         Rational[1, 2] + $CellContext`rnb $CellContext`\[ScriptCapitalJ]2b^
          Rational[1, 2]) EllipticPi[$CellContext`hbrn, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rnb)^(-1) (-$CellContext`r3b + \
$CellContext`rnb)^(-1) ($CellContext`rnb - $CellContext`rpb)^(-1) (
        2 (-4 + $CellContext`b) $CellContext`b \
$CellContext`\[ScriptCapitalE]2b^Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rnb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) (
        Rational[
          1, 2] ($CellContext`hbrn - $CellContext`kb02)^(-1) \
$CellContext`ks02 ((-1 + $CellContext`kb02)^(-1) EllipticE[$CellContext`kb02] + 
          EllipticPi[$CellContext`hbrn, $CellContext`kb02]) + 
        Rational[
          1, 2] (-1 + $CellContext`hbrn)^(-1) $CellContext`hsrn \
(-$CellContext`hbrn + $CellContext`kb02)^(-1) (
          EllipticE[$CellContext`kb02] + $CellContext`hbrn^(-1) \
(-$CellContext`hbrn + $CellContext`kb02) 
           EllipticK[$CellContext`kb02] + $CellContext`hbrn^(-1) \
($CellContext`hbrn^2 - $CellContext`kb02) 
           EllipticPi[$CellContext`hbrn, $CellContext`kb02])) + 
      2 $CellContext`r3sb ($CellContext`r2b - $CellContext`rpb)^(-1) \
(-$CellContext`r3b + $CellContext`rpb)^(-2) (-$CellContext`rnb + \
$CellContext`rpb)^(-1) ((-4 + $CellContext`b) $CellContext`b $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rpb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) 
       EllipticPi[$CellContext`hbrp, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rpb)^(-1) (-$CellContext`r3b + \
$CellContext`rpb)^(-1) (-$CellContext`rnb + $CellContext`rpb)^(-1) (
        Rational[
          1, 2] (-4 + $CellContext`b) $CellContext`b $CellContext`\
\[ScriptCapitalE]2b^Rational[-1, 2] $CellContext`\[ScriptCapitalE]2sb - 
        2 (-2 + $CellContext`b) $CellContext`rpb $CellContext`\
\[ScriptCapitalE]2b^
         Rational[-1, 
           2] $CellContext`\[ScriptCapitalE]2sb - $CellContext`b \
$CellContext`\[ScriptCapitalJ]2b^
         Rational[1, 2] + $CellContext`rpb $CellContext`\[ScriptCapitalJ]2b^
          Rational[1, 2]) EllipticPi[$CellContext`hbrp, $CellContext`kb02] + 
      2 ($CellContext`r2b - $CellContext`rpb)^(-1) (-$CellContext`r3b + \
$CellContext`rpb)^(-1) (-$CellContext`rnb + $CellContext`rpb)^(-1) ((-4 + \
$CellContext`b) $CellContext`b $CellContext`\[ScriptCapitalE]2b^
          Rational[1, 2] - 
        4 (-2 + $CellContext`b) $CellContext`rpb $CellContext`\
\[ScriptCapitalE]2b^Rational[1, 2]) (
        Rational[
          1, 2] ($CellContext`hbrp - $CellContext`kb02)^(-1) \
$CellContext`ks02 ((-1 + $CellContext`kb02)^(-1) EllipticE[$CellContext`kb02] + 
          EllipticPi[$CellContext`hbrp, $CellContext`kb02]) + 
        Rational[
          1, 2] (-1 + $CellContext`hbrp)^(-1) $CellContext`hsrp \
(-$CellContext`hbrp + $CellContext`kb02)^(-1) (
          EllipticE[$CellContext`kb02] + $CellContext`hbrp^(-1) \
(-$CellContext`hbrp + $CellContext`kb02) 
           EllipticK[$CellContext`kb02] + $CellContext`hbrp^(-1) \
($CellContext`hbrp^2 - $CellContext`kb02) 
           EllipticPi[$CellContext`hbrp, $CellContext`kb02]))),
    SelectWithContents->True,
    Selectable->False]}], ";"}]}], "Code",
 CellChangeTimes->{
  3.941343813269329*^9},ExpressionUUID->"f450dc1a-806a-7a41-8cd8-\
09e87db0b034"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]\[CurlyPhi]b", "=", 
   SqrtBox["\[ScriptCapitalJ]2b"]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]\[CurlyPhi]sp", "=", 
   RowBox[{
    SqrtBox["\[ScriptCapitalE]2b"], "+", 
    FractionBox["\[ScriptCapitalJ]2sb", 
     RowBox[{"2", " ", 
      SqrtBox["\[ScriptCapitalJ]2b"]}]]}]}], ";"}]}], "Code",
 CellChangeTimes->{
  3.9413438601694126`*^9},ExpressionUUID->"bd05ad1d-f866-6844-8bb8-\
150666ffb450"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CurlyCapitalUpsilon]\[Psi]b", "=", 
   FractionBox[
    RowBox[{
     SqrtBox["\[ScriptCapitalE]2b"], " ", 
     SqrtBox["\[ScriptCapitalJ]2b"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r3b", "2"], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r2b", "-", "r3b"}], ")"}], " ", 
         SqrtBox["\[ScriptCapitalJ]2b"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r2b", " ", "r3b"}], "-", "\[ScriptCapitalJ]2b"}], 
             ")"}], " ", 
            RowBox[{
             InterpretationBox[
              StyleBox["Im",
               ShowAutoStyles->False,
               AutoSpacing->False],
              Im,
              Editable->False], "[", 
             RowBox[{
              InterpretationBox[
               StyleBox["EllipticPi",
                ShowAutoStyles->False,
                AutoSpacing->False],
               EllipticPi,
               Editable->False], "[", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"r1b", "-", "r2b"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"r3b", "-", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"r2b", "-", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}]], ",", 
               "kb02"}], "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r2b", "+", "r3b"}], ")"}], " ", 
            SqrtBox["\[ScriptCapitalJ]2b"], " ", 
            RowBox[{
             InterpretationBox[
              StyleBox["Re",
               ShowAutoStyles->False,
               AutoSpacing->False],
              Re,
              Editable->False], "[", 
             RowBox[{
              InterpretationBox[
               StyleBox["EllipticPi",
                ShowAutoStyles->False,
                AutoSpacing->False],
               EllipticPi,
               Editable->False], "[", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"r1b", "-", "r2b"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"r3b", "-", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"r2b", "-", 
                   RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}]], ",", 
               "kb02"}], "]"}], "]"}]}]}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["r2b", "2"], "+", "\[ScriptCapitalJ]2b"}], ")"}], 
         " ", 
         RowBox[{
          InterpretationBox[
           StyleBox["EllipticK",
            ShowAutoStyles->False,
            AutoSpacing->False],
           EllipticK,
           Editable->False], "[", "kb02", "]"}]}]]}], ")"}]}], 
    RowBox[{
     SuperscriptBox["r3b", "2"], "+", "\[ScriptCapitalJ]2b"}]]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.941343873344635*^9, 
  3.9413438822986584`*^9}},ExpressionUUID->"bc05ba33-80e5-924f-a66a-\
1f29cd8b7514"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Nu]nodal", "=", 
   RowBox[{"2", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["r3b", "2"], "+", "\[ScriptCapitalJ]2b"}], 
       RowBox[{
        SqrtBox["\[ScriptCapitalE]2b"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["r3b", "2"], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r2b", "-", "r3b"}], ")"}], " ", 
            SqrtBox["\[ScriptCapitalJ]2b"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"r2b", " ", "r3b"}], "-", "\[ScriptCapitalJ]2b"}], 
                ")"}], " ", 
               RowBox[{
                InterpretationBox[
                 StyleBox["Im",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 Im,
                 Editable->False], "[", 
                RowBox[{
                 InterpretationBox[
                  StyleBox["EllipticPi",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  EllipticPi,
                  Editable->False], "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r1b", "-", "r2b"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"r3b", "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"r2b", "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}]], ",", 
                  "kb02"}], "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r2b", "+", "r3b"}], ")"}], " ", 
               SqrtBox["\[ScriptCapitalJ]2b"], " ", 
               RowBox[{
                InterpretationBox[
                 StyleBox["Re",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 Re,
                 Editable->False], "[", 
                RowBox[{
                 InterpretationBox[
                  StyleBox["EllipticPi",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  EllipticPi,
                  Editable->False], "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r1b", "-", "r2b"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"r3b", "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"r2b", "-", 
                    RowBox[{"\[ImaginaryI]", " ", 
                    SqrtBox["\[ScriptCapitalJ]2b"]}]}], ")"}]}]], ",", 
                  "kb02"}], "]"}], "]"}]}]}], ")"}]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["r2b", "2"], "+", "\[ScriptCapitalJ]2b"}], ")"}],
             " ", 
            RowBox[{
             InterpretationBox[
              StyleBox["EllipticK",
               ShowAutoStyles->False,
               AutoSpacing->False],
              EllipticK,
              Editable->False], "[", "kb02", "]"}]}]]}], ")"}]}]]}], ")"}]}]}]
   , ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Nu]periBW", "=", 
   RowBox[{"2", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        SqrtBox["\[ScriptCapitalJ]2b"], " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticK",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticK,
          Editable->False], "[", "kb02", "]"}]}], 
       RowBox[{"\[Pi]", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"r2b", "-", "r4b"}], ")"}]}]], " ", 
        SqrtBox[
         RowBox[{"1", "-", "\[ScriptCapitalE]2b"}]]}]]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Delta]\[Nu]peri", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r2b", "-", "r4b"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[ScriptCapitalE]2b"}], ")"}]}]], "8", " ", 
    SuperscriptBox[
     RowBox[{
      InterpretationBox[
       StyleBox["EllipticK",
        ShowAutoStyles->False,
        AutoSpacing->False],
       EllipticK,
       Editable->False], "[", "kb02", "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Pi]", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"r2b", "-", "r4b"}], ")"}]}]], " ", 
        SqrtBox[
         RowBox[{"1", "-", "\[ScriptCapitalE]2b"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          SqrtBox["\[ScriptCapitalE]2b"], "+", 
          FractionBox["\[ScriptCapitalJ]2sb", 
           RowBox[{"2", " ", 
            SqrtBox["\[ScriptCapitalJ]2b"]}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticK",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticK,
          Editable->False], "[", "kb02", "]"}]}]], "+", 
      RowBox[{
       SqrtBox["\[ScriptCapitalJ]2b"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "r3sb"}], " ", 
               RowBox[{"(", 
                RowBox[{"r2b", "-", "r4b"}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"r1b", "-", "r3b"}], ")"}], " ", "r4sb"}]}], ")"}], 
            " ", 
            SqrtBox[
             RowBox[{"1", "-", "\[ScriptCapitalE]2b"}]]}], 
           RowBox[{"4", " ", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"r2b", "-", "r4b"}], ")"}]}]], " ", 
            RowBox[{
             InterpretationBox[
              StyleBox["EllipticK",
               ShowAutoStyles->False,
               AutoSpacing->False],
              EllipticK,
              Editable->False], "[", "kb02", "]"}]}]]}], "+", 
         FractionBox[
          RowBox[{"\[Pi]", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2b", "-", "r4b"}], ")"}]}]], " ", 
           "\[ScriptCapitalE]2sb"}], 
          RowBox[{"4", " ", 
           SqrtBox[
            RowBox[{"1", "-", "\[ScriptCapitalE]2b"}]], " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["EllipticK",
              ShowAutoStyles->False,
              AutoSpacing->False],
             EllipticK,
             Editable->False], "[", "kb02", "]"}]}]], "+", 
         FractionBox[
          RowBox[{"ks02", " ", "\[Pi]", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1b", "-", "r3b"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"r2b", "-", "r4b"}], ")"}]}]], " ", 
           SqrtBox[
            RowBox[{"1", "-", "\[ScriptCapitalE]2b"}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              InterpretationBox[
               StyleBox["EllipticE",
                ShowAutoStyles->False,
                AutoSpacing->False],
               EllipticE,
               Editable->False], "[", "kb02", "]"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "kb02"}], ")"}], " ", 
              RowBox[{
               InterpretationBox[
                StyleBox["EllipticK",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                EllipticK,
                Editable->False], "[", "kb02", "]"}]}]}], ")"}]}], 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "kb02"}], ")"}], " ", "kb02", " ", 
           SuperscriptBox[
            RowBox[{
             InterpretationBox[
              StyleBox["EllipticK",
               ShowAutoStyles->False,
               AutoSpacing->False],
              EllipticK,
              Editable->False], "[", "kb02", "]"}], "2"]}]]}], ")"}]}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Nu]peri", "=", 
   RowBox[{"\[Nu]periBW", "+", "\[Delta]\[Nu]peri"}]}], ";"}], "\n"}], "Code",
 CellChangeTimes->{{3.9413440078900394`*^9, 3.941344049428097*^9}, {
  3.941344130266123*^9, 
  3.9413441713405704`*^9}},ExpressionUUID->"3fb4ab5e-b6df-4c45-a2f9-\
cd58fb90d524"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Orbit", "Subsection",
 CellChangeTimes->{
  3.9413434001598434`*^9},ExpressionUUID->"e19de6b2-ae80-e94b-855f-\
19b6a434be58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"qr", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CurlyCapitalUpsilon]r", " ", "\[Lambda]"}], " ", "+", " ", 
    "qr0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"qt", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CurlyCapitalUpsilon]t", " ", "\[Lambda]"}], " ", "+", " ", 
    "qt0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"q\[CurlyPhi]", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CurlyCapitalUpsilon]\[CurlyPhi]", " ", "\[Lambda]"}], " ", "+",
     " ", "q\[CurlyPhi]0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"q\[Psi]", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CurlyCapitalUpsilon]\[Psi]", " ", "\[Lambda]"}], " ", "+", " ",
     "q\[Psi]0"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9240731052922945`*^9, 3.924073258516603*^9}, {
   3.924121319802274*^9, 3.924121320258924*^9}, {3.924121382377527*^9, 
   3.924121382698498*^9}, {3.924121520460129*^9, 3.924121523529906*^9}, 
   3.92472711696465*^9, 3.9252871544652634`*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"f876edef-e97b-f849-b9c1-3c2b8e218d9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"r0\[Lambda]", "[", "\[Lambda]_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"r2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "r1"}], "+", "r3"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r1", "-", "r2"}], ")"}], " ", "r3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Sin", "@", 
         RowBox[{"JacobiAmplitude", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"qr", "[", "\[Lambda]", "]"}], "\[Pi]"], 
            RowBox[{
             InterpretationBox[
              StyleBox["EllipticK",
               ShowAutoStyles->False,
               AutoSpacing->False],
              EllipticK,
              Editable->False], "[", 
             SuperscriptBox["k0", "2"], "]"}]}], ",", 
           SuperscriptBox["k0", "2"]}], "]"}]}], ")"}], "2"]}]}], 
    RowBox[{
     RowBox[{"-", "r1"}], "+", "r3", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r1", "-", "r2"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Sin", "@", 
         RowBox[{"JacobiAmplitude", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"qr", "[", "\[Lambda]", "]"}], "\[Pi]"], 
            RowBox[{
             InterpretationBox[
              StyleBox["EllipticK",
               ShowAutoStyles->False,
               AutoSpacing->False],
              EllipticK,
              Editable->False], "[", 
             SuperscriptBox["k0", "2"], "]"}]}], ",", 
           SuperscriptBox["k0", "2"]}], "]"}]}], ")"}], "2"]}]}]]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"t0", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"qt", "[", "\[Lambda]", "]"}], "+", 
    RowBox[{"Tr0", "[", 
     RowBox[{
      InterpretationBox[
       StyleBox["JacobiAmplitude",
        ShowAutoStyles->False,
        AutoSpacing->False],
       JacobiAmplitude,
       Editable->False], "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"qr", "[", "\[Lambda]", "]"}], "\[Pi]"], 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticK",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticK,
          Editable->False], "[", 
         SuperscriptBox["k0", "2"], "]"}]}], ",", 
       SuperscriptBox["k0", "2"]}], "]"}], "]"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"Tr0", "[", "\[Pi]", "]"}], 
      RowBox[{"2", "\[Pi]"}]], 
     RowBox[{"qr", "[", "\[Lambda]", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[CurlyPhi]0", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"q\[CurlyPhi]", "[", "\[Lambda]", "]"}], "+", 
    RowBox[{"\[CapitalPhi]r0", "[", 
     RowBox[{
      InterpretationBox[
       StyleBox["JacobiAmplitude",
        ShowAutoStyles->False,
        AutoSpacing->False],
       JacobiAmplitude,
       Editable->False], "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"qr", "[", "\[Lambda]", "]"}], "\[Pi]"], 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticK",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticK,
          Editable->False], "[", 
         SuperscriptBox["k0", "2"], "]"}]}], ",", 
       SuperscriptBox["k0", "2"]}], "]"}], "]"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"\[CapitalPhi]r0", "[", "\[Pi]", "]"}], 
      RowBox[{"2", "\[Pi]"}]], 
     RowBox[{"qr", "[", "\[Lambda]", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]0", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    RowBox[{"q\[Psi]", "[", "\[Lambda]", "]"}], "+", 
    RowBox[{"\[CapitalPsi]r0", "[", 
     RowBox[{
      InterpretationBox[
       StyleBox["JacobiAmplitude",
        ShowAutoStyles->False,
        AutoSpacing->False],
       JacobiAmplitude,
       Editable->False], "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"qr", "[", "\[Lambda]", "]"}], "\[Pi]"], 
        RowBox[{
         InterpretationBox[
          StyleBox["EllipticK",
           ShowAutoStyles->False,
           AutoSpacing->False],
          EllipticK,
          Editable->False], "[", 
         SuperscriptBox["k0", "2"], "]"}]}], ",", 
       SuperscriptBox["k0", "2"]}], "]"}], "]"}], "-", 
    RowBox[{
     FractionBox[
      RowBox[{"\[CapitalPsi]r0", "[", "\[Pi]", "]"}], 
      RowBox[{"2", "\[Pi]"}]], 
     RowBox[{"qr", "[", "\[Lambda]", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Theta]0", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{
    FractionBox["\[Pi]", "2"], "+", 
    RowBox[{
     FractionBox[
      RowBox[{
       SqrtBox[
        SuperscriptBox["sn", "2"]], 
       SqrtBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"r0\[Lambda]", "[", "\[Lambda]", "]"}], "2"], "+", 
          SuperscriptBox["\[ScriptCapitalJ]", "2"]}], ")"}]]}], 
      RowBox[{
       RowBox[{"r0\[Lambda]", "[", "\[Lambda]", "]"}], " ", 
       "\[ScriptCapitalJ]"}]], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Psi]0", "[", "\[Lambda]", "]"}], "]"}]}]}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.924073260879277*^9, 3.9240732791745462`*^9}, {
   3.9240736713989697`*^9, 3.924073785029422*^9}, {3.924074132275259*^9, 
   3.924074132970424*^9}, {3.924074168530551*^9, 3.9240741722584887`*^9}, {
   3.924074209427427*^9, 3.9240742096434145`*^9}, {3.924118931062799*^9, 
   3.924118931583641*^9}, {3.924119020357215*^9, 3.924119061882004*^9}, {
   3.924119094305419*^9, 3.9241191724938884`*^9}, 3.9241192202216444`*^9, 
   3.9241192733355856`*^9, {3.924119968921704*^9, 3.924119976516953*^9}, {
   3.924121230026127*^9, 3.924121251168449*^9}, {3.92412175728834*^9, 
   3.924121779169098*^9}, 3.924122114810484*^9, {3.9247271290556355`*^9, 
   3.924727144526172*^9}, {3.925273461069113*^9, 3.925273466676314*^9}, {
   3.925287190144758*^9, 3.925287206851641*^9}, {3.9252883999569874`*^9, 
   3.925288404130581*^9}, {3.925288734307766*^9, 3.9252887395165634`*^9}, 
   3.926481657455452*^9, {3.9264818339409657`*^9, 3.926481862340134*^9}, 
   3.927091077499525*^9, {3.941096230759819*^9, 3.941096231266854*^9}, {
   3.9413435546242657`*^9, 
   3.941343555278049*^9}},ExpressionUUID->"b9bf0916-80b3-2d40-ad5a-\
2f5a1699f78b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"t0A", "[", "\[Lambda]_", "]"}], ":=", 
   RowBox[{"Tr0", "[", 
    RowBox[{
     InterpretationBox[
      StyleBox["JacobiAmplitude",
       ShowAutoStyles->False,
       AutoSpacing->False],
      JacobiAmplitude,
      Editable->False], "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r1", "-", "r3"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"r2", "-", "r4"}], ")"}]}]], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox[
            InterpretationBox[
             StyleBox["\[ScriptCapitalE]",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`\[ScriptCapitalE],
             Editable->False], "2"]}]]}], "2"], " ", "\[Lambda]"}], ",", 
      SuperscriptBox["k0", "2"]}], "]"}], "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.9418395361024876`*^9, 3.9418395378038387`*^9}, 
   3.9418395700069656`*^9, {3.9418405827106113`*^9, 3.94184065258926*^9}, 
   3.9418408417173214`*^9, 
   3.9420092563137074`*^9},ExpressionUUID->"087fad13-7243-004d-8586-\
6fb69b1bab04"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Spacetime", "Section",
 CellChangeTimes->{{3.927684166141945*^9, 3.927684177591475*^9}, {
  3.94106531832415*^9, 
  3.9410653202816753`*^9}},ExpressionUUID->"b2c277cb-088a-274b-bbfa-\
12570bfd1e80"],

Cell[CellGroupData[{

Cell["To the exact spacetime metric", "Subsubsection",
 CellChangeTimes->{{3.908422814077899*^9, 3.9084228258634515`*^9}, 
   3.941065134642824*^9},ExpressionUUID->"7784b9bd-a90c-c446-920d-\
ee20c81bbc29"],

Cell["Spherically symmetric black hole", "Text",
 CellChangeTimes->{3.906619840196193*^9, 3.9084158315810957`*^9, 
  3.9410651911624107`*^9},ExpressionUUID->"50019fec-b7be-3e40-a851-\
563458cfd3e2"],

Cell[BoxData[
 FormBox[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        StyleBox["d", "TI"], 
        SuperscriptBox[
         StyleBox["s", "TI"], "2"], "\[LongEqual]", "-", 
        StyleBox["f", "TI"], 
        RowBox[{"(", 
          StyleBox["r", "TI"], ")"}], 
        StyleBox["d", "TI"], 
        SuperscriptBox[
         StyleBox["t", "TI"], "2"], "+", 
        StyleBox["f", "TI"], 
        SuperscriptBox[
         RowBox[{"(", 
           StyleBox["r", "TI"], ")"}], "-1"], 
        StyleBox["d", "TI"], 
        SuperscriptBox[
         StyleBox["r", "TI"], "2"], "+", 
        SuperscriptBox[
         StyleBox["r", "TI"], "2"], 
        RowBox[{"(", 
          RowBox[{
            StyleBox["d", "TI"], 
            SuperscriptBox["\[Theta]", "2"], "+", 
            SuperscriptBox["sin", "2"], "\[Theta]", 
            StyleBox["d", "TI"], 
            SuperscriptBox["\[Phi]", "2"]}], ")"}]}], TraditionalForm], 
    "errors" -> {}, "input" -> 
    "d s^{2} & =-f(r) d t^{2}+f(r)^{-1} d r^{2}+r^{2}\\left(d \
\\theta^{2}+\\sin ^{2} \\theta d \\phi^{2}\\right)", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"], TraditionalForm]], "EquationNumbered",
 CellChangeTimes->{{3.9066179109802504`*^9, 3.906617914567794*^9}, 
   3.906617960148552*^9, {3.907361838971653*^9, 3.907361858852738*^9}, {
   3.907363292048117*^9, 3.907363311997058*^9}, {3.908416032995107*^9, 
   3.908416043164001*^9}, {3.9100384568191166`*^9, 
   3.910038457278971*^9}},ExpressionUUID->"e39c28f3-7ff2-354c-b3e7-\
e1574b2906ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ToSpacetime", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<Spacetime\>\"", " ", "->", " ", "\"\<UnKnow\>\""}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SpacetimeSet", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<UnKnow\>\"", ",", "\"\<Schwarzschild\>\"", ",", "\"\<Brane\>\""}], 
    "}"}]}], ";"}]}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.908416622777768*^9, 3.9084166793373494`*^9}, 
   3.9084179069310446`*^9, 3.9084231755198174`*^9, {3.908424439044543*^9, 
   3.908424447297628*^9}, {3.9084261693257513`*^9, 3.9084261726181355`*^9}, 
   3.910040303480002*^9, {3.9410650493342705`*^9, 3.941065067706476*^9}},
 CellLabel->
  "In[633]:=",ExpressionUUID->"c0d34ebb-bbfd-6348-b21d-ff190d87bfab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToSpacetime", "[", 
     RowBox[{"OptionsPattern", "[", "]"}], "]"}], "[", "exp_", "]"}], ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"spacetime", ",", "RepalceSet"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"spacetime", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Spacetime\>\"", "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"spacetime", ",", " ", "SpacetimeSet"}], "]"}], ",", " ", 
        "\n", 
        RowBox[{
        "Print", "[", "\"\<The spacetime metric is unknown\>\"", "]"}]}], 
       "]"}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"spacetime", " ", "==", " ", "\"\<UnKnow\>\""}], ",", " ", 
        RowBox[{"RepalceSet", "=", 
         RowBox[{"{", 
          RowBox[{"f", "->", "f"}], "}"}]}]}], "]"}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"spacetime", " ", "==", " ", "\"\<Schwarzschild\>\""}], ",", 
        " ", 
        RowBox[{"RepalceSet", "=", 
         RowBox[{"{", 
          RowBox[{"f", "->", "fSh"}], "}"}]}]}], "]"}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"spacetime", " ", "==", " ", "\"\<Brane\>\""}], ",", " ", 
        RowBox[{"RepalceSet", "=", 
         RowBox[{"{", 
          RowBox[{"f", "->", "fShBW"}], "}"}]}]}], "]"}], ";", "\n", 
      RowBox[{"exp", "/.", "RepalceSet"}]}]}], "\n", "  ", "]"}]}], 
  ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.90841606191706*^9, {3.908416730364177*^9, 3.9084167880268745`*^9}, {
   3.908416941491918*^9, 3.908417008260153*^9}, {3.908417047657948*^9, 
   3.9084170839541593`*^9}, {3.90841717192292*^9, 3.9084172353621683`*^9}, {
   3.9084179005696497`*^9, 3.908417908489341*^9}, {3.9084231431378098`*^9, 
   3.908423169969792*^9}, {3.908424391322645*^9, 3.908424391488768*^9}, 
   3.908424451888134*^9, {3.9084261615068007`*^9, 3.908426167458336*^9}, 
   3.908426631791533*^9, {3.9084266818349752`*^9, 3.9084266833003793`*^9}, 
   3.908430069978575*^9, 3.9084304977631783`*^9, {3.908486744492949*^9, 
   3.908486781054494*^9}, {3.9084870138984365`*^9, 3.908487070581965*^9}, {
   3.908487104501545*^9, 3.908487148937596*^9}, {3.9084874329172716`*^9, 
   3.9084874653044076`*^9}, {3.908487645197462*^9, 3.908487651424459*^9}, 
   3.908487745658068*^9, 3.909518734356499*^9, {3.909519328391037*^9, 
   3.909519334141283*^9}, {3.9095193683280416`*^9, 3.9095193872992153`*^9}, 
   3.909519483013945*^9, {3.9095195232231903`*^9, 3.909519557055229*^9}, {
   3.9095198073654556`*^9, 3.909519817776608*^9}, {3.909641624495228*^9, 
   3.9096416509375396`*^9}, {3.909641897056349*^9, 3.90964190100239*^9}, {
   3.909690146587217*^9, 3.909690148666691*^9}, 3.909690200238707*^9, 
   3.9100381877946978`*^9, {3.910038300742326*^9, 3.9100384049770265`*^9}, {
   3.910038474483319*^9, 3.910038491599982*^9}, {3.910038725926518*^9, 
   3.91003876492805*^9}, {3.910038838990491*^9, 3.910038911384269*^9}, {
   3.9100400684078875`*^9, 3.910040113807173*^9}, {3.9100401461962223`*^9, 
   3.9100401751363573`*^9}, {3.910040229734811*^9, 3.910040233953216*^9}, 
   3.910040304075361*^9, {3.910040436916928*^9, 3.91004051209223*^9}, {
   3.910040696843073*^9, 3.910040703854611*^9}, 3.927684303279358*^9, {
   3.927684427080364*^9, 3.9276844749443245`*^9}, {3.940450288309765*^9, 
   3.9404502899457417`*^9}, {3.940882552086094*^9, 3.940882586463175*^9}, 
   3.941055780592945*^9, 3.9410650299426785`*^9, 3.9410650717392387`*^9, 
   3.9410784182680664`*^9},
 CellLabel->
  "In[636]:=",ExpressionUUID->"6a32bd72-be0d-f541-a700-f3047a786b22"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fluxes", "Section",
 CellChangeTimes->{3.9072244547334194`*^9, 
  3.9410788446378746`*^9},ExpressionUUID->"8482b699-bd60-5644-bc96-\
980732b28049"],

Cell["Reference", "Text",
 CellChangeTimes->{{3.907269535845736*^9, 3.9072695758190155`*^9}, 
   3.907269953625627*^9, {3.9072700443524656`*^9, 3.907270092867668*^9}, {
   3.908398447389473*^9, 3.908398466267521*^9}, {3.908399285283139*^9, 
   3.908399317119357*^9}, {3.9410788528591785`*^9, 
   3.941078908426319*^9}},ExpressionUUID->"815f3fc5-bb44-f749-9005-\
33f7ea4ce387"],

Cell["\<\
[Gravitational_Peters_1964] P.C. Peters, Gravitational Radiation and the \
Motion of Two Point Masses, Phys. Rev. 136, B1224 (1964).\
\>", "Text",
 CellChangeTimes->{{3.907269535845736*^9, 3.9072695758190155`*^9}, 
   3.907269953625627*^9, {3.9072700443524656`*^9, 3.907270092867668*^9}, {
   3.908398447389473*^9, 3.908398466267521*^9}, {3.908399285283139*^9, 
   3.908399317119357*^9}, {3.9410788528591785`*^9, 
   3.9410788918617115`*^9}},ExpressionUUID->"62375bcd-aa81-264a-a30c-\
d87f4f36492a"],

Cell["\<\
[Gravitational_Peters_1963] P. C. Peters and J. Mathews, Gravitational \
Radiation from Point Masses in a Keplerian Orbit, Phys. Rev. 131, 435 (1963).\
\>", "Text",
 CellChangeTimes->{{3.907269535845736*^9, 3.9072695758190155`*^9}, 
   3.907269953625627*^9, {3.9072700443524656`*^9, 3.907270092867668*^9}, {
   3.908398447389473*^9, 3.908398466267521*^9}, {3.908399285283139*^9, 
   3.908399317119357*^9}, {3.9410788528591785`*^9, 
   3.9410788528645782`*^9}},ExpressionUUID->"667f3d38-99e8-1342-8785-\
bae3ba8c5c8d"],

Cell[CellGroupData[{

Cell["Definition", "Subsection",
 CellChangeTimes->{
  3.907267669920395*^9, {3.9410789386646576`*^9, 
   3.9410789401841507`*^9}},ExpressionUUID->"7a7accb9-c228-7440-9eb8-\
9d03219fecd7"],

Cell[CellGroupData[{

Cell["Define 3-dimensional space", "Subsubsection",
 CellChangeTimes->{{3.878678327401783*^9, 3.878678347146702*^9}, {
  3.907268248361493*^9, 3.907268251199179*^9}, {3.941078955354149*^9, 
  3.941078957953026*^9}},ExpressionUUID->"e0afc5c2-6975-c04a-a407-\
afbea1438a3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Index3d", ":=", 
   RowBox[{"Index3d", "=", 
    RowBox[{"IndexRange", "[", 
     RowBox[{"i", ",", "l"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefManifold", "[", 
   RowBox[{"M3", ",", "3", ",", "Index3d"}], "]"}], ";"}]}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.878678398589819*^9, 3.878678409664137*^9}, 
   3.8786785704153533`*^9, {3.8786795643021407`*^9, 3.8786795858114634`*^9}, {
   3.906687832065627*^9, 3.9066878374394903`*^9}, {3.906692210054816*^9, 
   3.906692211344706*^9}, {3.907268254728256*^9, 3.9072682655055475`*^9}, {
   3.9072683042595587`*^9, 3.9072683064326653`*^9}, {3.90726848691614*^9, 
   3.907268494073088*^9}, {3.907268570902311*^9, 3.9072685745067987`*^9}, {
   3.908830434865149*^9, 3.9088304548639956`*^9}, 3.9410788074388523`*^9},
 CellLabel->
  "In[657]:=",ExpressionUUID->"05a9bedb-0ecc-8540-b541-0b4a74391287"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Chart", "Subsubsection",
 CellChangeTimes->{{3.878678327401783*^9, 3.878678347146702*^9}, 
   3.906687913066678*^9, 
   3.9410789740806427`*^9},ExpressionUUID->"939fe56a-d958-db41-8459-\
862e227d6645"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefChart", "[", 
   RowBox[{"Euro", ",", "M3", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", "]"}], ",", 
      RowBox[{"y", "[", "]"}], ",", 
      RowBox[{"z", "[", "]"}]}], "}"}], ",", 
    RowBox[{"ChartColor", "\[Rule]", "Blue"}], ",", 
    RowBox[{"FormatBasis", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Partials\>\"", ",", "\"\<Differentials\>\""}], "}"}]}]}], 
   "]"}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.906687896149556*^9, 3.906687917253393*^9}, {
  3.90726831043882*^9, 3.907268363544443*^9}, {3.907268394240436*^9, 
  3.907268397432443*^9}, {3.907268508136556*^9, 3.907268548903448*^9}},
 CellLabel->
  "In[659]:=",ExpressionUUID->"5cd51bdc-42c6-ac42-aa6e-7aef568abb2c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["ReducedMass", "Subsubsection",
 CellChangeTimes->{{3.9072708095612907`*^9, 3.907270813790985*^9}, 
   3.9410789812273064`*^9},ExpressionUUID->"ef5f8c17-5c43-0040-a78a-\
9e44c4425e9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", 
   RowBox[{"ReducedMass", ",", 
    RowBox[{"PrintAs", "->", "\"\<\[Mu]\>\""}]}], "]"}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.906862191260118*^9, 3.906862228931487*^9}, {
   3.9072708864446106`*^9, 3.907270890935446*^9}, 3.941078805998413*^9},
 CellLabel->
  "In[660]:=",ExpressionUUID->"e2534f4f-d6cc-324f-8e6e-f95ad4ad25d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric", "Subsubsection",
 CellChangeTimes->{{3.907270453582868*^9, 3.907270464229109*^9}, 
   3.9410789986356487`*^9},ExpressionUUID->"0bac457b-bf67-4445-ba93-\
2980eaf48166"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gEuro", " ", ":=", " ", 
   RowBox[{"gEuro", "=", " ", 
    RowBox[{"CTensor", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", " ", ",", "1"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Euro"}], ",", 
        RowBox[{"-", "Euro"}]}], "}"}]}], "]"}]}]}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.904277746001945*^9, {3.9042778838396034`*^9, 3.90427789559659*^9}, {
   3.904278088102135*^9, 3.9042780896699467`*^9}, {3.9042782107398763`*^9, 
   3.904278272648949*^9}, {3.904278616979107*^9, 3.904278620415199*^9}, {
   3.90427873164821*^9, 3.9042787502085094`*^9}, 3.904278881407424*^9, 
   3.90427928614796*^9, {3.904279424342*^9, 3.904279446756645*^9}, {
   3.904280073918883*^9, 3.904280093951174*^9}, {3.904280128881527*^9, 
   3.904280183563749*^9}, {3.9042802373053646`*^9, 3.9042803070646954`*^9}, {
   3.904280616042675*^9, 3.904280641121374*^9}, {3.9042810267248755`*^9, 
   3.9042811055318623`*^9}, {3.90428229651134*^9, 3.904282345778245*^9}, {
   3.904282411747573*^9, 3.904282418940627*^9}, {3.904282765110753*^9, 
   3.904282800859987*^9}, 3.90428324161674*^9, {3.906688196290554*^9, 
   3.90668821953167*^9}, {3.906689093396568*^9, 3.906689596299718*^9}, {
   3.906689837928892*^9, 3.906689867716341*^9}, 3.906689904630472*^9, {
   3.9066906748196917`*^9, 3.9066906913289104`*^9}, {3.906690755246444*^9, 
   3.9066907804828606`*^9}, {3.906690866902655*^9, 3.906690884916235*^9}, 
   3.906690936889573*^9, {3.9066913850510497`*^9, 3.906691393033664*^9}, {
   3.906691427191261*^9, 3.906691428617588*^9}, {3.906691700387775*^9, 
   3.9066917031304917`*^9}, {3.906691815976354*^9, 3.9066918202105017`*^9}, {
   3.906691850330412*^9, 3.906691875121274*^9}, {3.906691908093674*^9, 
   3.906691941570627*^9}, {3.906691972736395*^9, 3.906691979211067*^9}, {
   3.9066920881633873`*^9, 3.906692088428187*^9}, {3.906692134136689*^9, 
   3.906692146628918*^9}, {3.906692321732648*^9, 3.906692324383009*^9}, {
   3.9066923641727233`*^9, 3.906692365073089*^9}, {3.906692461045494*^9, 
   3.906692462467429*^9}, {3.90669279352497*^9, 3.906692796317297*^9}, {
   3.906694278773136*^9, 3.9066942812817087`*^9}, {3.906751456948036*^9, 
   3.906751471264905*^9}, {3.906773228523392*^9, 3.9067733409002233`*^9}, 
   3.907270469164381*^9, {3.907270516129071*^9, 3.907270601986424*^9}, {
   3.908418838836285*^9, 3.9084188411287374`*^9}, {3.908830192801458*^9, 
   3.90883019817435*^9}},
 CellLabel->
  "In[661]:=",ExpressionUUID->"8e18ea9f-5ea7-7d4a-8647-a612ca8236af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetCMetric", "[", 
   RowBox[{"gEuro", ",", "Euro", ",", 
    RowBox[{"SignatureOfMetric", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0", ",", "0"}], "}"}]}]}], "]"}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.9066923829299994`*^9, {3.907270650966774*^9, 3.907270663798258*^9}, {
   3.9084188235815935`*^9, 3.908418826133261*^9}, 3.9410788032879963`*^9},
 CellLabel->
  "In[662]:=",ExpressionUUID->"4b397195-25f2-bd44-b98d-98d690ed27c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fully antisymmetric tensors", "Subsubsection",
 CellChangeTimes->{{3.9082516861593075`*^9, 3.908251687292298*^9}, 
   3.941079257603283*^9},ExpressionUUID->"08210fb0-29c5-a149-9b2e-\
b8bca1d86939"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"epsilongEuor", "::", "usage"}], " ", "=", " ", 
   "\"\<epsilongEuor[i]:Fully antisymmetric tensors in three-dimensional \
Euclidean Spaces (Levi-Civita notation).\>\""}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.908403556664776*^9, 3.90840356245864*^9}, {
   3.9084036889058657`*^9, 3.908403702787089*^9}, 3.9410788043381863`*^9, 
   3.9410792449852047`*^9},
 CellLabel->
  "In[672]:=",ExpressionUUID->"2953245d-7324-e249-9cdb-08cd41df2d33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"epsilongEuor", ":=", 
   RowBox[{"epsilongEuor", "=", 
    RowBox[{"CTensor", "[", 
     RowBox[{
      RowBox[{"LeviCivitaTensor", "[", "3", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "Euro"}], ",", 
        RowBox[{"-", "Euro"}], ",", 
        RowBox[{"-", "Euro"}]}], "}"}]}], "]"}]}]}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.908831325600496*^9, 3.908831326296338*^9}, 
   3.9410788006369076`*^9},
 CellLabel->
  "In[673]:=",ExpressionUUID->"c68cfcfb-6428-4c4e-94c5-ed5f89faff7b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The position vector of the test  particle", "Subsubsection",
 CellChangeTimes->{{3.9072676855256057`*^9, 3.907267689246707*^9}, {
  3.941079305359682*^9, 
  3.941079316516012*^9}},ExpressionUUID->"39d631b4-8eb9-6f4d-9614-\
0dfb534c0a42"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "2"}], "+", "\[Epsilon]"}], " ", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", " ", ",", "0", ",", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"\[Pi]", "/", "2"}], "+", "\[Epsilon]"}], " ", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Epsilon]", " ", ",", "0", ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.927686984065283*^9, 3.927686989262318*^9}, {
  3.9276871734314976`*^9, 3.927687224653977*^9}, {3.927687275143471*^9, 
  3.927687275712273*^9}, {3.9276873179797554`*^9, 3.927687353891432*^9}, {
  3.9410793837902393`*^9, 3.94107940126227*^9}},
 CellLabel->
  "In[678]:=",ExpressionUUID->"59016a03-f119-7f46-9527-b97e086d60e7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   FractionBox[
    SuperscriptBox[
     InterpretationBox[
      StyleBox["\[Epsilon]",
       ShowAutoStyles->False,
       AutoSpacing->False],
      $CellContext`\[Epsilon],
      Editable->False], "2"], "2"], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      InterpretationBox[
       StyleBox["\[Epsilon]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[Epsilon],
       Editable->False], "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {1, 0, 
    Rational[-1, 2]}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.9276871652504215`*^9, 3.927687225528374*^9}, 
   3.92768727655004*^9, {3.9276873255682144`*^9, 3.927687354714873*^9}, 
   3.9410792174833317`*^9, 3.9410793184247704`*^9, {3.9410793965089016`*^9, 
   3.9410794020790863`*^9}},
 CellLabel->
  "Out[678]=",ExpressionUUID->"07b90632-69d8-474b-88af-e7e8199e5e8f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    InterpretationBox[
     StyleBox["\[Epsilon]",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`\[Epsilon],
     Editable->False]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      InterpretationBox[
       StyleBox["\[Epsilon]",
        ShowAutoStyles->False,
        AutoSpacing->False],
       $CellContext`\[Epsilon],
       Editable->False], "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {-1}, 1, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.9276871652504215`*^9, 3.927687225528374*^9}, 
   3.92768727655004*^9, {3.9276873255682144`*^9, 3.927687354714873*^9}, 
   3.9410792174833317`*^9, 3.9410793184247704`*^9, {3.9410793965089016`*^9, 
   3.941079402083912*^9}},
 CellLabel->
  "Out[679]=",ExpressionUUID->"d60c9e9f-88c1-2842-8b54-6430cb0da7ad"]
}, Open  ]],

Cell["Here r[t] is the mass normalized r[t]", "Text",
 CellChangeTimes->{{3.9409258997696323`*^9, 3.9409259409179783`*^9}, {
  3.941079329094143*^9, 
  3.941079346756876*^9}},ExpressionUUID->"f64653c0-9ce9-3041-94c0-\
77e1610ec69d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xPoint", ":=", 
   RowBox[{"xPoint", "=", 
    RowBox[{"CTensor", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"M", " ", 
         RowBox[{
          RowBox[{"r", "[", "]"}], "[", 
          RowBox[{"t", "[", "]"}], "]"}], "  ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "]"}], "[", 
           RowBox[{"t", "[", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"M", " ", 
         RowBox[{
          RowBox[{"r", "[", "]"}], "[", 
          RowBox[{"t", "[", "]"}], "]"}], "  ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "]"}], "[", 
           RowBox[{"t", "[", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"-", " ", "\[Epsilon]"}], " ", "M", " ", 
         RowBox[{
          RowBox[{"r", "[", "]"}], "[", 
          RowBox[{"t", "[", "]"}], "]"}], " ", " ", 
         RowBox[{
          RowBox[{"\[Delta]\[Theta]", "[", "]"}], "[", 
          RowBox[{"t", "[", "]"}], "]"}]}]}], "  ", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"-", "Euro"}], "}"}]}], "]"}]}]}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.90727010637749*^9, 3.907270109931677*^9}, {
   3.907270203908285*^9, 3.9072702091509895`*^9}, {3.907270304637163*^9, 
   3.907270378502798*^9}, {3.9072706047416945`*^9, 3.907270612841707*^9}, {
   3.907270722494463*^9, 3.907270764589681*^9}, {3.907271143872572*^9, 
   3.907271155092517*^9}, {3.9076198639901958`*^9, 3.9076198748899593`*^9}, {
   3.9076200205652375`*^9, 3.907620027339035*^9}, {3.908250614623101*^9, 
   3.908250617898211*^9}, {3.908830228220641*^9, 3.908830238012445*^9}, {
   3.92768612585174*^9, 3.9276861263707843`*^9}, {3.9276861828362617`*^9, 
   3.9276862112412376`*^9}, {3.927687246873577*^9, 3.9276872686995173`*^9}, {
   3.92768734255704*^9, 3.927687361807406*^9}, {3.927687686512705*^9, 
   3.9276876871540985`*^9}, {3.940925887423441*^9, 3.9409258937849483`*^9}, 
   3.941078797232996*^9, {3.941079368103977*^9, 3.941079369588537*^9}, {
   3.941079414497587*^9, 3.941079419738867*^9}},
 CellLabel->
  "In[680]:=",ExpressionUUID->"20ddb395-c235-2b4b-8dbd-e87c8f8fc48a"],

Cell["Mass moment", "Text",ExpressionUUID->"c452967e-6323-524c-9780-bac420e25b3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QM", ":=", 
   RowBox[{"QM", "=", 
    RowBox[{"HeadOfTensor", "[", 
     RowBox[{
      RowBox[{"ReducedMass", " ", 
       RowBox[{"xPoint", "[", 
        RowBox[{"-", "i"}], "]"}], 
       RowBox[{"xPoint", "[", 
        RowBox[{"-", "j"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "i"}], ",", 
        RowBox[{"-", "j"}]}], "}"}]}], "]"}]}]}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.9082506210245934`*^9, {3.908830259762843*^9, 3.908830263416311*^9}},
 CellLabel->
  "In[681]:=",ExpressionUUID->"091d3cc4-6410-6d4e-b880-4739e72130ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The relation of energy \[ScriptCapitalE] and angular momentum \
\[ScriptCapitalJ] to  {e , p}", "Subsubsection",
 CellChangeTimes->{{3.908477906985406*^9, 3.908477910191768*^9}, {
  3.9084780758629985`*^9, 3.9084781040365543`*^9}, {3.908478144713646*^9, 
  3.908478148116352*^9}, {3.908852711871319*^9, 3.908852732425337*^9}, {
  3.9410794599928513`*^9, 3.94107946268606*^9}, {3.9410795103696575`*^9, 
  3.941079544555006*^9}},ExpressionUUID->"d13d4b02-3cc1-1e4a-badf-\
1e7e910d2228"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "EJTope", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<Spacetime\>\"", " ", "->", "\"\<Schwarzschild\>\""}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EJTope", "[", 
     RowBox[{"OptionsPattern", "[", "]"}], "]"}], "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "spacetime", ",", "FK2", ",", "FK3", ",", "ReplaceSet", ",", 
       "\[ScriptCapitalE]2Approxep", ",", "\[ScriptCapitalJ]2Approxep"}], 
      "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"spacetime", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Spacetime\>\"", "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"FK2", "[", "r_", "]"}], ":=", 
       FractionBox[
        RowBox[{"f", "[", "r", "]"}], 
        RowBox[{" ", 
         SuperscriptBox["r", "2"]}]]}], ";", "\n", 
      RowBox[{
       RowBox[{"FK3", "[", "r_", "]"}], ":=", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{
            InterpretationBox[
             StyleBox["f",
              ShowAutoStyles->False,
              AutoSpacing->False],
             $CellContext`f,
             Editable->False], "[", "r", "]"}]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{
            SuperscriptBox[
             InterpretationBox[
              StyleBox["f",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`f,
              Editable->False], "\[Prime]",
             MultilineFunction->None], "[", "r", "]"}]}]}], ")"}], 
        SuperscriptBox["r", "2"]]}], ";", "\n", 
      RowBox[{"\[ScriptCapitalE]2Approxep", "=", 
       RowBox[{
        RowBox[{"ToSpacetime", "[", 
         RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
        RowBox[{"rarpTope", "@", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{
               InterpretationBox[
                StyleBox["f",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`f,
                Editable->False], "[", 
               InterpretationBox[
                StyleBox[
                 SubscriptBox["r", "peri"],
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`rperi,
                Editable->False], "]"}], " ", 
              RowBox[{"FK2", "[", 
               InterpretationBox[
                StyleBox[
                 SubscriptBox["r", "apo"],
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`rapo,
                Editable->False], "]"}]}], "-", 
             RowBox[{
              RowBox[{
               InterpretationBox[
                StyleBox["f",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`f,
                Editable->False], "[", 
               InterpretationBox[
                StyleBox[
                 SubscriptBox["r", "apo"],
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`rapo,
                Editable->False], "]"}], " ", 
              RowBox[{"FK2", "[", 
               InterpretationBox[
                StyleBox[
                 SubscriptBox["r", "peri"],
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`rperi,
                Editable->False], "]"}]}]}], 
            RowBox[{
             RowBox[{"FK2", "[", 
              InterpretationBox[
               StyleBox[
                SubscriptBox["r", "apo"],
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`rapo,
               Editable->False], "]"}], "-", 
             RowBox[{"FK2", "[", 
              InterpretationBox[
               StyleBox[
                SubscriptBox["r", "peri"],
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`rperi,
               Editable->False], "]"}]}]], "+", 
           FractionBox[
            RowBox[{"sp", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  InterpretationBox[
                   StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`f,
                   Editable->False], "[", 
                  InterpretationBox[
                   StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`rapo,
                   Editable->False], "]"}], "-", 
                 RowBox[{
                  InterpretationBox[
                   StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`f,
                   Editable->False], "[", 
                  InterpretationBox[
                   StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`rperi,
                   Editable->False], "]"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}], " ", 
                  RowBox[{"FK2", "[", 
                   InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{
                   InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                   InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}], " ", 
                  RowBox[{"FK2", "[", 
                   InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}]}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"FK2", "[", 
                  InterpretationBox[
                   StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`rperi,
                   Editable->False], "]"}]}], " ", 
                RowBox[{"FK3", "[", 
                 InterpretationBox[
                  StyleBox[
                   SubscriptBox["r", "apo"],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`rapo,
                  Editable->False], "]"}]}], "+", 
               RowBox[{
                RowBox[{"FK2", "[", 
                 InterpretationBox[
                  StyleBox[
                   SubscriptBox["r", "apo"],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`rapo,
                  Editable->False], "]"}], " ", 
                RowBox[{"FK3", "[", 
                 InterpretationBox[
                  StyleBox[
                   SubscriptBox["r", "peri"],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`rperi,
                  Editable->False], "]"}]}]}], ")"}]}], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FK2", "[", 
                InterpretationBox[
                 StyleBox[
                  SubscriptBox["r", "apo"],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`rapo,
                 Editable->False], "]"}], "-", 
               RowBox[{"FK2", "[", 
                InterpretationBox[
                 StyleBox[
                  SubscriptBox["r", "peri"],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`rperi,
                 Editable->False], "]"}]}], ")"}], "2"]]}], ")"}]}]}]}], ";", 
      "\n", 
      RowBox[{"\[ScriptCapitalJ]2Approxep", "=", 
       RowBox[{
        RowBox[{"ToSpacetime", "[", 
         RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
        RowBox[{"rarpTope", "@", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", 
              RowBox[{
               InterpretationBox[
                StyleBox["f",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`f,
                Editable->False], "[", 
               InterpretationBox[
                StyleBox[
                 SubscriptBox["r", "apo"],
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`rapo,
                Editable->False], "]"}]}], "+", 
             RowBox[{
              InterpretationBox[
               StyleBox["f",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`f,
               Editable->False], "[", 
              InterpretationBox[
               StyleBox[
                SubscriptBox["r", "peri"],
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`rperi,
               Editable->False], "]"}]}], 
            RowBox[{
             RowBox[{"FK2", "[", 
              InterpretationBox[
               StyleBox[
                SubscriptBox["r", "apo"],
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`rapo,
               Editable->False], "]"}], "-", 
             RowBox[{"FK2", "[", 
              InterpretationBox[
               StyleBox[
                SubscriptBox["r", "peri"],
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`rperi,
               Editable->False], "]"}]}]], "+", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"FK2", "[", 
                 InterpretationBox[
                  StyleBox[
                   SubscriptBox["r", "apo"],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`rapo,
                  Editable->False], "]"}], "-", 
                RowBox[{"FK2", "[", 
                 InterpretationBox[
                  StyleBox[
                   SubscriptBox["r", "peri"],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`rperi,
                  Editable->False], "]"}]}], ")"}], "2"]], "sp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SqrtBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}], "-", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}], " ", 
                    RowBox[{"FK2", "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}], " ", 
                    RowBox[{"FK2", "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}]}], ")"}]}]]}], " ", 
               RowBox[{"FK3", "[", 
                InterpretationBox[
                 StyleBox[
                  SubscriptBox["r", "apo"],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`rapo,
                 Editable->False], "]"}]}], "+", 
              RowBox[{
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}], "-", 
                   RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}], " ", 
                    RowBox[{"FK2", "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "apo"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rapo,
                    Editable->False], "]"}], " ", 
                    RowBox[{"FK2", "[", 
                    InterpretationBox[
                    StyleBox[
                    SubscriptBox["r", "peri"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`rperi,
                    Editable->False], "]"}]}]}], ")"}]}]], " ", 
               RowBox[{"FK3", "[", 
                InterpretationBox[
                 StyleBox[
                  SubscriptBox["r", "peri"],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`rperi,
                 Editable->False], "]"}]}]}], ")"}]}]}], ")"}]}]}]}], ";", 
      "\n", "\n", "\n", 
      RowBox[{"ReplaceSet", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ScriptCapitalE]", "2"], "->", 
          "\[ScriptCapitalE]2Approxep"}], ",", 
         RowBox[{
          SuperscriptBox["\[ScriptCapitalJ]", "2"], "->", 
          "\[ScriptCapitalJ]2Approxep"}], ",", 
         RowBox[{"\[ScriptCapitalE]", "->", 
          SqrtBox["\[ScriptCapitalE]2Approxep"]}], ",", 
         RowBox[{"\[ScriptCapitalJ]", "->", 
          SqrtBox["\[ScriptCapitalJ]2Approxep"]}]}], "}"}]}], ";", "\n", 
      RowBox[{"exp", "/.", "ReplaceSet"}]}]}], "]"}]}], ";"}]}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.9084857377038393`*^9, {3.908485874686912*^9, 3.908485885998928*^9}, {
   3.9084864735763316`*^9, 3.908486481303298*^9}, {3.908490256656141*^9, 
   3.908490256944333*^9}, 3.908501713407875*^9, 3.9085050602937193`*^9, {
   3.90850822532836*^9, 3.9085082650828*^9}, {3.908508305757358*^9, 
   3.908508342805661*^9}, 3.908589653080683*^9, {3.927690717298918*^9, 
   3.927690835645338*^9}, {3.92769108265082*^9, 3.927691086810728*^9}, {
   3.9404486134522057`*^9, 3.9404486134542255`*^9}, {3.940449740984272*^9, 
   3.940449748290357*^9}, {3.9408813477119837`*^9, 3.940881351928196*^9}, 
   3.940883246645443*^9, 3.9410785839181995`*^9, {3.9410786165160103`*^9, 
   3.9410786799276047`*^9}, {3.94108018823888*^9, 3.941080189347849*^9}, {
   3.9410802964419537`*^9, 3.941080435200268*^9}, {3.9410804664779015`*^9, 
   3.9410804974916267`*^9}, 3.9410805342006054`*^9, {3.941080658378338*^9, 
   3.941080692928625*^9}, 3.9410817770308285`*^9},
 CellLabel->
  "In[794]:=",ExpressionUUID->"524d892d-6097-3a4c-9d2e-6db40640d695"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"EJTope", "[", 
      RowBox[{"\"\<Spacetime\>\"", " ", "->", " ", "\"\<Brane\>\""}], "]"}], 
     "@", 
     RowBox[{"(", "\[ScriptCapitalE]", ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", "Infinity", ",", "3"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"EJTope", "[", 
      RowBox[{"\"\<Spacetime\>\"", " ", "->", " ", "\"\<Brane\>\""}], "]"}], 
     "@", 
     RowBox[{"(", "\[ScriptCapitalJ]", ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"p", ",", "Infinity", ",", "0"}], "}"}]}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.908829698608989*^9, 3.90882970030134*^9}, 
   3.908946270274201*^9, {3.910145023163182*^9, 3.910145033922153*^9}, {
   3.910145070369909*^9, 3.9101451230995445`*^9}, {3.910145163740844*^9, 
   3.910145165826324*^9}, {3.910145224861*^9, 3.910145232171449*^9}, {
   3.9101452681732397`*^9, 3.9101452752898107`*^9}, {3.910145350457277*^9, 
   3.910145363146184*^9}, {3.927690858457567*^9, 3.9276908713848705`*^9}, 
   3.940448636441576*^9, {3.940449762555033*^9, 3.9404497647306843`*^9}, {
   3.9410807992927246`*^9, 3.941080817321045*^9}, {3.9410808634715557`*^9, 
   3.9410808655962734`*^9}, {3.9410811148233223`*^9, 3.941081143297018*^9}, {
   3.941081181671709*^9, 3.941081226696501*^9}},
 CellLabel->
  "In[758]:=",ExpressionUUID->"37cafa0c-5aa4-a34f-8fff-41d0e6de2d40"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["e", "2"]}], 
    RowBox[{"2", " ", "p"}]], "+", 
   FractionBox[
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["e", "2"]}], ")"}], "2"]}], 
    RowBox[{"8", " ", 
     SuperscriptBox["p", "2"]}]], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["e", "2"]}], ")"}], "2"], " ", 
    InterpretationBox[
     StyleBox["sp",
      ShowAutoStyles->False,
      AutoSpacing->False],
     $CellContext`sp,
     Editable->False], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", "p"], ")"}], 
     RowBox[{"5", "/", "2"}]]}], "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "27"}], "+", 
       RowBox[{"16", " ", 
        InterpretationBox[
         StyleBox["b",
          ShowAutoStyles->False,
          AutoSpacing->False],
         $CellContext`b,
         Editable->False]}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["e", "2"]}], ")"}], "2"]}], 
    RowBox[{"16", " ", 
     SuperscriptBox["p", "3"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      FractionBox["1", "p"], "]"}], 
     RowBox[{"7", "/", "2"}]],
    SeriesData[$CellContext`p, 
     DirectedInfinity[1], {}, 0, 7, 2],
    Editable->False]}],
  SeriesData[$CellContext`p, 
   DirectedInfinity[1], {
   1, 0, Rational[1, 2] (-1 + $CellContext`e^2), 0, 
    Rational[3, 8] (-1 + $CellContext`e^2)^2, 
    Rational[1, 2] (-1 + $CellContext`e^2)^2 $CellContext`sp, 
    Rational[-1, 16] (-27 + 16 $CellContext`b - 
     5 $CellContext`e^2) (-1 + $CellContext`e^2)^2}, 0, 7, 2],
  Editable->False]], "Output",
 CellChangeTimes->{{3.941081221188507*^9, 3.9410812277311764`*^9}},
 CellLabel->
  "Out[758]=",ExpressionUUID->"7e69d5be-0ceb-e447-8d6b-3f9f7ab8fba3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   SqrtBox["p"], "-", 
   InterpretationBox[
    StyleBox["sp",
     ShowAutoStyles->False,
     AutoSpacing->False],
    $CellContext`sp,
    Editable->False], "+", 
   InterpretationBox[
    SqrtBox[
     RowBox[{"O", "[", 
      FractionBox["1", "p"], "]"}]],
    SeriesData[$CellContext`p, 
     DirectedInfinity[1], {}, -1, 1, 2],
    Editable->False]}],
  SeriesData[$CellContext`p, 
   DirectedInfinity[1], {1, -$CellContext`sp}, -1, 1, 2],
  Editable->False]], "Output",
 CellChangeTimes->{{3.941081221188507*^9, 3.9410812278582153`*^9}},
 CellLabel->
  "Out[759]=",ExpressionUUID->"5757b346-f233-0e43-a61c-d2d9ec883c29"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculation of Fluxes ", "Subsubsection",
 CellChangeTimes->{{3.908510434606323*^9, 3.908510441701831*^9}, {
  3.941079574664961*^9, 
  3.94107959513566*^9}},ExpressionUUID->"ce6060fb-34fd-1d48-a087-\
5838dde13273"],

Cell["Mark order symbol", "Text",
 CellChangeTimes->{{3.908567923560444*^9, 3.9085679269784346`*^9}, {
  3.9410796103104706`*^9, 
  3.9410796175180855`*^9}},ExpressionUUID->"aacbdb7d-171b-0146-aebf-\
6ced86e774c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefConstantSymbol", "[", 
   RowBox[{"OrderPN", ",", 
    RowBox[{
    "PrintAs", "\[Rule]", 
     "\"\<\!\(\*SubsuperscriptBox[\(h\), \(PN\), \(-1\)]\)\>\""}]}], "]"}], 
  ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.9085679193317375`*^9, {3.908831149745443*^9, 3.908831192325934*^9}, 
   3.941078791694454*^9},
 CellLabel->
  "In[683]:=",ExpressionUUID->"901a1e71-3426-a94e-8523-0038a5da8da6"],

Cell["Mark the lowest order", "Text",
 CellChangeTimes->{{3.908566420342014*^9, 3.9085664282070007`*^9}, 
   3.941079644997946*^9},ExpressionUUID->"cf56d72f-bed3-0641-a884-\
a56e697b4c4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Mark", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"exp0", "=", "exp"}], ",", "ReplaceSet"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"ReplaceSet", "=", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{"p", " ", "->", " ", 
          RowBox[{"OrderPN", " ", "p"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamD", "[", 
            RowBox[{"t", "[", "]"}], "]"}], "[", 
           RowBox[{
            RowBox[{"psi", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}], "]"}], " ", "->", " ", 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "3"}], "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{"t", "[", "]"}], "]"}], "[", 
            RowBox[{
             RowBox[{"psi", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamD", "[", 
            RowBox[{
             RowBox[{"t", "[", "]"}], ",", " ", 
             RowBox[{"t", "[", "]"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"psi", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}], "]"}], " ", "->", " ", 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "6"}], "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}]}], "]"}], "[", 
            RowBox[{
             RowBox[{"psi", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamD", "[", 
            RowBox[{
             RowBox[{"t", "[", "]"}], ",", " ", 
             RowBox[{"t", "[", "]"}], ",", " ", 
             RowBox[{"t", "[", "]"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"psi", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}], "]"}], " ", "->", " ", 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "9"}], "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}]}], "]"}], "[", 
            RowBox[{
             RowBox[{"psi", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", "]"}], "[", 
           RowBox[{"t", "[", "]"}], "]"}], "->", 
          RowBox[{"OrderPN", " ", 
           RowBox[{
            RowBox[{"r", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}]}]}], ",", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamD", "[", 
            RowBox[{"t", "[", "]"}], "]"}], "[", 
           RowBox[{
            RowBox[{"r", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}], "]"}], "->", 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{"t", "[", "]"}], "]"}], "[", 
            RowBox[{
             RowBox[{"r", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}], ",", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamD", "[", 
            RowBox[{
             RowBox[{"t", "[", "]"}], ",", " ", 
             RowBox[{"t", "[", "]"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"r", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}], "]"}], 
          StyleBox["->",
           ShowAutoStyles->False,
           AutoSpacing->False], 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "4"}], "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}]}], "]"}], "[", 
            RowBox[{
             RowBox[{"r", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}], ",", "\n", 
         RowBox[{
          StyleBox[
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}]}], "]"}], "[", 
            RowBox[{
             RowBox[{"r", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}],
           ShowAutoStyles->False,
           AutoSpacing->False], 
          StyleBox["->",
           ShowAutoStyles->False,
           AutoSpacing->False], 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "7"}], "/", "2"}]], 
           StyleBox[" ",
            ShowAutoStyles->False,
            AutoSpacing->False], 
           StyleBox[
            RowBox[{
             RowBox[{"ParamD", "[", 
              RowBox[{
               RowBox[{"t", "[", "]"}], ",", " ", 
               RowBox[{"t", "[", "]"}], ",", " ", 
               RowBox[{"t", "[", "]"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"r", "[", "]"}], "[", 
              RowBox[{"t", "[", "]"}], "]"}], "]"}],
            ShowAutoStyles->False,
            AutoSpacing->False]}]}], ",", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamD", "[", 
            RowBox[{"t", "[", "]"}], "]"}], "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}], "]"}], "->", 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "3"}], "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{"t", "[", "]"}], "]"}], "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}], ",", "\n", 
         RowBox[{
          StyleBox[
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}]}], "]"}], "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}],
           ShowAutoStyles->False,
           AutoSpacing->False], "->", 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "6"}], "/", "2"}]], " ", 
           StyleBox[
            RowBox[{
             RowBox[{"ParamD", "[", 
              RowBox[{
               RowBox[{"t", "[", "]"}], ",", " ", 
               RowBox[{"t", "[", "]"}]}], "]"}], "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "]"}], "[", 
              RowBox[{"t", "[", "]"}], "]"}], "]"}],
            ShowAutoStyles->False,
            AutoSpacing->False]}]}], ",", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"ParamD", "[", 
            RowBox[{
             RowBox[{"t", "[", "]"}], ",", " ", 
             RowBox[{"t", "[", "]"}], ",", " ", 
             RowBox[{"t", "[", "]"}]}], "]"}], "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "]"}], "[", 
            RowBox[{"t", "[", "]"}], "]"}], "]"}], "->", 
          RowBox[{
           SuperscriptBox["OrderPN", 
            RowBox[{
             RowBox[{"-", "9"}], "/", "2"}]], " ", 
           RowBox[{
            RowBox[{"ParamD", "[", 
             RowBox[{
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}], ",", " ", 
              RowBox[{"t", "[", "]"}]}], "]"}], "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "]"}], "[", 
             RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]}], "\n", "}"}]}], ";", 
      "\n", 
      RowBox[{"exp0", "/.", "ReplaceSet"}]}]}], "\n", "]"}]}], ";"}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.90856649068874*^9, 3.908566496299986*^9}, {
   3.908567605930918*^9, 3.908567611940647*^9}, {3.9085723726230073`*^9, 
   3.908572396963118*^9}, {3.9086080713213186`*^9, 3.908608074740714*^9}, 
   3.908830573882815*^9, {3.9088306924548235`*^9, 3.908830698977947*^9}, {
   3.908830732070107*^9, 3.90883076052166*^9}, {3.908831205301408*^9, 
   3.908831224109095*^9}, {3.940882065660843*^9, 3.940882072515923*^9}, 
   3.9410787892527466`*^9},
 CellLabel->
  "In[684]:=",ExpressionUUID->"ec19e06a-8929-c740-8c31-75566ccb4cfb"],

Cell["unmark", "Text",
 CellChangeTimes->{{3.908566443276084*^9, 3.908566447231447*^9}, {
  3.9410799951673946`*^9, 
  3.9410800174714584`*^9}},ExpressionUUID->"5f074242-7d0a-5545-b973-\
6e5332309b90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnMark", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"exp0", "=", "exp"}], ",", "ReplaceSet"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"ReplaceSet", "=", 
      RowBox[{"{", 
       RowBox[{"OrderPN", " ", "->", " ", "1"}], "}"}]}], ";", "\n", 
     RowBox[{"exp0", "/.", "ReplaceSet"}]}]}], "\n", "]"}]}]], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.908566474462041*^9, 3.908566480838132*^9}, {
   3.908566532562507*^9, 3.90856653625912*^9}, 3.908567613564972*^9, {
   3.908572378307247*^9, 3.9085723849577637`*^9}},
 CellLabel->
  "In[685]:=",ExpressionUUID->"34f53d7e-1849-384d-93b1-5c12c80e485b"],

Cell["Order judgment and expansion", "Text",
 CellChangeTimes->{{3.908566151413577*^9, 3.9085661591978807`*^9}, 
   3.941080042867605*^9},ExpressionUUID->"3fc7b50a-0d9d-3c45-a6e8-\
b1d1c1027112"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "OrderPNSeries", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<Mark\>\"", " ", "->", "\"\<Off\>\""}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"OrderPNSeries", "[", 
    RowBox[{"PN_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"exp0", "=", "exp"}], ",", 
      RowBox[{"PN0", "=", "PN"}], ",", "MarkOption", ",", "ReplaceSet"}], 
     "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"MarkOption", " ", "=", " ", 
      RowBox[{"OptionValue", "[", "\"\<Mark\>\"", "]"}]}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MarkOption", "==", "\"\<On\>\""}], ",", "\n", 
       RowBox[{"Return", "[", 
        RowBox[{"Normal", "@", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"Series", "[", 
            RowBox[{
             RowBox[{"Mark", "@", "exp0"}], ",", 
             RowBox[{"{", 
              RowBox[{"sp", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"OrderPN", ",", "Infinity", ",", "PN0"}], "}"}], ",", 
             RowBox[{"Assumptions", "->", 
              RowBox[{
               RowBox[{
                InterpretationBox[
                 StyleBox["OrderPN",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`OrderPN,
                 Editable->False], ">", "0"}], "&&", 
               RowBox[{"M", ">", "0"}], "&&", 
               RowBox[{"1", ">", "e", ">", "0"}], "&&", 
               RowBox[{"p", ">", "0"}]}]}]}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "-", 
              InterpretationBox[
               StyleBox["P",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`LQGPolymeric,
               Editable->False]}], ">", "0"}], "&&", 
            RowBox[{
             RowBox[{"1", "+", 
              InterpretationBox[
               StyleBox["P",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`LQGPolymeric,
               Editable->False]}], ">", "0"}], "&&", 
            StyleBox[
             RowBox[{"OrderPN", ">", "0"}],
             ShowAutoStyles->False,
             AutoSpacing->False], 
            StyleBox["&&",
             ShowAutoStyles->False,
             AutoSpacing->False], 
            RowBox[{"M", ">", "0"}], "&&", 
            RowBox[{"1", ">", "e", ">", "0"}], "&&", 
            RowBox[{"p", ">", "0"}], "&&", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["e", "2"]}], "<", "0"}]}]}], "]"}]}], "]"}]}], 
      "\n", "]"}], ";", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MarkOption", "==", "\"\<Off\>\""}], ",", "\n", 
       RowBox[{"Return", "[", 
        RowBox[{"UnMark", "@", 
         RowBox[{"Normal", "@", 
          RowBox[{"Simplify", "[", 
           RowBox[{
            RowBox[{"Series", "[", 
             RowBox[{
              RowBox[{"Mark", "@", "exp0"}], ",", 
              RowBox[{"{", 
               RowBox[{"sp", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"OrderPN", ",", "Infinity", ",", "PN0"}], "}"}], ",", 
              RowBox[{"Assumptions", "->", 
               RowBox[{
                RowBox[{
                 InterpretationBox[
                  StyleBox["OrderPN",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`OrderPN,
                  Editable->False], ">", "0"}], "&&", 
                RowBox[{"M", ">", "0"}], "&&", 
                RowBox[{"1", ">", "e", ">", "0"}], "&&", 
                RowBox[{"p", ">", "0"}]}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "-", 
               InterpretationBox[
                StyleBox["P",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`LQGPolymeric,
                Editable->False]}], ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"1", "+", 
               InterpretationBox[
                StyleBox["P",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`LQGPolymeric,
                Editable->False]}], ">", "0"}], "&&", 
             StyleBox[
              RowBox[{"OrderPN", ">", "0"}],
              ShowAutoStyles->False,
              AutoSpacing->False], 
             StyleBox["&&",
              ShowAutoStyles->False,
              AutoSpacing->False], 
             RowBox[{"M", ">", "0"}], "&&", 
             RowBox[{"1", ">", "e", ">", "0"}], "&&", 
             RowBox[{"p", ">", "0"}], "&&", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["e", "2"]}], "<", "0"}]}]}], "]"}]}]}], "]"}]}],
       "\n", "]"}], ";"}]}], "\n", "]"}]}], "\n"}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.908827720216336*^9, {3.909644602275504*^9, 3.909644605811644*^9}, {
   3.9101607042296724`*^9, 3.910160725712764*^9}, {3.910160969324421*^9, 
   3.910160985910451*^9}, 3.910161256405811*^9, {3.910161655405209*^9, 
   3.910161678566161*^9}, {3.927688118691027*^9, 3.9276881361028137`*^9}, {
   3.940880720005474*^9, 3.9408807675196476`*^9}, {3.9408817132170696`*^9, 
   3.940881722342669*^9}, {3.9409679126609764`*^9, 3.940967919417839*^9}},
 CellLabel->
  "In[686]:=",ExpressionUUID->"c15897bd-e240-1a41-8181-fe21a76fa367"],

Cell[CellGroupData[{

Cell[TextData[{
 "Reduces ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "r"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "f80c086b-fcaf-9c4e-8aa7-81f9f1217da7"],
 "[t]  to a function of e,p"
}], "Subsubsubsection",
 CellChangeTimes->{{3.908519917016912*^9, 3.908519970026346*^9}, {
  3.9410800506419067`*^9, 3.9410800561046143`*^9}, {3.941081372311178*^9, 
  3.9410814059601364`*^9}},ExpressionUUID->"376b6dde-8c16-2e4d-b6c0-\
d54e74391820"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "Conpsitp", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<Spacetime\>\"", " ", "->", "\"\<Schwarzschild\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Conpsitp", "[", 
     RowBox[{"n_", ",", "PN_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"exp0", "=", "exp"}], ",", 
       RowBox[{"PN0", "=", "PN"}], ",", 
       RowBox[{"n0", "=", "n"}], ",", "spacetime", ",", "Ft", ",", "Fpsi", 
       ",", "Fd\[Psi]dtPN", ",", "DFd\[Psi]dtPN", ",", "DDFd\[Psi]dtPN", ",", 
       "ReplaceSet"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"spacetime", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Spacetime\>\"", "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"SpacetimeSet", ",", "spacetime"}], "]"}]}], ",", " ", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Spacetime metric unknown, please select in \>\"", " ", "<>", 
          RowBox[{"ToString", "[", "SpacetimeSet", "]"}], "<>", " ", 
          "\"\<!\>\""}], "]"}]}], "]"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"SpacetimeSet", ",", "spacetime"}], "]"}], ",", "\n", 
        RowBox[{"(*", "\:8fd0\:52a8\:65b9\:7a0b", "*)"}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ft", "=", 
          RowBox[{
           RowBox[{"ParamExactBW", "[", 
            RowBox[{"sp", ",", "sn", ",", "e", ",", "p", ",", "b", ",", "M"}],
             "]"}], "@", 
           RowBox[{
            RowBox[{"ToSpacetime", "[", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
            RowBox[{
             RowBox[{"EJTope", "[", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
             StyleBox[
              RowBox[{"(", 
               RowBox[{
                FractionBox["\[ScriptCapitalE]", 
                 RowBox[{"f", "[", 
                  FractionBox["p", 
                   RowBox[{"1", "+", 
                    RowBox[{"e", "  ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}]], "+", 
                FractionBox[
                 RowBox[{"\[ScriptCapitalJ]", " ", 
                  RowBox[{
                   RowBox[{"f", "'"}], "[", 
                   FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}], " ", 
                  "sp"}], 
                 RowBox[{"2", " ", 
                  FractionBox["p", 
                   RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], " ", 
                  RowBox[{"f", "[", 
                   FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}]}]]}], 
               ")"}],
              FontColor->RGBColor[1, 0, 0]]}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Fpsi", "=", 
          RowBox[{
           RowBox[{"ParamExactBW", "[", 
            RowBox[{"sp", ",", "sn", ",", "e", ",", "p", ",", "b", ",", "M"}],
             "]"}], "@", 
           RowBox[{
            RowBox[{"ToSpacetime", "[", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
            RowBox[{
             RowBox[{"EJTope", "[", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
             RowBox[{"(", 
              RowBox[{
               StyleBox[
                FractionBox[
                 StyleBox["1",
                  FontColor->RGBColor[1, 0, 0]], "M"],
                FontColor->RGBColor[1, 0, 0]], " ", 
               StyleBox[
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}], ")"}], "2"], 
                   RowBox[{"e", " ", "p", " ", 
                    SqrtBox[
                    SuperscriptBox[
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Sin",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Sin,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}], "]"}], "2"]]}]], 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox[
                    InterpretationBox[
                    StyleBox["\[ScriptCapitalE]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[ScriptCapitalE],
                    Editable->False], "2"], "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    InterpretationBox[
                    StyleBox["\[ScriptCapitalJ]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[ScriptCapitalJ],
                    Editable->False], "2"], "+", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], ")"}], "2"]}],
                     ")"}], 
                    RowBox[{"f", "[", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], ")"}], "2"]], 
                    "+", 
                    FractionBox[
                    RowBox[{"sp", " ", 
                    InterpretationBox[
                    StyleBox["\[ScriptCapitalJ]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[ScriptCapitalJ],
                    Editable->False], " ", 
                    InterpretationBox[
                    StyleBox["\[ScriptCapitalE]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[ScriptCapitalE],
                    Editable->False], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    RowBox[{"f", "[", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}]}], "+", 
                    RowBox[{
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], " ", 
                    RowBox[{
                    SuperscriptBox[
                    InterpretationBox[
                    StyleBox["f",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`f,
                    Editable->False], "\[Prime]",
                    MultilineFunction->None], "[", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}]}]}], 
                    ")"}]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], ")"}], 
                    "2"]]}]]}], ")"}],
                FontColor->RGBColor[1, 0, 0]]}], 
              StyleBox[")",
               FontColor->RGBColor[1, 0, 0]]}]}]}]}]}], ";", "\n", 
         RowBox[{"(*", "\:7ea7\:6570\:5c55\:5f00\:6807\:8bb0", "*)"}], " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Fd\[Psi]dtPN", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               StyleBox[
                RowBox[{"exp0", ",", 
                 InterpretationBox[
                  StyleBox[
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  xAct`xTensor`ParamD[
                   $CellContext`t[]][
                   $CellContext`psi[][
                    $CellContext`t[]]],
                  Editable->False]}],
                ShowAutoStyles->False,
                AutoSpacing->False], "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               StyleBox[
                RowBox[{"exp0", ",", 
                 InterpretationBox[
                  StyleBox[
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  xAct`xTensor`ParamD[
                   $CellContext`t[], 
                   $CellContext`t[]][
                   $CellContext`psi[][
                    $CellContext`t[]]],
                  Editable->False]}],
                ShowAutoStyles->False,
                AutoSpacing->False], "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               StyleBox[
                RowBox[{"exp0", ",", 
                 InterpretationBox[
                  StyleBox[
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  xAct`xTensor`ParamD[
                   $CellContext`t[], 
                   $CellContext`t[], 
                   $CellContext`t[]][
                   $CellContext`psi[][
                    $CellContext`t[]]],
                  Editable->False]}],
                ShowAutoStyles->False,
                AutoSpacing->False], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Fd\[Psi]dtPN:\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"n0", "+", "1"}], "]"}]}], "]"}], ";", 
             RowBox[{
              RowBox[{"OrderPNSeries", "[", 
               RowBox[{"n0", "+", "1"}], "]"}], "[", 
              FractionBox[
               StyleBox["Fpsi",
                ShowAutoStyles->False,
                AutoSpacing->False], "Ft"], "]"}]}]}], "]"}]}], ";", " ", 
         "\n", 
         RowBox[{"DFd\[Psi]dtPN", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               StyleBox[
                RowBox[{"exp0", ",", 
                 InterpretationBox[
                  StyleBox[
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  xAct`xTensor`ParamD[
                   $CellContext`t[], 
                   $CellContext`t[]][
                   $CellContext`psi[][
                    $CellContext`t[]]],
                  Editable->False]}],
                ShowAutoStyles->False,
                AutoSpacing->False], "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               StyleBox[
                RowBox[{"exp0", ",", 
                 InterpretationBox[
                  StyleBox[
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  xAct`xTensor`ParamD[
                   $CellContext`t[], 
                   $CellContext`t[], 
                   $CellContext`t[]][
                   $CellContext`psi[][
                    $CellContext`t[]]],
                  Editable->False]}],
                ShowAutoStyles->False,
                AutoSpacing->False], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<DFd\[Psi]dtPN:\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"n0", "+", "2"}], "]"}]}], "]"}], ";", 
             RowBox[{
              RowBox[{"OrderPNSeries", "[", 
               RowBox[{"n0", "+", "2"}], "]"}], "[", 
              RowBox[{
               RowBox[{"ParamD", "[", 
                RowBox[{"t", "[", "]"}], "]"}], "[", "Fd\[Psi]dtPN", "]"}], 
              "]"}]}]}], "]"}]}], ";", "\n", 
         RowBox[{"DDFd\[Psi]dtPN", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              StyleBox[
               RowBox[{"exp0", ",", 
                InterpretationBox[
                 StyleBox[
                  RowBox[{
                   SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                   SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                   SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                   InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                   InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 xAct`xTensor`ParamD[
                  $CellContext`t[], 
                  $CellContext`t[], 
                  $CellContext`t[]][
                  $CellContext`psi[][
                   $CellContext`t[]]],
                 Editable->False]}],
               ShowAutoStyles->False,
               AutoSpacing->False], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<DDFd\[Psi]dtPN:\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"n0", "+", "4"}], "]"}]}], "]"}], ";", " ", 
             RowBox[{
              RowBox[{"OrderPNSeries", "[", 
               RowBox[{"n0", "+", "4"}], "]"}], "[", 
              RowBox[{
               RowBox[{"ParamD", "[", 
                RowBox[{"t", "[", "]"}], "]"}], "[", "DFd\[Psi]dtPN", "]"}], 
              "]"}]}]}], "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{
             "Fd\[Psi]dtPN", ",", "DFd\[Psi]dtPN", ",", "DDFd\[Psi]dtPN"}], 
             "}"}], "]"}], ";"}], "*)"}], " ", "\[IndentingNewLine]", 
         RowBox[{"ReplaceSet", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              InterpretationBox[
               StyleBox["r",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`r[],
               Editable->False], "[", 
              InterpretationBox[
               StyleBox["t",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`t[],
               Editable->False], "]"}], "\[Rule]", 
             FractionBox["p", 
              RowBox[{"1", "+", 
               RowBox[{"e", " ", 
                RowBox[{
                 InterpretationBox[
                  StyleBox["Cos",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  Cos,
                  Editable->False], "[", 
                 RowBox[{
                  InterpretationBox[
                   StyleBox[
                    SubscriptBox["\[Psi]", "r"],
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`psi[],
                   Editable->False], "[", 
                  InterpretationBox[
                   StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`t[],
                   Editable->False], "]"}], "]"}]}]}]]}], ",", "\n", 
            RowBox[{
             InterpretationBox[
              StyleBox[
               RowBox[{
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                InterpretationBox[
                 StyleBox[
                  SubscriptBox["\[Psi]", "r"],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`psi[],
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox["t",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`t[],
                 Editable->False], "]"}],
               ShowAutoStyles->False,
               AutoSpacing->False],
              xAct`xTensor`ParamD[
               $CellContext`t[]][
               $CellContext`psi[][
                $CellContext`t[]]],
              Editable->False], "\[Rule]", "Fd\[Psi]dtPN"}], ",", "\n", 
            RowBox[{
             InterpretationBox[
              StyleBox[
               RowBox[{
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                InterpretationBox[
                 StyleBox[
                  SubscriptBox["\[Psi]", "r"],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`psi[],
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox["t",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`t[],
                 Editable->False], "]"}],
               ShowAutoStyles->False,
               AutoSpacing->False],
              xAct`xTensor`ParamD[
               $CellContext`t[], 
               $CellContext`t[]][
               $CellContext`psi[][
                $CellContext`t[]]],
              Editable->False], "\[Rule]", "DFd\[Psi]dtPN"}], ",", "\n", 
            RowBox[{
             InterpretationBox[
              StyleBox[
               RowBox[{
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                InterpretationBox[
                 StyleBox[
                  SubscriptBox["\[Psi]", "r"],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`psi[],
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox["t",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`t[],
                 Editable->False], "]"}],
               ShowAutoStyles->False,
               AutoSpacing->False],
              xAct`xTensor`ParamD[
               $CellContext`t[], 
               $CellContext`t[], 
               $CellContext`t[]][
               $CellContext`psi[][
                $CellContext`t[]]],
              Editable->False], "\[Rule]", "DDFd\[Psi]dtPN"}]}], "}"}]}], " ",
          ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"OrderPNSeries", "[", "PN0", "]"}], "[", 
           RowBox[{"exp", "/.", "ReplaceSet"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "]"}]}], ";"}]}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.908510445524377*^9, {3.9085220364343014`*^9, 3.908522040016029*^9}, {
   3.908525346031039*^9, 3.908525372432298*^9}, {3.908526396864671*^9, 
   3.908526474198812*^9}, {3.908526865364509*^9, 3.9085269807091293`*^9}, {
   3.9085271190429845`*^9, 3.9085271232577705`*^9}, {3.908529180581025*^9, 
   3.908529182280731*^9}, {3.908530300981998*^9, 3.908530400344124*^9}, {
   3.908564569815877*^9, 3.908564613828644*^9}, {3.908564795813517*^9, 
   3.908564816884497*^9}, 3.9085649278007536`*^9, {3.908564970081641*^9, 
   3.9085649905270004`*^9}, {3.9085650477155285`*^9, 3.908565058424945*^9}, 
   3.9085661058162117`*^9, {3.908569168430297*^9, 3.908569316522151*^9}, {
   3.908570028360426*^9, 3.908570098290452*^9}, 3.908570142021724*^9, {
   3.9085704172580433`*^9, 3.9085704208761997`*^9}, {3.908570455413915*^9, 
   3.9085704803652525`*^9}, {3.9085709922393293`*^9, 3.90857103905239*^9}, {
   3.908571073180114*^9, 3.908571082915099*^9}, {3.9085711563399286`*^9, 
   3.908571213749447*^9}, {3.9085714922087936`*^9, 3.908571496560444*^9}, {
   3.908574616693729*^9, 3.908574632186723*^9}, {3.908574791948976*^9, 
   3.908574799731312*^9}, {3.908589827442233*^9, 3.908589828995359*^9}, {
   3.908605157272683*^9, 3.908605162612474*^9}, {3.908615114717953*^9, 
   3.908615163668435*^9}, {3.908615639148442*^9, 3.9086156758800793`*^9}, 
   3.908615738991972*^9, {3.908616585885924*^9, 3.9086165908784666`*^9}, {
   3.908828876844515*^9, 3.908828895241205*^9}, {3.908830783956396*^9, 
   3.908830789204259*^9}, {3.909643603220443*^9, 3.9096436209238186`*^9}, {
   3.90964432799864*^9, 3.909644331819426*^9}, {3.909644573638753*^9, 
   3.9096445758431168`*^9}, {3.910159219139759*^9, 3.910159261230663*^9}, {
   3.910159297602873*^9, 3.910159343125083*^9}, {3.9101604256015778`*^9, 
   3.9101604298436337`*^9}, {3.910160568458084*^9, 3.9101605733350058`*^9}, {
   3.910161072491695*^9, 3.910161082156791*^9}, 3.910161124202602*^9, {
   3.9101611756621184`*^9, 3.9101612445344276`*^9}, {3.9101613213190594`*^9, 
   3.9101613515545382`*^9}, {3.927691409437502*^9, 3.9276914121850815`*^9}, {
   3.9404488459075336`*^9, 3.9404488614600677`*^9}, {3.9408801165276203`*^9, 
   3.940880141688364*^9}, {3.9408805328017845`*^9, 3.940880556651552*^9}, {
   3.940880643955227*^9, 3.940880656385401*^9}, {3.940880903998035*^9, 
   3.9408809340113277`*^9}, {3.9408814027245026`*^9, 3.940881404805647*^9}, {
   3.9408819202849903`*^9, 3.940881940989817*^9}, {3.940882384818218*^9, 
   3.9408823984259205`*^9}, {3.9408826120943546`*^9, 3.940882620732607*^9}, {
   3.940926264323883*^9, 3.940926292837096*^9}, {3.941054681923145*^9, 
   3.941054690993721*^9}, {3.941081274462736*^9, 3.9410812868609343`*^9}, {
   3.94108133852882*^9, 3.9410813464813566`*^9}, {3.941081580880287*^9, 
   3.941081582267769*^9}, {3.941083561060379*^9, 3.941083600555715*^9}, {
   3.941318435008299*^9, 3.9413184392171*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"624f3a73-85e6-6c41-99df-a61442d3ab48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Reduce r, \[Phi] function to ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "r"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "8ddf1091-0b8b-cd46-994b-578c52dd20e4"],
 " function"
}], "Subsubsubsection",
 CellChangeTimes->{
  3.908530265551565*^9, {3.9410814272183113`*^9, 
   3.9410814307004967`*^9}},ExpressionUUID->"c4085ce1-7011-e647-88cf-\
837bd544e353"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ConrtphitTopsit", "]"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\"\<Spacetime\>\"", " ", "->", "\"\<Schwarzschild\>\""}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConrtphitTopsit", "[", 
     RowBox[{"n_", ",", "PN_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"exp0", "=", "exp"}], ",", 
       RowBox[{"PN0", "=", "PN"}], ",", 
       RowBox[{"n0", "=", "n"}], ",", "spacetime", ",", "dphidt0", ",", 
       "dphidt", ",", "Ddphidt", ",", "DDdphidt", ",", "ReplaceSet"}], "}"}], 
     ",", "\n", 
     RowBox[{
      RowBox[{"spacetime", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Spacetime\>\"", "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"SpacetimeSet", ",", "spacetime"}], "]"}]}], ",", " ", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Spacetime metric unknown, please select in \>\"", " ", "<>", 
          RowBox[{"ToString", "[", "SpacetimeSet", "]"}], "<>", " ", 
          "\"\<!\>\""}], "]"}]}], "]"}], ";", "\n", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"SpacetimeSet", ",", "spacetime"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dphidt0", "=", " ", 
          RowBox[{
           RowBox[{"ParamExactBW", "[", 
            RowBox[{"sp", ",", "sn", ",", "e", ",", "p", ",", "b", ",", "M"}],
             "]"}], "@", 
           RowBox[{
            RowBox[{"ToSpacetime", "[", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
            RowBox[{
             RowBox[{"EJTope", "[", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}], "]"}], "@", 
             RowBox[{"(", 
              StyleBox[
               RowBox[{
                FractionBox[
                 StyleBox["1",
                  FontColor->RGBColor[1, 0, 0]], "M"], 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    InterpretationBox[
                    StyleBox["\[ScriptCapitalJ]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[ScriptCapitalJ],
                    Editable->False], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], ")"}], "2"]], 
                   "+", " ", 
                   FractionBox[
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[ScriptCapitalE]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[ScriptCapitalE],
                    Editable->False], " ", "sp"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], ")"}], 
                    "2"]]}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["\[ScriptCapitalE]", 
                    RowBox[{"f", "[", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}]], "+", 
                   FractionBox[
                    RowBox[{"\[ScriptCapitalJ]", " ", 
                    RowBox[{
                    RowBox[{"f", "'"}], "[", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}], " ", 
                    "sp"}], 
                    RowBox[{"2", " ", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], " ", 
                    RowBox[{"f", "[", 
                    FractionBox["p", 
                    RowBox[{"1", "+", 
                    RowBox[{"e", " ", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["Cos",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    Cos,
                    Editable->False], "[", 
                    RowBox[{
                    InterpretationBox[
                    StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`psi[],
                    Editable->False], "[", 
                    RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]], "]"}]}]]}], 
                  ")"}]}]}],
               FontColor->RGBColor[1, 0, 0]], 
              StyleBox[")",
               FontColor->RGBColor[1, 0, 0]]}]}]}]}]}], 
         StyleBox[";",
          FontColor->RGBColor[1, 0, 0]], "\[IndentingNewLine]", 
         RowBox[{"(*", "\:7ea7\:6570\:5c55\:5f00\:6807\:8bb0", "*)"}], " ", 
         "\[IndentingNewLine]", 
         RowBox[{"dphidt", "=", 
          RowBox[{
           RowBox[{"OrderPNSeries", "[", 
            RowBox[{
             RowBox[{"n0", "+", "1"}], ",", 
             RowBox[{"\"\<Mark\>\"", " ", "->", "\"\<Off\>\""}]}], "]"}], "[",
            "dphidt0", "]"}]}], ";", "\n", 
         RowBox[{"Ddphidt", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               StyleBox[
                RowBox[{"exp0", ",", 
                 InterpretationBox[
                  StyleBox[
                   RowBox[{
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                    InterpretationBox[
                    StyleBox["\[Phi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[Phi][],
                    Editable->False], "[", 
                    InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  xAct`xTensor`ParamD[
                   $CellContext`t[], 
                   $CellContext`t[]][
                   $CellContext`\[Phi][][
                    $CellContext`t[]]],
                  Editable->False]}],
                ShowAutoStyles->False,
                AutoSpacing->False], "]"}]}], "||", 
             RowBox[{"!", 
              RowBox[{"FreeQ", "[", 
               RowBox[{"exp0", ",", 
                InterpretationBox[
                 StyleBox[
                  RowBox[{
                   SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                   SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                   SubscriptBox["\[PartialD]", 
                    RowBox[{"t", "[", "]"}]], 
                   InterpretationBox[
                    StyleBox["\[Phi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`\[Phi][],
                    Editable->False], "[", 
                   InterpretationBox[
                    StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                    $CellContext`t[],
                    Editable->False], "]"}],
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 xAct`xTensor`ParamD[
                  $CellContext`t[], 
                  $CellContext`t[], 
                  $CellContext`t[]][
                  $CellContext`\[Phi][][
                   $CellContext`t[]]],
                 Editable->False]}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"OrderPNSeries", "[", 
              RowBox[{
               RowBox[{"n0", "+", "2"}], ",", 
               RowBox[{"\"\<Mark\>\"", " ", "->", "\"\<Off\>\""}]}], "]"}], 
             "[", 
             RowBox[{
              RowBox[{"ParamD", "[", 
               RowBox[{"t", "[", "]"}], "]"}], "[", "dphidt", "]"}], "]"}]}], 
           "]"}]}], ";", "\n", 
         RowBox[{"DDdphidt", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"exp0", ",", 
               InterpretationBox[
                StyleBox[
                 RowBox[{
                  SubscriptBox["\[PartialD]", 
                   RowBox[{"t", "[", "]"}]], 
                  SubscriptBox["\[PartialD]", 
                   RowBox[{"t", "[", "]"}]], 
                  SubscriptBox["\[PartialD]", 
                   RowBox[{"t", "[", "]"}]], 
                  InterpretationBox[
                   StyleBox["\[Phi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`\[Phi][],
                   Editable->False], "[", 
                  InterpretationBox[
                   StyleBox["t",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`t[],
                   Editable->False], "]"}],
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                xAct`xTensor`ParamD[
                 $CellContext`t[], 
                 $CellContext`t[], 
                 $CellContext`t[]][
                 $CellContext`\[Phi][][
                  $CellContext`t[]]],
                Editable->False]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"OrderPNSeries", "[", 
              RowBox[{
               RowBox[{"n0", "+", "4"}], ",", 
               RowBox[{"\"\<Mark\>\"", " ", "->", "\"\<Off\>\""}]}], "]"}], 
             "[", 
             RowBox[{
              RowBox[{"ParamD", "[", 
               RowBox[{"t", "[", "]"}], "]"}], "[", "Ddphidt", "]"}], "]"}]}],
            "]"}]}], ";", "\n", 
         RowBox[{"ReplaceSet", "=", 
          RowBox[{"{", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             InterpretationBox[
              StyleBox[
               RowBox[{
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                InterpretationBox[
                 StyleBox["\[Phi]",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`\[Phi][],
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox["t",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`t[],
                 Editable->False], "]"}],
               ShowAutoStyles->False,
               AutoSpacing->False],
              xAct`xTensor`ParamD[
               $CellContext`t[]][
               $CellContext`\[Phi][][
                $CellContext`t[]]],
              Editable->False], "->", "dphidt"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             StyleBox[
              InterpretationBox[
               StyleBox[
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 InterpretationBox[
                  StyleBox["\[Phi]",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`\[Phi][],
                  Editable->False], "[", 
                 InterpretationBox[
                  StyleBox["t",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`t[],
                  Editable->False], "]"}],
                ShowAutoStyles->False,
                AutoSpacing->False],
               xAct`xTensor`ParamD[
                $CellContext`t[], 
                $CellContext`t[]][
                $CellContext`\[Phi][][
                 $CellContext`t[]]],
               Editable->False],
              ShowAutoStyles->False,
              AutoSpacing->False], "->", "Ddphidt"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             InterpretationBox[
              StyleBox[
               RowBox[{
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                SubscriptBox["\[PartialD]", 
                 RowBox[{"t", "[", "]"}]], 
                InterpretationBox[
                 StyleBox["\[Phi]",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`\[Phi][],
                 Editable->False], "[", 
                InterpretationBox[
                 StyleBox["t",
                  ShowAutoStyles->False,
                  AutoSpacing->False],
                 $CellContext`t[],
                 Editable->False], "]"}],
               ShowAutoStyles->False,
               AutoSpacing->False],
              xAct`xTensor`ParamD[
               $CellContext`t[], 
               $CellContext`t[], 
               $CellContext`t[]][
               $CellContext`\[Phi][][
                $CellContext`t[]]],
              Editable->False], "->", "DDdphidt"}], ",", "\n", 
            RowBox[{
             RowBox[{
              InterpretationBox[
               StyleBox["r",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`r[],
               Editable->False], "[", 
              InterpretationBox[
               StyleBox["t",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`t[],
               Editable->False], "]"}], "\[Rule]", 
             FractionBox["p", 
              RowBox[{"1", "+", 
               RowBox[{"e", " ", 
                RowBox[{
                 InterpretationBox[
                  StyleBox["Cos",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  Cos,
                  Editable->False], "[", 
                 RowBox[{
                  InterpretationBox[
                   StyleBox["\[Psi]",
                    ShowAutoStyles->False,
                    AutoSpacing->False],
                   $CellContext`psi[],
                   Editable->False], "[", 
                  RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]]}]}], 
           "\[IndentingNewLine]", "}"}]}], ";", "\n", 
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"OrderPNSeries", "[", 
            RowBox[{"PN0", ",", 
             RowBox[{"\"\<Mark\>\"", " ", "->", "\"\<Off\>\""}]}], "]"}], "[", 
           RowBox[{"exp", "/.", "ReplaceSet"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}], "\n"}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.9085198959775295`*^9, {3.908525253539817*^9, 3.908525269187691*^9}, {
   3.9085253090837317`*^9, 3.908525326463951*^9}, {3.908526508986006*^9, 
   3.9085265107141895`*^9}, {3.908526716743094*^9, 3.908526723442992*^9}, {
   3.908527509491414*^9, 3.9085275122476892`*^9}, {3.908527681644976*^9, 
   3.908527686882326*^9}, {3.9085280270252943`*^9, 3.908528030211984*^9}, {
   3.908528982051667*^9, 3.908529080308437*^9}, {3.908529794226193*^9, 
   3.908529911162337*^9}, {3.908529946318101*^9, 3.908529964845948*^9}, {
   3.90853007179153*^9, 3.908530106524004*^9}, {3.908571719639813*^9, 
   3.908571745621629*^9}, {3.908571794044411*^9, 3.908571795784084*^9}, {
   3.908571831046999*^9, 3.908571970287119*^9}, {3.908572021864204*^9, 
   3.908572117353856*^9}, {3.908573715942492*^9, 3.908573717811239*^9}, {
   3.908573820827586*^9, 3.908573823508079*^9}, 3.908573964875105*^9, {
   3.908574028421905*^9, 3.908574032933325*^9}, {3.908574232244663*^9, 
   3.9085742349351654`*^9}, {3.908574306022084*^9, 3.908574328639203*^9}, {
   3.9085746567687955`*^9, 3.908574666754906*^9}, {3.908574756723808*^9, 
   3.908574784565938*^9}, {3.908589872897588*^9, 3.908589874339464*^9}, {
   3.908606735198592*^9, 3.9086067782459*^9}, {3.908607452581589*^9, 
   3.908607475815152*^9}, {3.908615033316231*^9, 3.908615063498662*^9}, {
   3.908615484620916*^9, 3.908615510713211*^9}, {3.908615564060055*^9, 
   3.908615602808319*^9}, {3.908615871420299*^9, 3.908615877110291*^9}, {
   3.9086159276891365`*^9, 3.9086159529667683`*^9}, {3.908616012648285*^9, 
   3.908616027085211*^9}, {3.908616084029375*^9, 3.908616113797879*^9}, {
   3.908616241064595*^9, 3.9086162950333347`*^9}, {3.908616365519628*^9, 
   3.9086164076068325`*^9}, {3.908616442209918*^9, 3.908616444132027*^9}, {
   3.908616480818066*^9, 3.908616483018224*^9}, {3.908828915974903*^9, 
   3.908828937736213*^9}, {3.908831245664935*^9, 3.908831245668494*^9}, {
   3.91015935973439*^9, 3.910159493249544*^9}, {3.940883455931504*^9, 
   3.940883459377074*^9}, {3.94088361166244*^9, 3.940883639956297*^9}, {
   3.940885023138519*^9, 3.940885033841688*^9}, {3.9408851822528725`*^9, 
   3.940885194467201*^9}, {3.94088524733807*^9, 3.940885290098545*^9}, {
   3.9409240779094133`*^9, 3.940924098258599*^9}, 3.9409245650198956`*^9, 
   3.9409264631718197`*^9, 3.9409271786057014`*^9, 3.940967270364729*^9, 
   3.941081587005188*^9, {3.941083657163618*^9, 3.9410836659467735`*^9}, 
   3.941091882893336*^9, {3.941318508246441*^9, 3.941318508250147*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"8a06f996-d29c-f740-adeb-8624069f2093"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fluxes approximation results ", "Subsubsubsection",
 CellChangeTimes->{
  3.908530265551565*^9, {3.9410814272183113`*^9, 3.9410814307004967`*^9}, {
   3.9410814757011623`*^9, 3.9410814959087563`*^9}, {3.9410841339962845`*^9, 
   3.9410841373230515`*^9}},ExpressionUUID->"00871f84-99c8-b64f-8d53-\
3f2c4af986c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ConrtphitApprox", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<Spacetime\>\"", " ", "->", "\"\<Schwarzschild\>\""}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConrtphitApprox", "[", 
     RowBox[{"n_", ",", "PN_", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"exp0", "=", "exp"}], ",", 
       RowBox[{"PN0", "=", "PN"}], ",", 
       RowBox[{"n0", "=", "n"}], ",", "spacetime", ",", "eqdr", ",", "eqd2r", 
       ",", "eqd3r", ",", "eqd\[Phi]", ",", "eqd2\[Phi]", ",", "eqd3\[Phi]", 
       ",", "ReplaceSet"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"spacetime", " ", "=", " ", 
       RowBox[{"OptionValue", "[", "\"\<Spacetime\>\"", "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          StyleBox[
           RowBox[{"exp0", ",", 
            InterpretationBox[
             StyleBox[
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               InterpretationBox[
                StyleBox["r",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`r[],
                Editable->False], "[", 
               InterpretationBox[
                StyleBox["t",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`t[],
                Editable->False], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False],
             xAct`xTensor`ParamD[
              $CellContext`t[]][
              $CellContext`r[][
               $CellContext`t[]]],
             Editable->False]}],
           ShowAutoStyles->False,
           AutoSpacing->False], "]"}]}], ",", 
        RowBox[{"eqdr", "=", 
         RowBox[{
          RowBox[{"Conpsitp", "[", 
           RowBox[{"n0", ",", "PN0", ",", 
            RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
          RowBox[{
           RowBox[{"Conpsitp", "[", 
            RowBox[{"n0", ",", "PN0", ",", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
           RowBox[{
            RowBox[{"Conpsitp", "[", 
             RowBox[{"n0", ",", "PN0", ",", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
            RowBox[{
             RowBox[{"ConrtphitTopsit", "[", 
              RowBox[{"n0", ",", "PN0", ",", 
               RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "[", 
             StyleBox[
              InterpretationBox[
               StyleBox[
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 InterpretationBox[
                  StyleBox["r",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`r[],
                  Editable->False], "[", 
                 InterpretationBox[
                  StyleBox["t",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`t[],
                  Editable->False], "]"}],
                ShowAutoStyles->False,
                AutoSpacing->False],
               xAct`xTensor`ParamD[
                $CellContext`t[]][
                $CellContext`r[][
                 $CellContext`t[]]],
               Editable->False],
              ShowAutoStyles->False,
              AutoSpacing->False], "]"}]}]}]}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          StyleBox[
           RowBox[{"exp0", ",", 
            InterpretationBox[
             StyleBox[
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               InterpretationBox[
                StyleBox["r",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`r[],
                Editable->False], "[", 
               InterpretationBox[
                StyleBox["t",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`t[],
                Editable->False], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False],
             xAct`xTensor`ParamD[
              $CellContext`t[], 
              $CellContext`t[]][
              $CellContext`r[][
               $CellContext`t[]]],
             Editable->False]}],
           ShowAutoStyles->False,
           AutoSpacing->False], "]"}]}], ",", 
        RowBox[{"eqd2r", "=", 
         RowBox[{
          RowBox[{"Conpsitp", "[", 
           RowBox[{"n0", ",", "PN0", ",", 
            RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
          RowBox[{
           RowBox[{"Conpsitp", "[", 
            RowBox[{"n0", ",", "PN0", ",", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
           RowBox[{
            RowBox[{"Conpsitp", "[", 
             RowBox[{"n0", ",", "PN0", ",", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
            RowBox[{
             RowBox[{"ConrtphitTopsit", "[", 
              RowBox[{"n0", ",", "PN0", ",", 
               RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "[", 
             StyleBox[
              InterpretationBox[
               StyleBox[
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 InterpretationBox[
                  StyleBox["r",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`r[],
                  Editable->False], "[", 
                 InterpretationBox[
                  StyleBox["t",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`t[],
                  Editable->False], "]"}],
                ShowAutoStyles->False,
                AutoSpacing->False],
               xAct`xTensor`ParamD[
                $CellContext`t[], 
                $CellContext`t[]][
                $CellContext`r[][
                 $CellContext`t[]]],
               Editable->False],
              ShowAutoStyles->False,
              AutoSpacing->False], "]"}]}]}]}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          StyleBox[
           RowBox[{"exp0", ",", 
            InterpretationBox[
             StyleBox[
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               InterpretationBox[
                StyleBox["r",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`r[],
                Editable->False], "[", 
               InterpretationBox[
                StyleBox["t",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`t[],
                Editable->False], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False],
             xAct`xTensor`ParamD[
              $CellContext`t[], 
              $CellContext`t[], 
              $CellContext`t[]][
              $CellContext`r[][
               $CellContext`t[]]],
             Editable->False]}],
           ShowAutoStyles->False,
           AutoSpacing->False], "]"}]}], ",", 
        RowBox[{"eqd3r", "=", 
         RowBox[{
          RowBox[{"Conpsitp", "[", 
           RowBox[{"n0", ",", "PN0", ",", 
            RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
          RowBox[{
           RowBox[{"Conpsitp", "[", 
            RowBox[{"n0", ",", "PN0", ",", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
           RowBox[{
            RowBox[{"Conpsitp", "[", 
             RowBox[{"n0", ",", "PN0", ",", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
            RowBox[{
             RowBox[{"ConrtphitTopsit", "[", 
              RowBox[{"n0", ",", "PN0", ",", 
               RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "[", 
             StyleBox[
              InterpretationBox[
               StyleBox[
                RowBox[{
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 SubscriptBox["\[PartialD]", 
                  RowBox[{"t", "[", "]"}]], 
                 InterpretationBox[
                  StyleBox["r",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`r[],
                  Editable->False], "[", 
                 InterpretationBox[
                  StyleBox["t",
                   ShowAutoStyles->False,
                   AutoSpacing->False],
                  $CellContext`t[],
                  Editable->False], "]"}],
                ShowAutoStyles->False,
                AutoSpacing->False],
               xAct`xTensor`ParamD[
                $CellContext`t[], 
                $CellContext`t[], 
                $CellContext`t[]][
                $CellContext`r[][
                 $CellContext`t[]]],
               Editable->False],
              ShowAutoStyles->False,
              AutoSpacing->False], "]"}]}]}]}]}]}], "]"}], ";", " ", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          StyleBox[
           RowBox[{"exp0", ",", 
            InterpretationBox[
             StyleBox[
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               InterpretationBox[
                StyleBox["\[Phi]",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`\[Phi][],
                Editable->False], "[", 
               InterpretationBox[
                StyleBox["t",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`t[],
                Editable->False], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False],
             xAct`xTensor`ParamD[
              $CellContext`t[]][
              $CellContext`\[Phi][][
               $CellContext`t[]]],
             Editable->False]}],
           ShowAutoStyles->False,
           AutoSpacing->False], "]"}]}], ",", 
        RowBox[{"eqd\[Phi]", "=", 
         RowBox[{
          RowBox[{"Conpsitp", "[", 
           RowBox[{"n0", ",", "PN0", ",", 
            RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
          RowBox[{
           RowBox[{"Conpsitp", "[", 
            RowBox[{"n0", ",", "PN0", ",", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
           RowBox[{
            RowBox[{"Conpsitp", "[", 
             RowBox[{"n0", ",", "PN0", ",", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
            RowBox[{
             RowBox[{"ConrtphitTopsit", "[", 
              RowBox[{"n0", ",", "PN0", ",", 
               RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "[", 
             StyleBox[
              RowBox[{
               RowBox[{"ParamD", "[", 
                RowBox[{"t", "[", "]"}], "]"}], "[", 
               RowBox[{
                RowBox[{"\[Phi]", "[", "]"}], "[", 
                RowBox[{"t", "[", "]"}], "]"}], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False], "]"}]}]}]}]}]}], "]"}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          StyleBox[
           RowBox[{"exp0", ",", 
            InterpretationBox[
             StyleBox[
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               InterpretationBox[
                StyleBox["\[Phi]",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`\[Phi][],
                Editable->False], "[", 
               InterpretationBox[
                StyleBox["t",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`t[],
                Editable->False], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False],
             xAct`xTensor`ParamD[
              $CellContext`t[], 
              $CellContext`t[]][
              $CellContext`\[Phi][][
               $CellContext`t[]]],
             Editable->False]}],
           ShowAutoStyles->False,
           AutoSpacing->False], "]"}]}], ",", 
        RowBox[{"eqd2\[Phi]", "=", 
         RowBox[{
          RowBox[{"Conpsitp", "[", 
           RowBox[{"n0", ",", "PN0", ",", 
            RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
          RowBox[{
           RowBox[{"Conpsitp", "[", 
            RowBox[{"n0", ",", "PN0", ",", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
           RowBox[{
            RowBox[{"Conpsitp", "[", 
             RowBox[{"n0", ",", "PN0", ",", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
            RowBox[{
             RowBox[{"ConrtphitTopsit", "[", 
              RowBox[{"n0", ",", "PN0", ",", 
               RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "[", 
             StyleBox[
              RowBox[{
               RowBox[{"ParamD", "[", 
                RowBox[{
                 RowBox[{"t", "[", "]"}], ",", 
                 RowBox[{"t", "[", "]"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"\[Phi]", "[", "]"}], "[", 
                RowBox[{"t", "[", "]"}], "]"}], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False], "]"}]}]}]}]}]}], "]"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          StyleBox[
           RowBox[{"exp0", ",", 
            InterpretationBox[
             StyleBox[
              RowBox[{
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               SubscriptBox["\[PartialD]", 
                RowBox[{"t", "[", "]"}]], 
               InterpretationBox[
                StyleBox["\[Phi]",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`\[Phi][],
                Editable->False], "[", 
               InterpretationBox[
                StyleBox["t",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`t[],
                Editable->False], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False],
             xAct`xTensor`ParamD[
              $CellContext`t[], 
              $CellContext`t[], 
              $CellContext`t[]][
              $CellContext`\[Phi][][
               $CellContext`t[]]],
             Editable->False]}],
           ShowAutoStyles->False,
           AutoSpacing->False], "]"}]}], ",", 
        RowBox[{"eqd3\[Phi]", "=", 
         RowBox[{
          RowBox[{"Conpsitp", "[", 
           RowBox[{"n0", ",", "PN0", ",", 
            RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
          RowBox[{
           RowBox[{"Conpsitp", "[", 
            RowBox[{"n0", ",", "PN0", ",", 
             RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
           RowBox[{
            RowBox[{"Conpsitp", "[", 
             RowBox[{"n0", ",", "PN0", ",", 
              RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "@", 
            RowBox[{
             RowBox[{"ConrtphitTopsit", "[", 
              RowBox[{"n0", ",", "PN0", ",", 
               RowBox[{"\"\<Spacetime\>\"", "->", "spacetime"}]}], "]"}], "[", 
             StyleBox[
              RowBox[{
               RowBox[{"ParamD", "[", 
                RowBox[{
                 RowBox[{"t", "[", "]"}], ",", 
                 RowBox[{"t", "[", "]"}], ",", 
                 RowBox[{"t", "[", "]"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"\[Phi]", "[", "]"}], "[", 
                RowBox[{"t", "[", "]"}], "]"}], "]"}],
              ShowAutoStyles->False,
              AutoSpacing->False], "]"}]}]}]}]}]}], "]"}], ";", " ", "\n", 
      "\n", "\n", "\n", 
      RowBox[{"ReplaceSet", "=", 
       RowBox[{"{", "\n", 
        RowBox[{
         RowBox[{
          InterpretationBox[
           StyleBox[
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"t", "[", "]"}]], 
             InterpretationBox[
              StyleBox["\[Phi]",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`\[Phi][],
              Editable->False], "[", 
             InterpretationBox[
              StyleBox["t",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`t[],
              Editable->False], "]"}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           xAct`xTensor`ParamD[
            $CellContext`t[]][
            $CellContext`\[Phi][][
             $CellContext`t[]]],
           Editable->False], "->", "eqd\[Phi]"}], ",", "\n", 
         RowBox[{
          StyleBox[
           InterpretationBox[
            StyleBox[
             RowBox[{
              SubscriptBox["\[PartialD]", 
               RowBox[{"t", "[", "]"}]], 
              SubscriptBox["\[PartialD]", 
               RowBox[{"t", "[", "]"}]], 
              InterpretationBox[
               StyleBox["\[Phi]",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`\[Phi][],
               Editable->False], "[", 
              InterpretationBox[
               StyleBox["t",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`t[],
               Editable->False], "]"}],
             ShowAutoStyles->False,
             AutoSpacing->False],
            xAct`xTensor`ParamD[
             $CellContext`t[], 
             $CellContext`t[]][
             $CellContext`\[Phi][][
              $CellContext`t[]]],
            Editable->False],
           ShowAutoStyles->False,
           AutoSpacing->False], "->", "eqd2\[Phi]"}], ",", "\n", 
         RowBox[{
          InterpretationBox[
           StyleBox[
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"t", "[", "]"}]], 
             SubscriptBox["\[PartialD]", 
              RowBox[{"t", "[", "]"}]], 
             SubscriptBox["\[PartialD]", 
              RowBox[{"t", "[", "]"}]], 
             InterpretationBox[
              StyleBox["\[Phi]",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`\[Phi][],
              Editable->False], "[", 
             InterpretationBox[
              StyleBox["t",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`t[],
              Editable->False], "]"}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           xAct`xTensor`ParamD[
            $CellContext`t[], 
            $CellContext`t[], 
            $CellContext`t[]][
            $CellContext`\[Phi][][
             $CellContext`t[]]],
           Editable->False], "->", "eqd3\[Phi]"}], ",", "\n", 
         RowBox[{
          RowBox[{
           InterpretationBox[
            StyleBox["r",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`r[],
            Editable->False], "[", 
           InterpretationBox[
            StyleBox["t",
             ShowAutoStyles->False,
             AutoSpacing->False],
            $CellContext`t[],
            Editable->False], "]"}], "\[Rule]", 
          FractionBox["p", 
           RowBox[{"1", "+", 
            RowBox[{"e", " ", 
             RowBox[{
              InterpretationBox[
               StyleBox["Cos",
                ShowAutoStyles->False,
                AutoSpacing->False],
               Cos,
               Editable->False], "[", 
              RowBox[{
               InterpretationBox[
                StyleBox["\[Psi]",
                 ShowAutoStyles->False,
                 AutoSpacing->False],
                $CellContext`psi[],
                Editable->False], "[", 
               RowBox[{"t", "[", "]"}], "]"}], "]"}]}]}]]}], ",", "\n", 
         RowBox[{
          InterpretationBox[
           StyleBox[
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"t", "[", "]"}]], 
             InterpretationBox[
              StyleBox["r",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`r[],
              Editable->False], "[", 
             InterpretationBox[
              StyleBox["t",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`t[],
              Editable->False], "]"}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           xAct`xTensor`ParamD[
            $CellContext`t[]][
            $CellContext`r[][
             $CellContext`t[]]],
           Editable->False], "->", "eqdr"}], ",", "\n", 
         RowBox[{
          InterpretationBox[
           StyleBox[
            RowBox[{
             SubscriptBox["\[PartialD]", 
              RowBox[{"t", "[", "]"}]], 
             SubscriptBox["\[PartialD]", 
              RowBox[{"t", "[", "]"}]], 
             InterpretationBox[
              StyleBox["r",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`r[],
              Editable->False], "[", 
             InterpretationBox[
              StyleBox["t",
               ShowAutoStyles->False,
               AutoSpacing->False],
              $CellContext`t[],
              Editable->False], "]"}],
            ShowAutoStyles->False,
            AutoSpacing->False],
           xAct`xTensor`ParamD[
            $CellContext`t[], 
            $CellContext`t[]][
            $CellContext`r[][
             $CellContext`t[]]],
           Editable->False], 
          StyleBox["->",
           ShowAutoStyles->False,
           AutoSpacing->False], "eqd2r"}], ",", "\n", 
         RowBox[{
          StyleBox[
           InterpretationBox[
            StyleBox[
             RowBox[{
              SubscriptBox["\[PartialD]", 
               RowBox[{"t", "[", "]"}]], 
              SubscriptBox["\[PartialD]", 
               RowBox[{"t", "[", "]"}]], 
              SubscriptBox["\[PartialD]", 
               RowBox[{"t", "[", "]"}]], 
              InterpretationBox[
               StyleBox["r",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`r[],
               Editable->False], "[", 
              InterpretationBox[
               StyleBox["t",
                ShowAutoStyles->False,
                AutoSpacing->False],
               $CellContext`t[],
               Editable->False], "]"}],
             ShowAutoStyles->False,
             AutoSpacing->False],
            xAct`xTensor`ParamD[
             $CellContext`t[], 
             $CellContext`t[], 
             $CellContext`t[]][
             $CellContext`r[][
              $CellContext`t[]]],
            Editable->False],
           ShowAutoStyles->False,
           AutoSpacing->False], 
          StyleBox["->",
           ShowAutoStyles->False,
           AutoSpacing->False], "eqd3r"}]}], "\n", "}"}]}], ";", "\n", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"OrderPNSeries", "[", 
         RowBox[{"PN0", ",", 
          RowBox[{"\"\<Mark\>\"", " ", "->", "\"\<Off\>\""}]}], "]"}], "[", 
        RowBox[{"exp", "/.", "ReplaceSet"}], "]"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}]}], "Code",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.908609237093205*^9, {3.9086092948003006`*^9, 3.9086094554805593`*^9}, {
   3.908609501884344*^9, 3.9086096336689367`*^9}, {3.9086110392643304`*^9, 
   3.908611040407801*^9}, {3.908612670032121*^9, 3.908612748113143*^9}, {
   3.908613110345468*^9, 3.9086131559033475`*^9}, {3.908614621626416*^9, 
   3.908614693032499*^9}, {3.908614760102183*^9, 3.908614771600872*^9}, {
   3.90861485617004*^9, 3.908614892547385*^9}, {3.908614966237112*^9, 
   3.9086149801290107`*^9}, {3.908615227400077*^9, 3.908615313077852*^9}, {
   3.9086153706583543`*^9, 3.9086153778242364`*^9}, 3.9086154478664856`*^9, {
   3.908615550098894*^9, 3.9086155501064606`*^9}, {3.908616572559476*^9, 
   3.9086165746922693`*^9}, {3.9086558586441307`*^9, 
   3.9086558819603376`*^9}, {3.910163781691841*^9, 3.91016380040352*^9}, 
   3.940884519365399*^9, {3.941078504982771*^9, 3.9410785060116825`*^9}},
 CellLabel->
  "In[766]:=",ExpressionUUID->"1d48e4ba-d52e-d94e-9ace-4cc5761a8787"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]]
},
WindowToolbars->"MultipurposeBar",
WindowSize->{1141.2, 567.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (2023\:5e7412\:670812\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Book"}, "Monograph.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"7400b55a-c361-ea44-957b-20b63a287170"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 251, 4, 87, "Section",ExpressionUUID->"44ca613e-df9c-46c7-bfba-f0acd95bec3a"],
Cell[CellGroupData[{
Cell[856, 30, 5128, 145, 327, "Code",ExpressionUUID->"d5ca832f-6b09-4cd7-bcc0-0eb40436d167"],
Cell[5987, 177, 2027, 50, 37, "Output",ExpressionUUID->"b1d91dbf-f5ff-0d47-a329-7a689a70067e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8063, 233, 208, 4, 87, "Section",ExpressionUUID->"39da9ea7-4f15-492e-911a-82698b9cceba"],
Cell[CellGroupData[{
Cell[8296, 241, 217, 4, 45, "Subsection",ExpressionUUID->"7e076fd4-1d6a-43a1-b5dc-5fd38081a8d8"],
Cell[8516, 247, 1061, 31, 151, "Code",ExpressionUUID->"347864f2-b73a-4c0d-8c18-9d1c746ce8e4"],
Cell[CellGroupData[{
Cell[9602, 282, 182, 3, 33, "Subsubsection",ExpressionUUID->"b2b291b1-ae7d-4b00-b757-1f7234bdc767"],
Cell[9787, 287, 246, 4, 62, "Code",ExpressionUUID->"4a9c0aac-391d-4954-a69d-fc69f671dd66"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10082, 297, 223, 4, 45, "Subsection",ExpressionUUID->"4c07e9e9-ce75-418c-9d9e-ea7fd8923ed4"],
Cell[CellGroupData[{
Cell[10330, 305, 184, 3, 33, "Subsubsection",ExpressionUUID->"642cdca6-1aeb-4999-9711-ef4e753b04b1"],
Cell[10517, 310, 656, 16, 107, "Code",ExpressionUUID->"1bcff7d4-514c-4b44-b1ac-cad527533858"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11210, 331, 184, 3, 33, "Subsubsection",ExpressionUUID->"d2d99f40-429a-49a5-809f-6770c767e37d"],
Cell[11397, 336, 652, 16, 62, "Code",ExpressionUUID->"2c16822a-9975-41bc-a71c-33c2487a25bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12086, 357, 212, 4, 33, "Subsubsection",ExpressionUUID->"9afb07d7-29be-4a6c-abff-bc1fbbe24d5d"],
Cell[12301, 363, 274, 5, 62, "Code",ExpressionUUID->"24c4315b-ccbc-48f2-95dd-d9ac98477bd6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12612, 373, 253, 4, 33, "Subsubsection",ExpressionUUID->"866305f4-03b0-42f2-8596-2fab4404b1a3"],
Cell[12868, 379, 146, 3, 20, "Text",ExpressionUUID->"784bf25a-b9d4-3d49-81d0-cb6b8a3d4446"],
Cell[13017, 384, 278, 6, 62, "Code",ExpressionUUID->"5d745f7e-6565-4403-8da6-86af56228125"],
Cell[13298, 392, 1201, 27, 62, "Code",ExpressionUUID->"4e31f57e-0e81-4c94-ab80-6d36eb64e276"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14536, 424, 225, 4, 33, "Subsubsection",ExpressionUUID->"20f67f26-bf94-734b-b971-10acf0e51ee9"],
Cell[14764, 430, 318, 6, 62, "Code",ExpressionUUID->"77e506bd-c7af-9144-add3-f88fc3ec5cc1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15119, 441, 428, 7, 33, "Subsubsection",ExpressionUUID->"bd6c64bc-ebca-4249-ba88-79812c42535b"],
Cell[15550, 450, 372, 7, 62, "Code",ExpressionUUID->"5a77ecfd-516d-074d-9319-068b6e3427b6"],
Cell[15925, 459, 1704, 41, 84, "Code",ExpressionUUID->"67885970-ff0e-4d09-9c65-f46e5b356f3b"],
Cell[17632, 502, 559, 14, 62, "Code",ExpressionUUID->"762fb734-1046-49a3-905d-79de9bf7307f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18228, 521, 290, 5, 33, "Subsubsection",ExpressionUUID->"cdc0844c-bc42-4309-bc39-ca4726bcf056"],
Cell[CellGroupData[{
Cell[18543, 530, 261, 4, 34, "Subsubsubsection",ExpressionUUID->"90084228-e350-4374-b7df-db943973a9d1"],
Cell[18807, 536, 1133, 27, 173, "Code",ExpressionUUID->"65f58b96-9f15-4c81-b515-a0f7b909cb8b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19977, 568, 164, 3, 34, "Subsubsubsection",ExpressionUUID->"aa2dc488-b349-1448-9c8e-527c4946cb23"],
Cell[20144, 573, 576, 13, 82, "Code",ExpressionUUID->"89d04de5-d6a5-498d-911c-c680bf685bbd"],
Cell[20723, 588, 619, 14, 83, "Code",ExpressionUUID->"983aa608-3f66-ff41-94a5-72f2591cf13f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21391, 608, 278, 5, 33, "Subsubsection",ExpressionUUID->"8d04a9c5-3d56-4ff4-b895-641e01581527"],
Cell[CellGroupData[{
Cell[21694, 617, 205, 4, 34, "Subsubsubsection",ExpressionUUID->"5913c0d1-97a0-43cb-99c0-fe98b56b5904"],
Cell[21902, 623, 257, 5, 62, "Code",ExpressionUUID->"18d6292d-f64b-4de8-9448-51c82c477a24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22196, 633, 211, 4, 34, "Subsubsubsection",ExpressionUUID->"602e6627-216e-4a10-b10e-8a6590342dbd"],
Cell[22410, 639, 1018, 28, 62, "Code",ExpressionUUID->"f613ff67-1021-4a9d-b1de-efb569c9b3ce"],
Cell[23431, 669, 1455, 45, 62, "Code",ExpressionUUID->"72ea531d-367a-4dbd-b2d4-8e9e75d4fdee"],
Cell[24889, 716, 1511, 44, 62, "Code",ExpressionUUID->"6c289c92-7ccf-496e-8c79-156856dddc9c"],
Cell[26403, 762, 1284, 38, 62, "Code",ExpressionUUID->"8a27d8bc-e348-4244-9c87-4743610e2cbf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27736, 806, 195, 3, 33, "Subsubsection",ExpressionUUID->"069efdc4-e36a-426b-9098-2cac1a7af9bf"],
Cell[CellGroupData[{
Cell[27956, 813, 275, 7, 41, "Input",ExpressionUUID->"ae68157b-3b65-45b3-bb05-ca164d2c79a1"],
Cell[28234, 822, 686, 25, 37, "Output",ExpressionUUID->"98264bb3-3479-6846-a041-beba0cdc51de"]
}, Open  ]],
Cell[28935, 850, 1429, 39, 95, "Code",ExpressionUUID->"9febde85-a6e7-4aff-9a53-34b4cef413f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30401, 894, 184, 3, 33, "Subsubsection",ExpressionUUID->"a910d2f2-e116-0445-9620-c98565bbde32"],
Cell[30588, 899, 314, 7, 20, "Text",ExpressionUUID->"5b31eb54-1e0b-dc47-9665-1e2de69260d4"],
Cell[30905, 908, 237, 6, 42, "Text",ExpressionUUID->"9d33ad31-4b9d-2d4b-a170-36bd77cb817f"],
Cell[31145, 916, 1423, 40, 173, "Code",ExpressionUUID->"92b052be-cd1f-9d4a-ae16-77dae502d6a6"],
Cell[32571, 958, 473, 13, 62, "Code",ExpressionUUID->"94aafa95-1611-49fc-a1e7-73f7eaad9693"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33105, 978, 235, 4, 87, "Section",ExpressionUUID->"93cca77c-5468-4db3-b53b-296d3845d353"],
Cell[33343, 984, 1515, 34, 67, "Code",ExpressionUUID->"57e3a7af-0795-4e5e-8f90-592e32479ac3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34895, 1023, 228, 4, 87, "Section",ExpressionUUID->"62491963-3514-48d4-b437-14df5c7576ec"],
Cell[CellGroupData[{
Cell[35148, 1031, 312, 6, 34, "Subsubsubsection",ExpressionUUID->"ce73d90d-d062-784f-856c-f507329a2efb"],
Cell[35463, 1039, 408, 8, 62, "Code",ExpressionUUID->"a96826a9-704b-8842-a9a3-dca9d9702fe6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35908, 1052, 205, 3, 34, "Subsubsubsection",ExpressionUUID->"7a8b7a39-d359-46b4-82f4-ecfe9723d34c"],
Cell[36116, 1057, 863, 22, 107, "Code",ExpressionUUID->"9f24d9da-5d20-49b9-8d81-6402df8045b5"],
Cell[36982, 1081, 934, 24, 85, "Code",ExpressionUUID->"7f99cb19-929d-49b6-824b-ee95af86155e"],
Cell[37919, 1107, 1393, 40, 85, "Code",ExpressionUUID->"5c1c1216-5ee4-49c8-b8d9-7718a6757fac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39349, 1152, 186, 4, 34, "Subsubsubsection",ExpressionUUID->"869e505d-9908-4626-a669-c5d2949391b0"],
Cell[39538, 1158, 1280, 34, 129, "Code",ExpressionUUID->"17159be7-63de-514d-b60e-4ce1c1e85667"],
Cell[40821, 1194, 291, 7, 85, "Code",ExpressionUUID->"80dba65f-0fbe-344c-8e61-9cf30362a98d"],
Cell[41115, 1203, 1281, 34, 109, "Code",ExpressionUUID->"13012a07-8f0f-d34e-8406-195aa2d44392"],
Cell[42399, 1239, 9006, 237, 88, "Code",ExpressionUUID->"f0cd0ee9-51dd-6244-bd7e-c5b7d9e8c436"],
Cell[51408, 1478, 1552, 35, 85, "Code",ExpressionUUID->"949d2c46-0365-9945-a82b-c0b01d061495"],
Cell[52963, 1515, 1649, 36, 85, "Code",ExpressionUUID->"73949f97-72a6-ee4f-9721-cf30c381cef8"],
Cell[54615, 1553, 2706, 71, 198, "Input",ExpressionUUID->"6627ae76-f699-ff49-ac78-a7de62655210"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57358, 1629, 224, 4, 34, "Subsubsubsection",ExpressionUUID->"40c21e2e-336f-954e-bf39-588116c785d1"],
Cell[57585, 1635, 543, 10, 85, "Code",ExpressionUUID->"482a8aec-74fe-544c-b0c9-259f53e108e1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[58177, 1651, 187, 3, 87, "Section",ExpressionUUID->"ebabfa65-c8bd-4339-8c4c-60ffe51583a4"],
Cell[58367, 1656, 709, 18, 62, "Code",ExpressionUUID->"9dfee0e7-7dfd-46d0-b9fc-eb4f5dd31d2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59113, 1679, 310, 5, 87, "Section",ExpressionUUID->"67dce49b-7f84-b041-be09-36899ceff019"],
Cell[59426, 1686, 316, 8, 62, "Code",ExpressionUUID->"a4c14339-4787-4842-ace0-f4ddc7937fb9"],
Cell[59745, 1696, 317, 8, 62, "Code",ExpressionUUID->"6797aa08-6db0-aa46-afaa-31f2aadcb23c"],
Cell[60065, 1706, 270, 6, 62, "Code",ExpressionUUID->"273f856e-b578-1543-9cc7-5a130fd773c0"],
Cell[60338, 1714, 313, 8, 62, "Code",ExpressionUUID->"448111c1-99a9-8948-978f-3cbd80c69a79"],
Cell[CellGroupData[{
Cell[60676, 1726, 230, 4, 45, "Subsection",ExpressionUUID->"47daf209-2828-8749-9cb3-c42746872f0a"],
Cell[60909, 1732, 1123, 22, 62, "Code",ExpressionUUID->"6757b438-3a2d-c543-b301-8d221b8d2454"],
Cell[62035, 1756, 917, 23, 62, "Code",ExpressionUUID->"0db1dabc-d948-1d41-922a-50d2e612c27f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62989, 1784, 206, 4, 45, "Subsection",ExpressionUUID->"8dc44416-f214-43f7-aec5-af4b89f6de0b"],
Cell[63198, 1790, 245, 5, 62, "Code",ExpressionUUID->"efc4001d-aaf8-3f45-9c05-9fea17dc5ad1"],
Cell[63446, 1797, 19668, 528, 66, "Code",ExpressionUUID->"5e4d9fee-6c66-3440-975a-1d4163669ee6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83163, 2331, 188, 3, 87, "Section",ExpressionUUID->"ed5fe1b3-f6f4-4ee9-8bb9-1030e31e611a"],
Cell[83354, 2336, 1021, 25, 132, "Code",ExpressionUUID->"660360f2-f2b9-4643-a1f3-1d20e96c0f5a"],
Cell[84378, 2363, 1232, 31, 154, "Code",ExpressionUUID->"ca4f1122-938e-4a55-8ebc-eee4dda68345"],
Cell[CellGroupData[{
Cell[85635, 2398, 134, 3, 45, "Subsection",ExpressionUUID->"903920d4-a1f0-2749-9a2d-3cb5619d412f"],
Cell[85772, 2403, 15814, 450, 323, "Code",ExpressionUUID->"b4008b92-6d82-f84a-952a-5c1491926b28"],
Cell[CellGroupData[{
Cell[101611, 2857, 2984, 103, 128, "Input",ExpressionUUID->"1503cc1a-af6a-8c43-9cff-df454bb93051"],
Cell[104598, 2962, 853, 30, 57, "Output",ExpressionUUID->"72b60286-7165-1a46-880e-e40958c2389d"],
Cell[105454, 2994, 210, 4, 36, "Output",ExpressionUUID->"76a9a948-d569-fc4b-a0fc-4c39c623bf64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105701, 3003, 3653, 129, 142, "Input",ExpressionUUID->"b67ddd2c-8e08-8446-b3de-acd4a7ee84ae"],
Cell[109357, 3134, 976, 34, 37, "Output",ExpressionUUID->"4489f7a7-9739-3541-b469-39c2bab4303a"],
Cell[110336, 3170, 1240, 43, 40, "Output",ExpressionUUID->"6e0a292d-028f-3247-affd-eaa7e59de7da"],
Cell[111579, 3215, 256, 4, 36, "Output",ExpressionUUID->"3a4d080e-9085-7543-a0ac-f581ee706368"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[111884, 3225, 477, 9, 34, "Subsection",ExpressionUUID->"844e5a31-abc2-4bcb-a8d1-e0430684b5c4"],
Cell[112364, 3236, 1898, 47, 158, "Code",ExpressionUUID->"d34864f0-b338-4598-a39e-90fe681bd6e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114299, 3288, 190, 3, 45, "Subsection",ExpressionUUID->"75901822-34d1-ec4e-a6e9-9b3c3a0d9793"],
Cell[114492, 3293, 2098, 70, 297, "Code",ExpressionUUID->"af435e51-e9ce-824c-89e3-d65ebc28f70b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116627, 3368, 237, 4, 45, "Subsection",ExpressionUUID->"9f57f22a-19f1-6c42-af72-ab7cb5cf3371"],
Cell[116867, 3374, 405, 9, 62, "Code",ExpressionUUID->"a76b345b-cb58-e844-8e04-d6eb90679c8a"],
Cell[117275, 3385, 32701, 842, 1844, "Code",ExpressionUUID->"edd3a99f-a7a8-174d-bb33-befcd7f62b9e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150025, 4233, 155, 3, 49, "Section",ExpressionUUID->"9e3d3b42-9bcc-344a-8caf-e7e0238f280b"],
Cell[150183, 4238, 11286, 399, 463, "Code",ExpressionUUID->"8075f737-c729-2140-a52c-018e5643b1ab"],
Cell[CellGroupData[{
Cell[161494, 4641, 204, 4, 45, "Subsection",ExpressionUUID->"feb3887f-fdf8-c241-9a23-184e6bedd572"],
Cell[161701, 4647, 776, 27, 97, "Code",ExpressionUUID->"0d4f3667-dbe5-8740-9e67-9760827ca16b"],
Cell[162480, 4676, 9272, 273, 430, "Code",ExpressionUUID->"169f114c-1e45-e14d-8a94-359ad31f8612"],
Cell[171755, 4951, 1449, 48, 97, "Code",ExpressionUUID->"3746946f-cf7b-854d-8bdb-a578d55f2401"],
Cell[173207, 5001, 6679, 198, 96, "Code",ExpressionUUID->"7c679143-6f5d-af45-b187-c473afc31263"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179923, 5204, 135, 3, 45, "Subsection",ExpressionUUID->"60a29373-9a3b-a545-b9af-0f9c8bad51d5"],
Cell[180061, 5209, 22605, 687, 268, "Code",ExpressionUUID->"8967fe0c-2481-834e-97d8-9f896051554b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202703, 5901, 138, 3, 45, "Subsection",ExpressionUUID->"91f71344-898b-8746-bef7-55e9cbb0b5b9"],
Cell[202844, 5906, 3147, 75, 103, "Code",ExpressionUUID->"ec5b5205-2c2c-7540-b26d-ac77757294d7"],
Cell[205994, 5983, 15078, 291, 103, "Code",ExpressionUUID->"f450dc1a-806a-7a41-8cd8-09e87db0b034"],
Cell[221075, 6276, 479, 13, 118, "Code",ExpressionUUID->"bd05ad1d-f866-6844-8bb8-150666ffb450"],
Cell[221557, 6291, 3709, 105, 142, "Code",ExpressionUUID->"bc05ba33-80e5-924f-a66a-1f29cd8b7514"],
Cell[225269, 6398, 9582, 276, 405, "Code",ExpressionUUID->"3fb4ab5e-b6df-4c45-a2f9-cd58fb90d524"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234888, 6679, 131, 3, 45, "Subsection",ExpressionUUID->"e19de6b2-ae80-e94b-855f-19b6a434be58"],
Cell[235022, 6684, 1156, 30, 129, "Code",ExpressionUUID->"f876edef-e97b-f849-b9c1-3c2b8e218d9c"],
Cell[236181, 6716, 6348, 183, 305, "Code",ExpressionUUID->"b9bf0916-80b3-2d40-ad5a-2f5a1699f78b"],
Cell[242532, 6901, 1215, 36, 90, "Code",ExpressionUUID->"087fad13-7243-004d-8586-6fb69b1bab04"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[243796, 6943, 204, 4, 49, "Section",ExpressionUUID->"b2c277cb-088a-274b-bbfa-12570bfd1e80"],
Cell[CellGroupData[{
Cell[244025, 6951, 205, 3, 33, "Subsubsection",ExpressionUUID->"7784b9bd-a90c-c446-920d-ee20c81bbc29"],
Cell[244233, 6956, 198, 3, 20, "Text",ExpressionUUID->"50019fec-b7be-3e40-a851-563458cfd3e2"],
Cell[244434, 6961, 1527, 38, 39, "EquationNumbered",ExpressionUUID->"e39c28f3-7ff2-354c-b3e7-e1574b2906ad"],
Cell[245964, 7001, 793, 19, 85, "Code",ExpressionUUID->"c0d34ebb-bbfd-6348-b21d-ff190d87bfab"],
Cell[246760, 7022, 3704, 74, 239, "Code",ExpressionUUID->"6a32bd72-be0d-f541-a700-f3047a786b22"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[250513, 7102, 153, 3, 49, "Section",ExpressionUUID->"8482b699-bd60-5644-bc96-980732b28049"],
Cell[250669, 7107, 376, 6, 20, "Text",ExpressionUUID->"815f3fc5-bb44-f749-9005-33f7ea4ce387"],
Cell[251048, 7115, 509, 9, 20, "Text",ExpressionUUID->"62375bcd-aa81-264a-a30c-d87f4f36492a"],
Cell[251560, 7126, 527, 9, 20, "Text",ExpressionUUID->"667f3d38-99e8-1342-8785-bae3ba8c5c8d"],
Cell[CellGroupData[{
Cell[252112, 7139, 188, 4, 45, "Subsection",ExpressionUUID->"7a7accb9-c228-7440-9eb8-9d03219fecd7"],
Cell[CellGroupData[{
Cell[252325, 7147, 272, 4, 33, "Subsubsection",ExpressionUUID->"e0afc5c2-6975-c04a-a407-afbea1438a3d"],
Cell[252600, 7153, 923, 18, 85, "Code",ExpressionUUID->"05a9bedb-0ecc-8540-b541-0b4a74391287"]
}, Open  ]],
Cell[CellGroupData[{
Cell[253560, 7176, 207, 4, 33, "Subsubsection",ExpressionUUID->"939fe56a-d958-db41-8459-862e227d6645"],
Cell[253770, 7182, 842, 21, 62, "Code",ExpressionUUID->"5cd51bdc-42c6-ac42-aa6e-7aef568abb2c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[254649, 7208, 189, 3, 33, "Subsubsection",ExpressionUUID->"ef5f8c17-5c43-0040-a78a-9e44c4425e9d"],
Cell[254841, 7213, 413, 9, 62, "Code",ExpressionUUID->"e2534f4f-d6cc-324f-8e6e-f95ad4ad25d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255291, 7227, 182, 3, 33, "Subsubsection",ExpressionUUID->"0bac457b-bf67-4445-ba93-2980eaf48166"],
Cell[255476, 7232, 2805, 50, 62, "Code",ExpressionUUID->"8e18ea9f-5ea7-7d4a-8647-a612ca8236af"],
Cell[258284, 7284, 508, 12, 62, "Code",ExpressionUUID->"4b397195-25f2-bd44-b98d-98d690ed27c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[258829, 7301, 203, 3, 33, "Subsubsection",ExpressionUUID->"08210fb0-29c5-a149-9b2e-b8bca1d86939"],
Cell[259035, 7306, 511, 11, 62, "Code",ExpressionUUID->"2953245d-7324-e249-9cdb-08cd41df2d33"],
Cell[259549, 7319, 570, 16, 62, "Code",ExpressionUUID->"c68cfcfb-6428-4c4e-94c5-ed5f89faff7b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260156, 7340, 243, 4, 33, "Subsubsection",ExpressionUUID->"39d631b4-8eb9-6f4d-9614-0dfb534c0a42"],
Cell[CellGroupData[{
Cell[260424, 7348, 863, 21, 94, "Input",ExpressionUUID->"59016a03-f119-7f46-9527-b97e086d60e7"],
Cell[261290, 7371, 1048, 30, 57, "Output",ExpressionUUID->"07b90632-69d8-474b-88af-e7e8199e5e8f"],
Cell[262341, 7403, 977, 28, 37, "Output",ExpressionUUID->"d60c9e9f-88c1-2842-8b54-6430cb0da7ad"]
}, Open  ]],
Cell[263333, 7434, 232, 4, 20, "Text",ExpressionUUID->"f64653c0-9ce9-3041-94c0-77e1610ec69d"],
Cell[263568, 7440, 2192, 49, 62, "Code",ExpressionUUID->"20ddb395-c235-2b4b-8dbd-e87c8f8fc48a"],
Cell[265763, 7491, 82, 0, 20, "Text",ExpressionUUID->"c452967e-6323-524c-9780-bac420e25b3e"],
Cell[265848, 7493, 630, 19, 62, "Code",ExpressionUUID->"091d3cc4-6410-6d4e-b880-4739e72130ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[266515, 7517, 490, 7, 33, "Subsubsection",ExpressionUUID->"d13d4b02-3cc1-1e4a-badf-1e7e910d2228"],
Cell[267008, 7526, 21114, 555, 438, "Code",ExpressionUUID->"524d892d-6097-3a4c-9d2e-6db40640d695"],
Cell[CellGroupData[{
Cell[288147, 8085, 1534, 34, 94, "Input",ExpressionUUID->"37cafa0c-5aa4-a34f-8fff-41d0e6de2d40"],
Cell[289684, 8121, 2205, 73, 63, "Output",ExpressionUUID->"7e69d5be-0ceb-e447-8d6b-3f9f7ab8fba3"],
Cell[291892, 8196, 674, 22, 61, "Output",ExpressionUUID->"5757b346-f233-0e43-a61c-d2d9ec883c29"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[292615, 8224, 221, 4, 33, "Subsubsection",ExpressionUUID->"ce6060fb-34fd-1d48-a087-5838dde13273"],
Cell[292839, 8230, 214, 4, 20, "Text",ExpressionUUID->"aacbdb7d-171b-0146-aebf-6ced86e774c0"],
Cell[293056, 8236, 450, 13, 67, "Code",ExpressionUUID->"901a1e71-3426-a94e-8523-0038a5da8da6"],
Cell[293509, 8251, 188, 3, 20, "Text",ExpressionUUID->"cf56d72f-bed3-0641-a884-a56e697b4c4e"],
Cell[293700, 8256, 8894, 241, 406, "Code",ExpressionUUID->"ec19e06a-8929-c740-8c31-75566ccb4cfb"],
Cell[302597, 8499, 201, 4, 20, "Text",ExpressionUUID->"5f074242-7d0a-5545-b973-6e5332309b90"],
Cell[302801, 8505, 720, 18, 129, "Code",ExpressionUUID->"34f53d7e-1849-384d-93b1-5c12c80e485b"],
Cell[303524, 8525, 195, 3, 20, "Text",ExpressionUUID->"3fc7b50a-0d9d-3c45-a6e8-b1d1c1027112"],
Cell[303722, 8530, 5744, 147, 308, "Code",ExpressionUUID->"c15897bd-e240-1a41-8181-fe21a76fa367"],
Cell[CellGroupData[{
Cell[309491, 8681, 475, 12, 34, "Subsubsubsection",ExpressionUUID->"376b6dde-8c16-2e4d-b6c0-d54e74391820"],
Cell[309969, 8695, 33926, 830, 799, "Code",ExpressionUUID->"624f3a73-85e6-6c41-99df-a61442d3ab48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343932, 9530, 409, 12, 34, "Subsubsubsection",ExpressionUUID->"c4085ce1-7011-e647-88cf-837bd544e353"],
Cell[344344, 9544, 21074, 511, 738, "Code",ExpressionUUID->"8a06f996-d29c-f740-adeb-8624069f2093"]
}, Open  ]],
Cell[CellGroupData[{
Cell[365455, 10060, 317, 5, 34, "Subsubsubsection",ExpressionUUID->"00871f84-99c8-b64f-8d53-3f2c4af986c2"],
Cell[365775, 10067, 26120, 701, 624, "Code",ExpressionUUID->"1d48e4ba-d52e-d94e-9ace-4cc5761a8787"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]]
}
]
*)

